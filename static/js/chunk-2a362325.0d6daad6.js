(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a362325"],{"766b":function(e,t,r){},"91b6":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c}));r("7f7f"),r("386d"),r("28a5");var a=r("db72"),s=(r("96cf"),r("3b8d")),o=r("b775"),n=function(){return Object(o["a"])({url:"/oss/auth",method:"get"})},i=function(e){return Object(o["a"])({url:e+"?x-oss-process=image/info",method:"get"})},l=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,s,n,l,u,c,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.oss,s=t.key,n=t.file,l=t.onProgress,u=new FormData,u.append("OSSAccessKeyId",r.OSSAccessKeyId),u.append("success_action_status",200),u.append("policy",r.policy),u.append("Signature",r.Signature),u.append("key",s),u.append("file",n),c="https://pic1.baobaohehu.com/",e.next=11,Object(o["a"])({url:c,method:"post",headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l||null,data:u});case 11:if(c+=s,!(n.type.indexOf("image")>-1)){e.next=18;break}return e.next=15,i(c);case 15:m=e.sent,e.next=27;break;case 18:if(!(n.type.indexOf("video")>-1)){e.next=22;break}m=Object(a["a"])({},n.videoMeta,{size:n.size}),e.next=27;break;case 22:if(!(n.type.indexOf("audio")>-1)){e.next=26;break}m={size:n.size,type:n.type},e.next=27;break;case 26:throw new Error("当前上传的类型不是image或者video；当前上传的类型是"+n.type);case 27:return e.abrupt("return",{url:c,meta:m});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(e){if(!e||"string"!==typeof e)return!1;var t=e.split("").reverse().join(""),r=t.substring(0,t.search(/\./)).split("").reverse().join("");return r},c=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r){var a,s,o,i,c,m,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:return a=e.sent,s=a.data,o=Math.floor(99*Math.random())+1,i=(new Date).getTime(),c=u(t.name),i=i+o+"."+c,m="".concat(s.path,"/").concat(s.prefix,"/").concat(i),e.next=11,l({oss:s,key:m,file:t,onProgress:r});case 11:return p=e.sent,e.abrupt("return",p);case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},"9d6e":function(e,t,r){"use strict";var a=r("766b"),s=r.n(a);s.a},"9f41":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"series-course"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"课程名称",prop:"name"}},[r("el-input",{attrs:{maxlength:"20","show-word-limit":"",placeholder:"请输入课程名称",disabled:e.disabled},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),r("el-form-item",{attrs:{label:"重点内容",prop:"content"}},[e.contentShow?e._e():r("div",{staticClass:"div-textarea",style:{color:e.ruleForm.content?"#515a6e":""},domProps:{innerHTML:e._s(e.ruleForm.content||"请输入重点内容")},on:{click:e.contentClick}}),e.contentShow?r("vue-editor",{ref:"editor",attrs:{placeholder:"请输入重点内容","use-custom-image-handler":!0},on:{"image-added":e.handleImageAdded},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}}):e._e()],1),r("el-form-item",{attrs:{label:"课程封面",prop:"cover"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"http-request":e.uploadFunc}},[e.imgUrl?r("img",{staticClass:"avatar",attrs:{src:e.imgUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n          建议尺寸600*280px，JPG、PNG格式，图片小于5M\n        ")])])],1),"catalog"!==e.ruleForm.column?r("el-form-item",{attrs:{label:"课程栏目",prop:"column"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.column,callback:function(t){e.$set(e.ruleForm,"column",t)},expression:"ruleForm.column"}},[r("el-option",{attrs:{label:"企业文化",value:"corporate_culture"}}),r("el-option",{attrs:{label:"健康管理师职责",value:"service_responsibilities"}}),r("el-option",{attrs:{label:"工作流程",value:"workflow"}}),r("el-option",{attrs:{label:"专业能力知识",value:"professional_knowledge"}})],1)],1):e._e(),r("el-form-item",{attrs:{label:"课程类型",prop:"type"}},[r("el-radio-group",{on:{change:e.selectType},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[r("el-radio",{attrs:{label:"image_text"}},[e._v("图文")]),r("el-radio",{attrs:{label:"audio"}},[e._v("音频")]),r("el-radio",{attrs:{label:"video"}},[e._v("视频")])],1)],1),r("el-form-item",{attrs:{label:"课程详情",prop:"detail"}},[r("vue-editor",{attrs:{placeholder:"请输入课程详情","use-custom-image-handler":!0},on:{"image-added":e.handleImageAdded},model:{value:e.ruleForm.detail,callback:function(t){e.$set(e.ruleForm,"detail",t)},expression:"ruleForm.detail"}})],1),e.TipText?r("el-form-item",{attrs:{label:"audio"===e.ruleForm.type?"上传音频":"上传视频"}},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-success":e.handleFileSuccess,"before-upload":e.beforeFileUpload,"http-request":e.uploadFileFunc,"file-list":e.fileList,"on-change":e.handleChange}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:e.isUpload},slot:"trigger"},[e._v("上传"+e._s("audio"===e.ruleForm.type?"音频":"视频"))]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.TipText))])],1)],1):e._e(),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],1)],1)},s=[],o=(r("7f7f"),r("96cf"),r("3b8d")),n=r("f296"),i=r("5873"),l=r("91b6"),u={components:{VueEditor:i["a"]},data:function(){return{ruleForm:{name:"",num:"",summary:"",content:"",column:"",cover:"",detail:"",url:""},rules:{name:[{required:!0,message:"您输入的内容有误，请重新输入",trigger:"blur"}],content:[{required:!0,message:"您输入的内容有误，请重新输入",trigger:"blur"}],column:[{required:!0,message:"请进行选择后再操作",trigger:"change"}],type:[{required:!0,message:"请进行选择后再操作",trigger:"change"}],detail:[{required:!0,message:"课程详情不能为空",trigger:"blur"}],cover:[{required:!0,message:"请上传封面文件",trigger:"change"}]},imgUrl:"",disabled:!1,uploading:!1,uploadFile:!1,contentShow:!1,TipText:"",routeName:"",parent_id:"",fileList:[],isUpload:!1}},created:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("singleEdit"!==this.$route.name){e.next=7;break}return e.next=3,Object(n["t"])(this.$route.params.id);case 3:t=e.sent,r=t.data,a=t.code,2e4===a&&r.result&&(this.ruleForm={name:r.mtsCatalog.title},this.disabled="catalog"===r.mtsCatalog.lesson_column,r.mtsCatalog.total_chapter&&(this.ruleForm.total_chapter=r.mtsCatalog.total_chapter),r.mtsCatalog.summary&&(this.ruleForm.summary=r.mtsCatalog.summary),r.mtsCatalog.content&&(this.ruleForm.content=r.mtsCatalog.content),r.mtsCatalog.type&&(this.ruleForm.type=r.mtsCatalog.type,this.selectType()),r.mtsCatalog.lesson_column&&(this.ruleForm.column=r.mtsCatalog.lesson_column),r.mtsCatalog.level&&(this.ruleForm.level=r.mtsCatalog.level),r.mtsCatalog.cover&&(this.imgUrl=r.mtsCatalog.cover,this.ruleForm.cover=r.mtsCatalog.cover),this.parent_id=r.mtsCatalog.parent_id,r.mtsCatalog.url&&(this.ruleForm.url=r.mtsCatalog.url),r.mtsCatalog.detail&&(this.ruleForm.detail=r.mtsCatalog.detail));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{uploadFunc:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["c"])(t.file,(function(e){}));case 2:r=e.sent,this.imgUrl=r.url,this.ruleForm.cover=r.url;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),uploadFileFunc:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.fileList.length>0)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(l["c"])(t.file,(function(e){}));case 4:r=e.sent,this.ruleForm.url=r.url;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),submitForm:function(e){var t=this;if(this.uploading||this.uploadFile)return this.$message({message:"正在上传文件中不能进行提交",type:"error"}),!1;this.$refs[e].validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){var a,s,o,i,l,u,c,m,p,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=25;break}if(!t.$route.params.id||"singleEdit"!==t.$route.name){e.next=14;break}return a={title:t.ruleForm.name,content:t.ruleForm.content,type:t.ruleForm.type,detail:t.ruleForm.detail,cover:t.ruleForm.cover},t.ruleForm.url&&(a.url=t.ruleForm.url),s=t.ruleForm.column,s&&"catalog"!==s&&1===t.ruleForm.level&&(a.lesson_column=s),e.next=8,Object(n["u"])(t.$route.params.id,a);case 8:o=e.sent,i=o.data,l=o.code,2e4===l&&(i.result?t.$message({message:"修改成功",type:"success"}):t.$message({message:i.message,type:"error"}),"seriesDetail"===t.routeName?t.$router.push("/learning-admin/course/series-detail/"+t.parent_id):t.$router.push("/learning-admin/course")),e.next=25;break;case 14:return u={title:t.ruleForm.name,content:t.ruleForm.content,cover:t.ruleForm.cover,category:"single_lesson",type:t.ruleForm.type,detail:t.ruleForm.detail},t.$route.params.id&&(u.parent_id=t.$route.params.id),t.ruleForm.url&&(u.url=t.ruleForm.url),c=t.ruleForm.column,c&&"catalog"!==c&&(u.lesson_column=c),e.next=21,Object(n["k"])(u);case 21:m=e.sent,p=m.data,d=m.code,2e4===d&&(p.result?t.$message({message:"添加成功",type:"success"}):t.$message({message:p.message,type:"error"}),"seriesDetail"===t.routeName?t.$router.push("/learning-admin/course/series-detail/"+t.$route.params.id):t.$router.push("/learning-admin/course"));case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},handleAvatarSuccess:function(e,t){this.uploading=!1,this.$message({message:"上传成功",type:"success"})},handleFileSuccess:function(){this.uploadFile=!1,this.$message({message:"上传成功",type:"success"}),this.isUpload=!0},beforeFileUpload:function(e){var t;return this.uploadFile=!0,"video"===this.ruleForm.type&&(t=["video/mp4","video/avi","video/flv","video/wmv","video/mkv","video/mov"].indexOf(e.type)>=0),"audio"===this.ruleForm.type&&(t="audio/mp3"===e.type),t||"video"!==this.ruleForm.type||this.$message.error("支持avi、flv、mp4、wmv、mkv、mov、等视频格式"),t||"audio"!==this.ruleForm.type||this.$message.error("支持mp3格式"),t||(this.fileList=[]),this.fileList.length>1&&(t=!1),t},beforeAvatarUpload:function(e){this.uploading=!0;var t=["image/png","image/jpeg","image/jpg"].indexOf(e.type)>=0,r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 5MB!"),t&&r},selectType:function(){"image_text"===this.ruleForm.type&&(this.TipText="",this.rules.detail=[{required:!0,message:"课程详情不能为空",trigger:"blur"}]),"audio"===this.ruleForm.type&&(this.TipText="可以上传100M以内的音频文件，支持mp3格式",this.rules.detail=[]),"video"===this.ruleForm.type&&(this.TipText="可以上传3G以内的视频文件，支持avi、flv、mp4、wmv、mkv、mov、等视频格式上传",this.rules.detail=[])},handleChange:function(e,t){this.fileList=t.slice()},contentClick:function(){this.contentShow=!0;var e=this;setTimeout((function(){e.$refs.editor&&(e.$refs.editor.quill.enable(!0),e.$refs.editor.quill.focus())}),200)},handleImageAdded:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r,a,s){var o,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["c"])(t);case 2:o=e.sent,n=o.url,r.insertEmbed(a,"image",n),s();case 6:case"end":return e.stop()}}),e)})));function t(t,r,a,s){return e.apply(this,arguments)}return t}()},beforeRouteEnter:function(e,t,r){r((function(t){e.params.id&&"singleEdit"!==e.name&&(t.routeName="seriesDetail")}))}},c=u,m=(r("9d6e"),r("2877")),p=Object(m["a"])(c,a,s,!1,null,"3964281a",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2a362325.0d6daad6.js.map