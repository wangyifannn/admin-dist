(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69bc034f"],{"22ce":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return c}));var r=a("b775");function n(e){return Object(r["a"])({url:"/fd_service_item/list",method:"get",params:e})}function s(e,t){return Object(r["a"])({url:"/fd_service_item"+"/".concat(e,"/change_server_status"),method:"put",data:t})}function i(e,t){return Object(r["a"])({url:"/fd_service_item"+"/".concat(e),method:"put",data:t})}function c(e){return Object(r["a"])({url:"/fd_service_item"+"/".concat(e.id,"/logs"),method:"get",params:e})}},"2c91":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"service-manage"},[a("div",{staticClass:"service-manage__header"},[a("el-input",{staticClass:"service-manage__header__item service-manage__header__search",attrs:{size:"small",placeholder:"输入服务名称搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.searchName,callback:function(t){e.searchName="string"===typeof t?t.trim():t},expression:"searchName"}}),a("el-button",{staticClass:"service-manage__header__item",attrs:{type:"primary",size:"small"},on:{click:e.handleSearchByName}},[e._v("搜索")]),a("el-button",{staticClass:"service-manage__header__item",attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleReset}},[e._v("重置")])],1),a("div",{staticClass:"service-manage__body"},[a("div",{staticClass:"el-card-warpper service-manage__body__list"},[a("el-card",{staticClass:"el-card--no-shadow el-card--header-nbb el-card--flex"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"el-card__header__title"},[e._v("服务列表")])]),a("el-table",{staticClass:"service-manage__body__list__table sbl-table",attrs:{data:e.tableDate}},[a("el-table-column",{attrs:{align:"center",label:"服务编号","min-width":"100",prop:"id",fixed:""}}),a("el-table-column",{attrs:{align:"center",label:"服务名称","min-width":"150",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"sbl-table__name-col"},[a("span",{staticClass:"sbl-table__name-col__name"},[e._v(e._s(t.row.name))]),t.row.remark?a("el-tooltip",{staticClass:"color-576277",attrs:{effect:"dark",content:t.row.remark,placement:"top"}},[a("i",{staticClass:"el-icon-info"})]):e._e()],1)]}}])}),a("el-table-column",{attrs:{align:"center",label:"服务所需业务角色","min-width":"150",prop:"depenceOn"}}),a("el-table-column",{attrs:{align:"center",label:"首次开启日期","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.firstOpenDate)+"\n            ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"当前状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"sbl-table__status-col",on:{click:function(a){return e.handleStatusColClick(t)}}},[a("el-switch",{class:t.row.isOnServerStatus?"online-style":"offline-style",attrs:{value:t.row.isOnServerStatus,"inactive-color":"#C0C4CC","active-color":"#409EFF",width:60,"active-text":(t.row.isOnServerStatus,""),"inactive-text":t.row.isOnServerStatus?"发布":"关闭"},model:{value:t.row.isOnServerStatus,callback:function(a){e.$set(t.row,"isOnServerStatus",a)},expression:"scope.row.isOnServerStatus"}})],1)]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleEditDesc(t)}}},[e._v("编辑描述")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleSeeHandleConlog(t)}}},[e._v("操作日志")])]}}])})],1),a("div",{staticClass:"service-manage__body__list__pagination"},[a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":e.pageSizes,"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)]),a("el-dialog",{attrs:{visible:e.serviceStatusDialog,title:(e.curServiceStatus?"关闭":"开启")+"服务",width:"400px",top:"25vh",center:"","before-close":e.cancelServerChange},on:{"update:visible":function(t){e.serviceStatusDialog=t},closed:function(t){return e.handleResetForm("service-status-form")}}},[a("el-form",{ref:"service-status-form",staticClass:"service-manage__dialog-form",attrs:{model:e.serviceStatusForm,"label-width":"80px","label-position":"right",rules:e.serviceStatusFormRules,"append-to-body":!0}},[a("el-form-item",{attrs:{label:"服务名称",prop:"name"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.serviceStatusForm.name,callback:function(t){e.$set(e.serviceStatusForm,"name","string"===typeof t?t.trim():t)},expression:"serviceStatusForm.name"}})],1),a("el-form-item",{attrs:{label:"服务描述",prop:"remark"}},[a("el-input",{attrs:{autosize:{minRows:3,maxRows:10},type:"textarea",maxlength:"200","show-word-limit":"",disabled:""},model:{value:e.serviceStatusForm.remark,callback:function(t){e.$set(e.serviceStatusForm,"remark",t)},expression:"serviceStatusForm.remark"}})],1),a("el-form-item",{attrs:{label:"修改原因",prop:"reason"}},[a("el-input",{attrs:{size:"small",maxlength:"10","show-word-limit":""},model:{value:e.serviceStatusForm.reason,callback:function(t){e.$set(e.serviceStatusForm,"reason","string"===typeof t?t.trim():t)},expression:"serviceStatusForm.reason"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmSSF}},[e._v("确认"+e._s(e.curServiceStatus?"关闭":"开启"))]),a("el-button",{staticClass:"service-manage__dialog-form__cancel",attrs:{size:"small"},on:{click:e.cancelServerChange}},[e._v("取消并返回")])],1)],1),a("el-dialog",{attrs:{visible:e.editDialogVisible,title:"编辑服务描述",width:"400px",top:"25vh",center:""},on:{"update:visible":function(t){e.editDialogVisible=t},closed:function(t){return e.handleResetForm("edit-form")}}},[a("el-form",{ref:"edit-form",staticClass:"service-manage__dialog-form",attrs:{model:e.editForm,"label-width":"80px","label-position":"right",rules:e.editFormRules,"append-to-body":!0}},[a("el-form-item",{attrs:{label:"服务名称",prop:"name"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name","string"===typeof t?t.trim():t)},expression:"editForm.name"}})],1),a("el-form-item",{attrs:{label:"服务描述",prop:"remark"}},[a("el-input",{attrs:{autosize:{minRows:3,maxRows:10},type:"textarea",maxlength:"200","show-word-limit":""},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmEdit}},[e._v("保存修改")]),a("el-button",{staticClass:"service-manage__dialog-form__cancel",attrs:{size:"small"},on:{click:e.cancelDialog}},[e._v("取消并返回")])],1)],1)],1)},n=[],s=a("db72"),i=(a("96cf"),a("3b8d")),c=(a("7f7f"),a("0680")),l=a("22ce"),o={name:"",remark:""},u={name:"",remark:"",reason:""},m={data:function(){return{searchName:"",tableDate:[],page:{total:0,pageSize:10,currentPage:1},pageSizes:[10,20,50],editDialogVisible:!1,editForm:Object.assign({},o),editFormRules:{name:[{required:!0,message:"请输入服务名称",trigger:"blur"}],remark:[{required:!0,message:"请输入服务描述",trigger:"blur"}]},serviceStatusDialog:!1,curServiceStatus:"OPEN",curServiceIndex:0,serviceStatusForm:Object.assign({},u),serviceStatusFormRules:{reason:[{required:!0,message:"请输入修改原因",trigger:"blur"}]}}},created:function(){this.handleSearch()},methods:{systemRole:c["h"],cancelDialog:function(){this.editDialogVisible=!1,this.handleReset()},cancelServerChange:function(){this.serviceStatusDialog=!1,this.handleReset()},setTableData:function(e){var t=this,a=e.list;this.tableDate=a.map((function(e,a){return{id:e.id?e.id:String(a),_id:e._id?e._id:a,name:e.name?e.name:"-",remark:e.remark?e.remark:"-",depenceOn:e.depence_on?t.systemRole(e.depence_on,""):"-",firstOpenDate:e.first_server_at?t.formatTime(e.first_server_at):"-",isOnServerStatus:!!e.is_on_server&&e.is_on_server}}))},setPage:function(e){var t=e.current_page,a=e.pag_size,r=e.count;this.page.currentPage=t,this.page.pageSize=a,this.page.total=r},handleSearchByName:function(){if(this.searchName){var e={currentPage:1,pageSize:10};this.handleSearch(e)}else this.$message({message:"请输入服务名称搜索",type:"error"})},handleSearch:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t||{},a.currentPage||(a.current_page=this.page.currentPage),a.pageSize||(a.page_size=this.page.pageSize),a.name=this.searchName,e.next=6,Object(l["c"])(a);case 6:if(r=e.sent,n=r.data,!(0===n.list.length&&this.page.currentPage>1)){e.next=14;break}return this.handleSearch(Object.assign(a,{currentPage:1})),this.setPage({currentPage:1,pageSize:10,total:0}),e.abrupt("return");case 14:this.setPage(Object(s["a"])({},n));case 15:this.setTableData(Object(s["a"])({},n));case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleReset:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.searchName="",e.next=3,this.handleSearch();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleEditDesc:function(e){var t=e.row;this.editForm=Object.assign({},this.editForm,{name:t.name,_id:t._id,remark:t.remark}),this.editDialogVisible=!0},handleSeeHandleConlog:function(e){var t=e.row;this.$router.push({name:"ServiceHandleConlog",params:{id:t._id},query:{serviceName:t.name}})},handleCurrentChange:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page.currentPage=t,e.next=3,this.handleSearch();case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleSizeChange:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page.pageSize=t,e.next=3,this.handleSearch();case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleResetForm:function(e){this.$refs[e].resetFields(),this.handleSearch()},confirmEdit:function(){var e=this;this.$refs["edit-form"].validate((function(t){if(!t)return!1;Object(l["d"])(e.editForm._id,{remark:e.editForm.remark}).then((function(t){var a=t.data,r="保存修改";e.$message({message:a&&!0===a.result?r+"成功":"失败",type:a&&a.result?"success":"error"}),t&&t.data.result&&e.handleSearch()})),e.editDialogVisible=!1}))},handleStatusColClick:function(e){var t=e.row,a=e.$index;this.curServiceStatus=!t.isOnServerStatus,this.curServiceIndex=a,this.serviceStatusForm=Object.assign({},u,{name:t.name,remark:t.remark}),this.serviceStatusDialog=!0},confirmSSF:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs["service-status-form"].validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a){var r,n,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=13;break}return r=t.tableDate[t.curServiceIndex],r.is_on_server=!r.isOnServerStatus,e.next=5,Object(l["a"])(r._id,{is_on_server:!r.is_on_server,reason:t.serviceStatusForm.reason});case 5:n=e.sent,s=n.data,t.serviceStatusDialog=!1,i=t.curServiceStatus?"确认关闭":"确认开启",t.$message({message:s&&!0===s.result?i+"成功":"失败",type:s&&s.result?"success":"error"}),s&&s.result&&t.handleSearch(),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},d=m,h=(a("6d66"),a("d32a"),a("2877")),p=Object(h["a"])(d,r,n,!1,null,"1d16427c",null);t["default"]=p.exports},"6d66":function(e,t,a){"use strict";var r=a("93ac"),n=a.n(r);n.a},7253:function(e,t,a){},"93ac":function(e,t,a){},d32a:function(e,t,a){"use strict";var r=a("7253"),n=a.n(r);n.a}}]);
//# sourceMappingURL=chunk-69bc034f.f623d425.js.map