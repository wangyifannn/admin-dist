(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24867df0"],{4380:function(t,e,a){},"5a71":function(t,e,a){"use strict";var n=a("fe24"),s=a.n(n);s.a},"75dd":function(t,e,a){"use strict";var n=a("4380"),s=a.n(n);s.a},"7af3":function(t,e,a){"use strict";a.d(e,"h",(function(){return s})),a.d(e,"g",(function(){return r})),a.d(e,"f",(function(){return i})),a.d(e,"k",(function(){return o})),a.d(e,"e",(function(){return l})),a.d(e,"i",(function(){return c})),a.d(e,"j",(function(){return u})),a.d(e,"b",(function(){return f})),a.d(e,"c",(function(){return d})),a.d(e,"l",(function(){return m})),a.d(e,"a",(function(){return p})),a.d(e,"d",(function(){return h})),a.d(e,"m",(function(){return v}));var n=a("b775");function s(t){return Object(n["a"])({url:"/admin/question/handler",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/admin/question/users",method:"get",params:t})}function i(){return Object(n["a"])({url:"/admin/question/list/doctors",method:"get"})}function o(){return Object(n["a"])({url:"/admin/question/reply",method:"get"})}function l(t){return Object(n["a"])({url:"/admin/question/list/users",method:"get",params:t})}function c(t){return Object(n["a"])({url:"/admin/question/detail/".concat(t),method:"get"})}function u(t){return Object(n["a"])({url:"/admin/question/histories",method:"get",params:t})}function f(){return Object(n["a"])({url:"/admin/question/line",method:"get"})}function d(t){return Object(n["a"])({url:"/admin/question/reply",method:"post",data:t})}function m(){return Object(n["a"])({url:"/question_fast_reply/list",method:"get"})}function p(t){return Object(n["a"])({url:"/question_fast_reply",method:"post",data:t})}function h(t){return Object(n["a"])({url:"/question_fast_reply/".concat(t),method:"delete"})}function v(t){return Object(n["a"])({url:"/question_fast_reply/".concat(t.id),method:"put",data:t})}},"81a4":function(t,e,a){},a8db:function(t,e,a){"use strict";var n=a("e265"),s=a.n(n),r=a("a4bb"),i=a.n(r);function o(t,e){if(null==t)return{};var a,n,s={},r=i()(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(s[a]=t[a]);return s}function l(t,e){if(null==t)return{};var a,n,r=o(t,e);if(s.a){var i=s()(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}a.d(e,"a",(function(){return l}))},c8b2:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"header"},[a("div",[a("p",{staticClass:"header__title"},[t._v("待处理问诊")]),a("div",{staticClass:"card-container"},[a("div",{staticClass:"card",on:{click:function(e){return t.goDetail("normal")}}},[t._v("\n          待接诊\n          "),a("div",{staticClass:"card-content"},[a("div",{staticClass:"item"},[t._m(0),t.questionInfo.normal_count>0?a("div",{staticClass:"count"},[t._v("\n                "+t._s(t.questionInfo.normal_count)+"\n              ")]):a("div",{staticClass:"zero"},[t._v("0")])])])]),a("div",{staticClass:"card",on:{click:function(e){return t.goDetail("reply")}}},[t._v("\n          追问待回复\n          "),a("div",{staticClass:"card-content"},[a("div",{staticClass:"item"},[t._m(1),t.questionInfo.first_ask>0?a("div",{staticClass:"count"},[t._v("\n                "+t._s(t.questionInfo.first_ask)+"\n              ")]):a("div",{staticClass:"zero"},[t._v("0")])]),a("div",{staticClass:"item"},[t._m(2),t.questionInfo.second_ask>0?a("div",{staticClass:"count"},[t._v("\n                "+t._s(t.questionInfo.second_ask)+"\n              ")]):a("div",{staticClass:"zero"},[t._v("0")])])])])])]),a("div",{staticClass:"action"},[a("p",{staticClass:"action__text"},[t._v("\n        当前问诊状态："+t._s("online"===t.userInfo.question_online_status?"在线可接新问诊":"下线不接新问诊")+"\n      ")]),a("el-button",{staticStyle:{width:"170px"},attrs:{type:"primary"},on:{click:t.handleChangeStaus}},[t._v("\n        "+t._s("online"===t.userInfo.question_online_status?"点击下线":"点击上线")+"\n      ")])],1)]),a("div",{staticClass:"search-from"},[a("SearchFrom",{ref:"search-form",attrs:{"local-form-data":{},"select-opts-maps":{sectionOfficeList:t.sectionOfficeList,statusList:t.statusList,orderStatusList:t.orderStatusList,doctorList:t.doctorList}},on:{search:t.handleSearch}})],1),a("div",{staticClass:"table__title"},[t._v("\n    用户问诊列表\n  ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData,border:"",height:"700px"}},[a("el-table-column",{attrs:{label:"订单号",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.order_id.order_id))])]}}])}),a("el-table-column",{attrs:{label:"用户Id",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.user?a("div",{staticClass:"avatar"},[a("p",[t._v(t._s(e.row.user.user_id))])]):a("div",[t._v("\n          空\n        ")])]}}])}),a("el-table-column",{attrs:{label:"用户",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.user?a("div",{staticClass:"avatar"},[a("el-avatar",{attrs:{src:e.row.user.avatar}}),a("p",[t._v(t._s(e.row.user.nickname))])],1):a("div",[t._v("\n          空\n        ")])]}}])}),a("el-table-column",{attrs:{label:"提问时间",align:"center",prop:"first_ask_at",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n          "+t._s(e.row.first_ask_at?t.formatTime(e.row.first_ask_at):"")+"\n        ")])]}}])}),a("el-table-column",{attrs:{label:"科室",align:"center",prop:"section_office",formatter:function(e){return t.sectionOffice(e.section_office,"",!0)}}}),a("el-table-column",{attrs:{label:"接诊人",align:"center",prop:"doctor",formatter:function(t){return t.doctor.name}}}),a("el-table-column",{attrs:{align:"center",prop:"active_at",formatter:t.waitTime}},[a("template",{slot:"header"},[a("p",[a("span",[t._v("首次提问等待时间")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"00:00-08:00不计入等待时长",placement:"top-start"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-left":"4px","font-size":"16px"}})])],1)])],2),a("el-table-column",{attrs:{label:"首次回复时间",align:"center",prop:"first_reply_at",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n          "+t._s(e.row.first_reply_at?t.formatTime(e.row.first_reply_at):"")+"\n        ")])]}}])}),a("el-table-column",{attrs:{label:"追问次数",align:"center",prop:"append_count",formatter:function(t){return t.append_count+"/2"}}}),a("el-table-column",{attrs:{label:"问诊状态",align:"center",prop:"status",formatter:function(e){return t.singleAskStatus(e.status)}}}),a("el-table-column",{attrs:{label:"退款情况",align:"center",prop:"order_status",width:"100",formatter:function(e){return t.singleAskOrderStatus(e.order_status)}}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.goDetail("all",{userId:e.row.user._id,questionId:e.row._id})}}},[t._v("查看详情")])]}}])})],1),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.page.currentPage,"page-sizes":[10,15,20],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.counts},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:t.title,visible:t.dialogShow,width:"30%",center:""},on:{"update:visible":function(e){t.dialogShow=e}}},[a("div",{staticStyle:{padding:"0 20px","line-height":"1.5","font-size":"16px","font-weight":"600"}},[t._v("\n      "+t._s(t.text)+"\n    ")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.changeDoctorStatus}},[t._v(t._s(t.confirmButtonText))])],1)])],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"name"},[a("i",{staticClass:"iconfont icon-jinri"}),t._v("\n                待接诊\n              ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"name"},[a("i",{staticClass:"iconfont icon-jinri"}),t._v("\n                首次追问\n              ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"name"},[a("i",{staticClass:"iconfont icon-quanbu"}),t._v("\n                二次追问\n              ")])}],r=a("a8db"),i=(a("7f7f"),a("96cf"),a("3b8d")),o=(a("456d"),a("ac6a"),a("db72")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("el-form",{staticClass:"search__form",attrs:{"label-position":"left","label-width":"76px",model:t.formData}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"问诊状态"}},[a("el-select",{attrs:{placeholder:"请选择问诊状态",size:"small",clearable:""},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},t._l(t.selectOptsMaps.statusList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"接诊人"}},[a("el-select",{attrs:{placeholder:"请选择接诊人",size:"small",clearable:""},model:{value:t.formData.doctor,callback:function(e){t.$set(t.formData,"doctor",e)},expression:"formData.doctor"}},t._l(t.selectOptsMaps.doctorList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"接诊科室"}},[a("el-select",{attrs:{placeholder:"请选择接诊科室",size:"small",clearable:""},model:{value:t.formData.section_office,callback:function(e){t.$set(t.formData,"section_office",e)},expression:"formData.section_office"}},t._l(t.selectOptsMaps.sectionOfficeList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"用户昵称"}},[a("el-input",{attrs:{placeholder:"请输入用户昵称",size:"small",clearable:""},model:{value:t.formData.nickname,callback:function(e){t.$set(t.formData,"nickname",e)},expression:"formData.nickname"}})],1)],1)],1),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"用户ID"}},[a("el-input",{attrs:{placeholder:"请输入用户ID",size:"small",clearable:""},model:{value:t.formData.user,callback:function(e){t.$set(t.formData,"user",e)},expression:"formData.user"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"退款情况"}},[a("el-select",{attrs:{placeholder:"请选择退款情况",size:"small",clearable:""},model:{value:t.formData.order_status,callback:function(e){t.$set(t.formData,"order_status",e)},expression:"formData.order_status"}},t._l(t.selectOptsMaps.orderStatusList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"提问时间"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","start-placeholder":"请选择时间范围起始","end-placeholder":"请选择时间范围结束","default-time":["00:00:00","23:59:59"],size:"small",clearable:""},model:{value:t.formData.active_at,callback:function(e){t.$set(t.formData,"active_at",e)},expression:"formData.active_at"}})],1)],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"action"},[a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleSearch}},[t._v("搜索订单")]),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.handleReset}},[t._v("重置选项")])],1)])])],1)],1)],1)},c=[],u={status:"",active_at:[],doctor:"",section_office:"",nickname:"",user:"",order_status:""},f={props:{localFormData:{type:Object,default:function(){}},selectOptsMaps:{type:Object,required:!0,default:function(){return{statusList:[],doctorList:[],sectionOfficeList:[],orderStatusList:[]}}}},data:function(){return{formData:{}}},created:function(){this.formData=Object.assign({},u,this.localFormData)},methods:{handleSearch:function(){this.$emit("search",{searchParams:this.formData})},handleReset:function(){this.handleResetFormData(),this.handleSearch()},handleResetFormData:function(){this.formData=Object.assign({},u)}}},d=f,m=(a("75dd"),a("5a71"),a("2877")),p=Object(m["a"])(d,l,c,!1,null,"b9cd52c0",null),h=p.exports,v=a("7af3"),_=a("2f62"),g=a("0680"),b={components:{SearchFrom:h},data:function(){return{loading:!0,questionInfo:{normal_count:"",first_ask:"",second_ask:""},tableData:[],doctorList:[],title:"",text:"",confirmButtonText:"",dialogShow:!1,sectionOfficeList:this.sectionOffice("","arr",!1),statusList:[],orderStatusList:[],page:{},params:{}}},computed:Object(o["a"])({},Object(_["c"])(["userInfo"])),mounted:function(){this.init(),this.statusList=this.singleAskStatus("","arr"),this.orderStatusList=this.singleAskOrderStatus("","arr")},methods:Object(o["a"])({singleAskStatus:g["f"],singleAskOrderStatus:g["e"],sectionOffice:g["d"]},Object(_["b"])({getUserInfo:"user/getInfo"}),{handleSizeChange:function(t){this.page.pageSize=t},handleCurrentChange:function(t){this.getList({currentPage:t})},handleSearch:function(t){var e=t.searchParams,a=Object.assign({},e);Object.keys(a).forEach((function(t){a[t]&&a[t].length||delete a[t]})),a.active_at&&a.active_at.length&&(a.active_at=a.active_at.join("|")),this.params=a,this.getList({query:a,refresh:!0})},goDetail:function(t,e){var a=this.$router.resolve({name:"ConsultationDetail",query:{type:t,questionId:e&&e.questionId?e.questionId:"",userId:e&&e.userId?e.userId:""}}),n=a.href;window.open(n,"_blank")},handleChangeStaus:function(){var t=this.userInfo.question_online_status;this.title="online"===t?"下线提示":"上线提示",this.text="online"===t?"下线操作成功后，您在用户端的状态将发生变更，用户将无法购买您的单次问诊，请谨慎考虑后进行操作！":"上线操作成功后，您在用户端的状态将发生变更，用户将可以购买您的单次问诊，请谨慎考虑后进行操作！",this.confirmButtonText="online"===t?"确定下线":"确定上线",this.dialogShow=!0},waitTime:function(t){var e=this.getHours(t.first_ask_at,t.first_reply_at||t.closed_at||new Date),a=e.hour,n=e.minutes;return"".concat(a,"小时").concat(n,"分钟")},getHours:function(t,e){var a=new Date(t);a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);var n=new Date(e);n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);var s=0;while(a<n){var r=a.getHours();r>8&&r<=23&&(s+=1),a.setTime(a.setHours(a.getHours()+1))}var i=new Date(t),o=new Date(e),l=i.getHours(),c=o.getHours(),u=i.getMinutes(),f=i.getSeconds(),d=i.getMilliseconds();l<=7&&(u=0,f=0,d=0);var m=o.getMinutes(),p=o.getSeconds(),h=o.getMilliseconds();c<=7&&c>0?(m=0,p=0,h=0):0===c&&(m=59,p=59,h=0);var v=m-u,_=p-f,g=h-d;return g<0&&(_-=1,g=1e3+g),_<0&&(v-=1,_=60+_),v<0&&(s-=1,v=60+v),{hour:s,minutes:v,seconds:_,milliseconds:g}},changeDoctorStatus:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(v["b"])();case 3:this.$message({type:"success",message:"操作成功"}),this.getUserInfo(),this.dialogShow=!1,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(){return t.apply(this,arguments)}return e}(),getDoctorList:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(v["f"])({bus_role:"doctor"});case 2:e=t.sent,a=e.data,this.doctorList=a.list.map((function(t){return{label:t.name,value:t._id}}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getList:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,n,s,i,l,c,u,f,d,m,p=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=p.length>0&&void 0!==p[0]?p[0]:{},a=e.query,n=void 0===a?this.params:a,s=e.currentPage,i=void 0===s?1:s,l=e.refresh,c=void 0!==l&&l,t.next=3,Object(v["g"])(Object(o["a"])({},n,{page:c?1:i,pageSize:this.page.pageSize||10}));case 3:u=t.sent,f=u.data,d=f.list,m=Object(r["a"])(f,["list"]),this.tableData=d,this.page=m,this.loading=!1;case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),init:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(v["h"])();case 2:e=t.sent,a=e.data,this.questionInfo=a,this.getList(),this.getDoctorList();case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()})},k=b,w=(a("d7e6"),Object(m["a"])(k,n,s,!1,null,"15e21406",null));e["default"]=w.exports},d7e6:function(t,e,a){"use strict";var n=a("81a4"),s=a.n(n);s.a},fe24:function(t,e,a){}}]);
//# sourceMappingURL=chunk-24867df0.ab125bdf.js.map