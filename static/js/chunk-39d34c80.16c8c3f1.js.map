{"version":3,"sources":["webpack:///./src/views/marketing/rights/add/index.vue?4a77","webpack:///./src/views/marketing/rights/add/index.vue?85a9","webpack:///src/views/marketing/rights/add/index.vue","webpack:///./src/views/marketing/rights/add/index.vue?f1b4","webpack:///./src/views/marketing/rights/add/index.vue","webpack:///./src/api/marketing.js","webpack:///./src/views/marketing/rights/add/index.vue?af52","webpack:///./src/api/FdServiceType.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","pageType","ref","attrs","form","staticStyle","required","message","trigger","model","value","callback","$$v","$set","expression","_l","$store","state","dictionary","item","key","label","discount_mode","on","checkMoney","MoneyToFixed","moneyTips","_e","_n","moneyTipsDiscount","isIndeterminate","handleCheckAllChange","checkAll","handleCheckedChange","product","type","submitCoupon","staticRenderFns","name","data","products","description","discount_value","scope_product","scope_user","computed","$route","params","created","getProducts","id","methods","Number","val","toFixed","isNaN","pickCommonFormItem","checkedCount","length","all","fenToYuan","show_history","group","batch_id","$refs","couponForm","validate","valid","component","getRightsList","request","url","method","addRights","getRightsOne","updateRights","updateServeStatus","status","getList","getFilterApi","getCouponCreateInfo","addCoupon","getCodeImg","changeStatus","_id","query","addProducts","getServices","changeSaleStatus","update","getEditInfo"],"mappings":"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","file":"static/js/chunk-39d34c80.16c8c3f1.js","sourcesContent":["import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=1&id=03a6d974&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=1&id=03a6d974&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"coupon-add rights-add\"},[_c('div',{staticClass:\"coupon-add__form\"},[_c('div',{staticClass:\"coupon-add__form--title\"},[_vm._v(\" \"+_vm._s(_vm.pageType)+\"权益\")]),_c('div',{staticClass:\"coupon-add__form--content\"},[_c('el-form',{ref:\"couponForm\",attrs:{\"model\":_vm.form,\"label-width\":\"180px\"}},[_c('div',{staticStyle:{\"width\":\"600px\"}},[_c('el-form-item',{attrs:{\"label\":\"权益名称：\",\"prop\":\"name\",\"rules\":[\n              { required: true, message: '请输入标题', trigger: 'blur' }\n            ]}},[_c('el-input',{attrs:{\"disabled\":_vm.pageType === '编辑',\"placeholder\":\"请输入\",\"maxlength\":\"20\",\"show-word-limit\":\"\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1)],1),_c('div',{staticStyle:{\"width\":\"600px\"}},[_c('el-form-item',{attrs:{\"label\":\"请选择权益类型：\",\"prop\":\"type\",\"rules\":[\n              { required: true, message: '请选择权益类型', trigger: 'blur' }\n            ]}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"disabled\":_vm.pageType === '编辑',\"placeholder\":\"请选择权益类型\",\"clearable\":\"\"},model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", $$v)},expression:\"form.type\"}},_vm._l((_vm.$store.state.dictionary.rightsType),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1)],1),_c('el-form-item',{attrs:{\"label\":\"优惠形式：\",\"prop\":\"discount_mode\",\"rules\":[\n            { required: true, message: '请选择优惠形式', trigger: 'blur' }\n          ]}},[_c('el-radio-group',{attrs:{\"disabled\":_vm.pageType === '编辑'},model:{value:(_vm.form.discount_mode),callback:function ($$v) {_vm.$set(_vm.form, \"discount_mode\", $$v)},expression:\"form.discount_mode\"}},[_c('el-radio',{attrs:{\"label\":\"PRICE\"}},[_vm._v(\" 优惠金额\")]),_c('el-radio',{attrs:{\"label\":\"PERCENT\"}},[_vm._v(\"优惠折扣\")])],1)],1),(_vm.form.discount_mode === 'PRICE')?_c('div',{staticClass:\"money-item\"},[_c('el-form-item',{attrs:{\"label\":\"优惠金额：\",\"prop\":\"discount_value\",\"rules\":[\n              { required: true, message: '请输入优惠值', trigger: 'change' }\n            ]}},[_c('el-input',{staticStyle:{\"width\":\"80%\"},attrs:{\"disabled\":_vm.pageType === '编辑',\"placeholder\":\"请输入\"},on:{\"input\":_vm.checkMoney,\"change\":_vm.MoneyToFixed},model:{value:(_vm.form.discount_value),callback:function ($$v) {_vm.$set(_vm.form, \"discount_value\", $$v)},expression:\"form.discount_value\"}}),_vm._v(\"\\n             元 \"),_c('span',{staticClass:\"money-tips\"},[_vm._v(_vm._s(_vm.moneyTips))])],1)],1):_vm._e(),(_vm.form.discount_mode === 'PERCENT')?_c('div',{staticClass:\"money-item\"},[_c('el-form-item',{attrs:{\"label\":\"优惠折扣：\",\"prop\":\"discount_value\",\"rules\":[\n              { required: true, message: '请输入优惠折扣', trigger: 'blur' }\n            ]}},[_c('el-input-number',{staticStyle:{\"width\":\"80%\"},attrs:{\"max\":9.9,\"min\":0,\"step\":1},model:{value:(_vm.form.discount_value),callback:function ($$v) {_vm.$set(_vm.form, \"discount_value\", _vm._n($$v))},expression:\"form.discount_value\"}}),_vm._v(\"\\n             折\\n            \"),_c('span',{staticClass:\"money-tips-discount\"},[_vm._v(_vm._s(_vm.moneyTipsDiscount))])],1)],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"适用套餐：\",\"prop\":\"scope_product\",\"rules\":[\n            { required: true, message: '请选择适用套餐', trigger: 'change' }\n          ]}},[_c('el-checkbox',{attrs:{\"indeterminate\":_vm.isIndeterminate},on:{\"change\":_vm.handleCheckAllChange},model:{value:(_vm.checkAll),callback:function ($$v) {_vm.checkAll=$$v},expression:\"checkAll\"}},[_vm._v(\"全选\")]),_c('div',{staticStyle:{\"margin\":\"5px 0\"}}),_c('el-checkbox-group',{on:{\"change\":_vm.handleCheckedChange},model:{value:(_vm.form.scope_product),callback:function ($$v) {_vm.$set(_vm.form, \"scope_product\", $$v)},expression:\"form.scope_product\"}},[_c('div',_vm._l((_vm.products),function(product){return _c('el-checkbox',{key:product.value,attrs:{\"label\":product.value}},[_vm._v(_vm._s(product.label))])}),1)])],1),(_vm.form.type !== 'ASK')?_c('div',[_c('el-form-item',{attrs:{\"label\":\"适用人群：\",\"prop\":\"scope_user\",\"rules\":[\n              { required: true, message: '请选择适用人群', trigger: 'change' }\n            ]}},[_c('el-radio-group',{model:{value:(_vm.form.scope_user),callback:function ($$v) {_vm.$set(_vm.form, \"scope_user\", $$v)},expression:\"form.scope_user\"}},_vm._l((_vm.$store.state.dictionary.scopeUser),function(item){return _c('el-radio',{key:item.value,attrs:{\"label\":item.value}},[_vm._v(\"\\n                \"+_vm._s(item.label))])}),1)],1),_c('div',{staticClass:\"tips-wrap\"},[_c('div',[_vm._v(\"\\n              无所选套餐购买记录用户：指从未购买过所选套餐的用户\\n            \")]),_c('div',[_vm._v(\"\\n              无任何套餐购买记录用户：指从未购买过任何套餐的用户\\n            \")])])],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"权益描述：\",\"prop\":\"description\",\"rules\":[\n            { required: true, message: '请输入权益描述', trigger: 'blur' }\n          ]}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"maxlength\":\"100\",\"show-word-limit\":\"\",\"rows\":\"4\",\"placeholder\":\"请输入\"},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_c('el-form-item',[_c('div',{staticStyle:{\"text-align\":\"center\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submitCoupon}},[_vm._v(\"确认\"+_vm._s(_vm.pageType === '新增' ? _vm.pageType : '修改'))])],1)])],1)],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"coupon-add rights-add\">\r\n    <div class=\"coupon-add__form\">\r\n      <div class=\"coupon-add__form--title\">&nbsp;{{ pageType }}权益</div>\r\n      <div class=\"coupon-add__form--content\">\r\n        <el-form ref=\"couponForm\" :model=\"form\" label-width=\"180px\">\r\n          <div style=\"width: 600px\">\r\n            <el-form-item\r\n              label=\"权益名称：\"\r\n              prop=\"name\"\r\n              :rules=\"[\r\n                { required: true, message: '请输入标题', trigger: 'blur' }\r\n              ]\"\r\n            >\r\n              <el-input\r\n                :disabled=\"pageType === '编辑'\"\r\n                v-model=\"form.name\"\r\n                placeholder=\"请输入\"\r\n                maxlength=\"20\"\r\n                show-word-limit\r\n              />\r\n            </el-form-item>\r\n          </div>\r\n          <div style=\"width: 600px\">\r\n            <el-form-item\r\n              label=\"请选择权益类型：\"\r\n              prop=\"type\"\r\n              :rules=\"[\r\n                { required: true, message: '请选择权益类型', trigger: 'blur' }\r\n              ]\"\r\n            >\r\n              <el-select\r\n                style=\"width: 100%\"\r\n                v-model=\"form.type\"\r\n                :disabled=\"pageType === '编辑'\"\r\n                placeholder=\"请选择权益类型\"\r\n                clearable\r\n              >\r\n                <el-option\r\n                  v-for=\"item in $store.state.dictionary.rightsType\"\r\n                  :key=\"item.value\"\r\n                  :label=\"item.label\"\r\n                  :value=\"item.value\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </div>\r\n          <el-form-item\r\n            label=\"优惠形式：\"\r\n            prop=\"discount_mode\"\r\n            :rules=\"[\r\n              { required: true, message: '请选择优惠形式', trigger: 'blur' }\r\n            ]\"\r\n          >\r\n            <el-radio-group\r\n              v-model=\"form.discount_mode\"\r\n              :disabled=\"pageType === '编辑'\"\r\n            >\r\n              <el-radio label=\"PRICE\"> 优惠金额</el-radio>\r\n              <el-radio label=\"PERCENT\">优惠折扣</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <div class=\"money-item\" v-if=\"form.discount_mode === 'PRICE'\">\r\n            <el-form-item\r\n              label=\"优惠金额：\"\r\n              prop=\"discount_value\"\r\n              :rules=\"[\r\n                { required: true, message: '请输入优惠值', trigger: 'change' }\r\n              ]\"\r\n            >\r\n              <el-input\r\n                :disabled=\"pageType === '编辑'\"\r\n                @input=\"checkMoney\"\r\n                @change=\"MoneyToFixed\"\r\n                v-model=\"form.discount_value\"\r\n                placeholder=\"请输入\"\r\n                style=\"width: 80%\"\r\n              />\r\n              &nbsp;元 <span class=\"money-tips\">{{ moneyTips }}</span>\r\n            </el-form-item>\r\n          </div>\r\n          <div class=\"money-item\" v-if=\"form.discount_mode === 'PERCENT'\">\r\n            <el-form-item\r\n              label=\"优惠折扣：\"\r\n              prop=\"discount_value\"\r\n              :rules=\"[\r\n                { required: true, message: '请输入优惠折扣', trigger: 'blur' }\r\n              ]\"\r\n            >\r\n              <el-input-number\r\n                style=\"width: 80%\"\r\n                v-model.number=\"form.discount_value\"\r\n                :max=\"9.9\"\r\n                :min=\"0\"\r\n                :step=\"1\"\r\n              ></el-input-number>\r\n              &nbsp;折\r\n              <span class=\"money-tips-discount\">{{ moneyTipsDiscount }}</span>\r\n            </el-form-item>\r\n          </div>\r\n          <el-form-item\r\n            label=\"适用套餐：\"\r\n            prop=\"scope_product\"\r\n            :rules=\"[\r\n              { required: true, message: '请选择适用套餐', trigger: 'change' }\r\n            ]\"\r\n          >\r\n            <el-checkbox\r\n              :indeterminate=\"isIndeterminate\"\r\n              v-model=\"checkAll\"\r\n              @change=\"handleCheckAllChange\"\r\n              >全选</el-checkbox\r\n            >\r\n            <div style=\"margin: 5px 0;\"></div>\r\n            <el-checkbox-group\r\n              v-model=\"form.scope_product\"\r\n              @change=\"handleCheckedChange\"\r\n            >\r\n              <div>\r\n                <el-checkbox\r\n                  v-for=\"product in products\"\r\n                  :label=\"product.value\"\r\n                  :key=\"product.value\"\r\n                  >{{ product.label }}</el-checkbox\r\n                >\r\n              </div>\r\n            </el-checkbox-group>\r\n          </el-form-item>\r\n          <div v-if=\"form.type !== 'ASK'\">\r\n            <el-form-item\r\n              label=\"适用人群：\"\r\n              prop=\"scope_user\"\r\n              :rules=\"[\r\n                { required: true, message: '请选择适用人群', trigger: 'change' }\r\n              ]\"\r\n            >\r\n              <el-radio-group v-model=\"form.scope_user\">\r\n                <el-radio\r\n                  :label=\"item.value\"\r\n                  :key=\"item.value\"\r\n                  v-for=\"item in $store.state.dictionary.scopeUser\"\r\n                >\r\n                  {{ item.label }}</el-radio\r\n                >\r\n              </el-radio-group>\r\n            </el-form-item>\r\n            <div class=\"tips-wrap\">\r\n              <div>\r\n                无所选套餐购买记录用户：指从未购买过所选套餐的用户\r\n              </div>\r\n              <div>\r\n                无任何套餐购买记录用户：指从未购买过任何套餐的用户\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <el-form-item\r\n            label=\"权益描述：\"\r\n            prop=\"description\"\r\n            :rules=\"[\r\n              { required: true, message: '请输入权益描述', trigger: 'blur' }\r\n            ]\"\r\n          >\r\n            <el-input\r\n              v-model=\"form.description\"\r\n              type=\"textarea\"\r\n              maxlength=\"100\"\r\n              show-word-limit\r\n              rows=\"4\"\r\n              placeholder=\"请输入\"\r\n            />\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <div style=\"text-align: center\">\r\n              <el-button type=\"primary\" @click=\"submitCoupon\"\r\n                >确认{{ pageType === '新增' ? pageType : '修改' }}</el-button\r\n              >\r\n            </div>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addRights, getRightsOne, updateRights } from '@/api/marketing'\r\nimport { fenToYuan } from '@/filters'\r\nimport { getList } from '@/api/FdServiceType'\r\nimport _ from 'lodash'\r\n\r\nexport default {\r\n  name: 'Add',\r\n  data() {\r\n    return {\r\n      moneyTips: '请确保填写的优惠金额准确无误，以免对公司造成损失',\r\n      moneyTipsDiscount: '如需设置88折优惠，请填写8.8',\r\n      isIndeterminate: false,\r\n      checkAll: false,\r\n      products: [],\r\n      form: {\r\n        name: '',\r\n        type: '',\r\n        description: '',\r\n        discount_mode: null,\r\n        discount_value: null,\r\n        scope_product: [],\r\n        scope_user: ''\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    pageType() {\r\n      if (this.$route.params.type === 'update') {\r\n        return '编辑'\r\n      } else if (this.$route.params.type === 'add') {\r\n        return '新增'\r\n      }\r\n      return ''\r\n    }\r\n  },\r\n  created() {\r\n    this.getProducts()\r\n    if (this.$route.params.id !== 'new') {\r\n      getRightsOne(this.$route.params.id).then(res => {\r\n        this.form = this.pickCommonFormItem(res.data)\r\n        this.$nextTick(() => {\r\n          this.form.scope_product = res.data.scope_product.map(\r\n            item => item.batch_id\r\n          )\r\n          this.checkAll =\r\n            this.form.scope_product.length === this.products.length\r\n        })\r\n        this.form.discount_value = res.data.discount_value / 100\r\n        if (this.form.type === 'FD') {\r\n          this.form.scope_user = res.data.scope_user\r\n        }\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    MoneyToFixed(val) {\r\n      if (Number(val)) {\r\n        this.form.discount_value = Number(val).toFixed(2)\r\n      }\r\n    },\r\n    checkMoney(val) {\r\n      if (isNaN(Number(val))) {\r\n        this.form.discount_value = ''\r\n      }\r\n    },\r\n    pickCommonFormItem(form) {\r\n      return _.pick(form, [\r\n        'name',\r\n        'type',\r\n        'description',\r\n        'discount_mode',\r\n        'scope_product'\r\n      ])\r\n    },\r\n    handleCheckedChange(value) {\r\n      let checkedCount = value.length\r\n      this.checkAll = checkedCount === this.products.length\r\n      this.isIndeterminate =\r\n        checkedCount > 0 && checkedCount < this.products.length\r\n    },\r\n    handleCheckAllChange(val) {\r\n      const all = this.products.map(item => item.value)\r\n      this.form.scope_product = val ? all : []\r\n      this.isIndeterminate = false\r\n    },\r\n    fenToYuan,\r\n    getProducts() {\r\n      const params = {\r\n        show_history: 0\r\n      }\r\n      getList(params).then(res => {\r\n        const { list } = res.data\r\n        this.products = list.map(group => {\r\n          return {\r\n            value: group.batch_id,\r\n            label: `${group.title}\\xa0${group.sub_title}\\xa0\\xa0\\xa0(${\r\n              group.version\r\n            } ¥${group.price / 100}.00)`\r\n          }\r\n        })\r\n      })\r\n    },\r\n\r\n    // 提交表单\r\n    submitCoupon() {\r\n      this.$refs.couponForm.validate(valid => {\r\n        if (valid) {\r\n          const params = this.pickCommonFormItem(this.form)\r\n          params.discount_value = this.form.discount_value * 100\r\n          if (this.form.type === 'FD') {\r\n            params.scope_user = this.form.scope_user\r\n          }\r\n          if (this.pageType === '新增') {\r\n            addRights(params).then(res => {\r\n              this.$message.success('新增权益成功')\r\n              this.$router.push({ name: 'RightsList' })\r\n            })\r\n          } else {\r\n            updateRights(this.$route.params.id, params).then(res => {\r\n              this.$message.success('更新权益成功')\r\n              this.$router.push({ name: 'RightsList' })\r\n            })\r\n          }\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.rights-add {\r\n  .el-checkbox {\r\n    display: block;\r\n    width: 40%;\r\n  }\r\n}\r\n</style>\r\n<style scoped lang=\"scss\">\r\n.money-item {\r\n  position: relative;\r\n  width: 380px;\r\n  .money-tips {\r\n    position: absolute;\r\n    right: -50px;\r\n    margin-right: -225px;\r\n    font-size: 12px;\r\n    color: #f8747f;\r\n  }\r\n  .money-tips-discount {\r\n    position: absolute;\r\n    right: -50px;\r\n    margin-right: -108px;\r\n    font-size: 12px;\r\n    color: #f8747f;\r\n  }\r\n}\r\n.coupon-add {\r\n  display: flex;\r\n  &__preview {\r\n    position: relative;\r\n    padding: 0 30px;\r\n    flex: 1;\r\n    .preview-content {\r\n      position: absolute;\r\n      top: 120px;\r\n      left: 70px;\r\n      padding-right: 50px;\r\n      line-height: 30px;\r\n      font-size: 16px;\r\n    }\r\n    .phone-background {\r\n      width: 480px;\r\n      height: 854px;\r\n      background-size: cover;\r\n      border: 1px solid #e8eaec;\r\n      background-image: url('~@/assets/images/coupon/phonepreview.png');\r\n    }\r\n  }\r\n  &__form {\r\n    padding: 20px;\r\n    border: 1px solid #e8eaec;\r\n    flex: 3;\r\n    .range {\r\n      position: relative;\r\n      .all-doctor {\r\n        position: absolute;\r\n        top: 90px;\r\n        left: 50px;\r\n      }\r\n      .all-department {\r\n        position: absolute;\r\n        top: 45px;\r\n        left: 30px;\r\n      }\r\n    }\r\n    &--title {\r\n      font-size: 16px;\r\n      font-weight: bolder;\r\n      color: #0085ff;\r\n      border-left: 3px solid #0085ff;\r\n    }\r\n    &--content {\r\n      padding: 30px;\r\n      width: 850px;\r\n      .preferential {\r\n        margin-top: 10px;\r\n        &-num {\r\n          display: flex;\r\n          align-items: center;\r\n          margin: 10px 0;\r\n        }\r\n      }\r\n    }\r\n    .tips-wrap {\r\n      position: relative;\r\n      margin-top: -30px;\r\n      margin-left: 160px;\r\n      padding: 5px 20px;\r\n      line-height: 30px;\r\n      font-size: 12px;\r\n      color: #f8747f;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=03a6d974&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\nimport style1 from \"./index.vue?vue&type=style&index=1&id=03a6d974&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"03a6d974\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\r\n\r\nexport function getRightsList(params) {\r\n  return request({\r\n    url: '/trade/quanyi',\r\n    method: 'get',\r\n    params: params\r\n    // mock: true\r\n  })\r\n}\r\n\r\nexport function addRights(data) {\r\n  return request({\r\n    url: '/trade/quanyi',\r\n    method: 'post',\r\n    data: data\r\n    // mock: true\r\n  })\r\n}\r\n\r\nexport function getRightsOne(id) {\r\n  return request({\r\n    url: `/trade/quanyi/${id}`,\r\n    method: 'get'\r\n    // mock: true\r\n  })\r\n}\r\n\r\nexport function updateRights(id, params) {\r\n  return request({\r\n    url: `/trade/quanyi/${id}`,\r\n    method: 'put',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport function changeSaleStatus(id, params) {\r\n  return request({\r\n    url: `/fd/products/${id}/status`,\r\n    method: 'put',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport function updateServeStatus(id, status) {\r\n  return request({\r\n    url: `/trade/quanyi/${id}/status`,\r\n    method: 'put',\r\n    data: status\r\n    // mock: true\r\n  })\r\n}\r\n// 获取优惠券列表\r\nexport function getList(params) {\r\n  return request({\r\n    url: '/discount_coupon/list',\r\n    method: 'get',\r\n    params: params\r\n    // mock: true\r\n  })\r\n}\r\n// 获取列表筛选\r\nexport function getFilterApi() {\r\n  return request({\r\n    url: '/discount_coupon/filter',\r\n    method: 'get'\r\n  })\r\n}\r\n// 获取优惠券创建信息\r\nexport function getCouponCreateInfo() {\r\n  return request({\r\n    url: '/discount_coupon/create_info',\r\n    method: 'get'\r\n    // mock: true\r\n  })\r\n}\r\n// 新增优惠券\r\nexport function addCoupon(data) {\r\n  return request({\r\n    url: '/discount_coupon',\r\n    method: 'post',\r\n    data: data\r\n    // mock: true\r\n  })\r\n}\r\n// 生成小程序码\r\n// getCodeImg\r\nexport function getCodeImg(id) {\r\n  return request({\r\n    url: `discount_coupon/${id}/create_qrcode`,\r\n    method: 'put'\r\n  })\r\n}\r\n// 使失效\r\nexport function changeStatus(params) {\r\n  return request({\r\n    url: '/discount_coupon/' + params._id + '/change_status',\r\n    method: 'put',\r\n    data: params\r\n  })\r\n}\r\n","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"","import request from '@/utils/request'\r\n\r\nexport function getList(query) {\r\n  return request({\r\n    url: '/fd/products',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\nexport function addProducts(params) {\r\n  return request({\r\n    url: '/fd/products',\r\n    method: 'post',\r\n    data: params\r\n  })\r\n}\r\n// 获取筛选条\r\nexport function getFilter(query) {\r\n  return request({\r\n    url: '/fd_service_type/filter',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\nexport function getHistoryList(id, query) {\r\n  return request({\r\n    url: '/fd_service_type/' + id + '/logs',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\n// 11/api/fd_service_type/services 获取服务项目\r\nexport function getServices(id, query) {\r\n  return request({\r\n    url: '/fd_service_type/services',\r\n    method: 'get',\r\n    params: query\r\n    // mock: `/fd_service_type/services`\r\n  })\r\n}\r\n\r\nexport function changeSaleStatus(id, params) {\r\n  return request({\r\n    url: `/fd/products/${id}/status`,\r\n    method: 'put',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport function update(id, params) {\r\n  return request({\r\n    url: `/fd/products/${id}`,\r\n    method: 'put',\r\n    data: params\r\n    // mock: `/fd_service_type/${payload._id}`\r\n  })\r\n}\r\n\r\nexport function getEditInfo(id) {\r\n  return request({\r\n    url: `/fd/products/${id}`,\r\n    method: 'get'\r\n    // mock: `/fd_service_type/${id}`\r\n  })\r\n}\r\n\r\n// 上架替换同名套餐on_sale_id 上架id, 下架  off_sale_id\r\n// /api/fd_service_type/confirm_change_sale_status\r\nexport function replaceSaleApi(params) {\r\n  return request({\r\n    url: '/fd_service_type/confirm_change_sale_status',\r\n    method: 'put',\r\n    data: params\r\n  })\r\n}\r\n"],"sourceRoot":""}