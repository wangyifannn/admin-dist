(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ad8f405"],{"26a8":function(e,t,a){"use strict";var r=a("6f5d"),i=a.n(r);i.a},"38bd":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"customer__add__box margin-top-20 margin-bottom-30"},[e.showStep?a("div",{staticClass:"margin-top-20 step-box"},[a("Step",{attrs:{activeStep:2}})],1):e._e(),a("el-row",{staticClass:"margin-top-20",attrs:{gutter:24}},[a("el-col",{staticClass:"add-form-col",attrs:{span:11}},[a("h4",{staticClass:"margin-bottom-30"},[e._v("客户基本信息：")]),a("AddForm",{ref:"customerForm",attrs:{customerData:e.formData,pageType:e.pageType},on:{submitFun:e.submitFun}})],1),a("div",{staticClass:"divider"}),a("el-col",{staticClass:"baby-form-col",attrs:{span:10}},[a("h4",{staticClass:"margin-bottom-30"},[e._v("宝宝信息：")]),a("BabyForm",{ref:"babyForm",attrs:{babyArr:e.babyArr},on:{removeBaby:e.removeBaby}})],1)],1),a("Dialog",{attrs:{showCancelBtn:!0,btnText:"确认",title:""},on:{btnHandle:e.dialogConfirm},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[a("template",{slot:"headTip"},[e._v("\n      确认修改客户信息提示\n    ")]),a("template",{slot:"content"},[e._v("\n      确认修改该客户信息吗？\n    ")])],2)],1)},i=[],n=(a("7f7f"),a("db72")),s=(a("96cf"),a("3b8d")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("MyForm",{ref:"addCustomerForm",attrs:{form:e.form,formData:e.formData,formItem:e.formItem},on:{submit:e.searchSubmit}})},l=[],u=a("116c"),c=a("63d4"),d=a("2ef0"),m=a.n(d),f={data:function(){var e={showFormBorder:!1,showTitle:!1,ref:"addCustomerForm",labelWidth:"200px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!0,btnRight:!0,userId:"",relativeId:"",cancleShow:!1,submitText:"确认提交",cancleText:""};return{searchParams:{},formItem:[],formData:{},form:e}},props:{customerData:{type:Object,default:function(){}},optionsVal:{type:String,default:""},moduleName:{type:String,default:""},pageType:{type:String,default:""}},components:{MyForm:c["a"]},created:function(){this.userId=this.$route.params.id||this.$route.query.userId,this.relativeId=this.$route.query.relative_id},watch:{customerData:{handler:function(e){this.formInit(e)},deep:!0}},methods:{setFormAttrByPage:function(){this.userId?(this.form.submitText="确认修改",this.formItem[3].isOpen="all",this.formItem[4].isOpen="all",this.formItem[3].disabled=!0,this.formItem[4].disabled=!0):(this.form.submitText="确认提交",this.formItem[3].isOpen=!0,this.formItem[4].isOpen=!0,this.formItem[3].disabled=!1,this.formItem[4].disabled=!1),this.formItem[0].disabled=!(!this.userId&&!this.relativeId),this.formItem[5].disabled=!!this.userId},searchSubmit:function(e){this.$emit("submitFun",e)},formInit:function(e){this.formItem=Object(u["b"])("customerAddForm","item");var t=m.a.some(e,Boolean);this.formData=t?e:Object(u["b"])("customerAddForm","data"),this.setFormAttrByPage()},reset:function(){this.$emit("reset")}}},b=f,h=a("2877"),p=Object(h["a"])(b,o,l,!1,null,null,null),y=p.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"baby_answer_box"},[e.babyArr.length?a("div",e._l(e.babyArr,(function(t,r){return a("el-row",{key:r+"baby",attrs:{gutter:24}},[a("div",{staticClass:"baby_form_box"},[a("div",{staticClass:"baby_form_item"},[a("i",{directives:[{name:"show",rawName:"v-show",value:!1!==t.can_edit,expression:"item.can_edit !== false"}],staticClass:"el-icon-close close_baby_icon",on:{click:function(t){return e.removeBaby(r)}}}),a("el-form",{ref:"babyArr"+r,refInFor:!0,staticClass:"baby_answer_Form",attrs:{model:t,disabled:!1===t.can_edit,"label-width":"120px","label-position":"right",size:"mini"}},[a("el-form-item",{attrs:{label:"宝宝乳名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入宝宝乳名"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1),a("el-form-item",{attrs:{label:"宝宝是否出生",prop:"is_born",rules:{required:!0,message:"请选择宝宝是否出生",trigger:"blur"}}},[a("el-radio-group",{model:{value:t.is_born,callback:function(a){e.$set(t,"is_born",a)},expression:"item.is_born"}},[a("el-radio",{attrs:{label:!0}},[e._v("已出生")]),a("el-radio",{attrs:{label:!1}},[e._v("未出生")])],1)],1),!0===t.is_born?a("el-form-item",{attrs:{label:"宝宝性别",prop:"gender",rules:{required:!0,message:"请选择宝宝性别",trigger:"blur"}}},[a("el-radio-group",{model:{value:t.gender,callback:function(a){e.$set(t,"gender",a)},expression:"item.gender"}},[a("el-radio",{attrs:{label:1}},[e._v("男")]),a("el-radio",{attrs:{label:2}},[e._v("女")]),a("el-radio",{attrs:{label:0}},[e._v("未知")])],1)],1):e._e(),!0===t.is_born?a("el-form-item",{attrs:{label:"宝宝出生日期",prop:"birthday",rules:{required:!0,message:"请选择宝宝出生日期",trigger:"blur"}}},[a("el-date-picker",{attrs:{placeholder:"请选择宝宝出生日期",type:"date","picker-options":e.pickerOptions,disabled:t.disabled},model:{value:t.birthday,callback:function(a){e.$set(t,"birthday",a)},expression:"item.birthday"}})],1):e._e(),!1===t.is_born?a("el-form-item",{attrs:{label:"宝宝预产期",prop:"birthday",rules:{required:!0,message:"请选择宝宝预产期",trigger:"blur"}}},[a("el-date-picker",{attrs:{placeholder:"请选择宝宝预产期",type:"date",disabled:t.disabled,"picker-options":e.noBornOptions},model:{value:t.birthday,callback:function(a){e.$set(t,"birthday",a)},expression:"item.birthday"}})],1):e._e(),t.age_of_month?a("el-form-item",{attrs:{label:"宝宝月龄",prop:"age_of_month"}},[a("el-input",{attrs:{disabled:!0,placeholder:"请填写宝宝月龄"},model:{value:t.age_of_month,callback:function(a){e.$set(t,"age_of_month",a)},expression:"item.age_of_month"}})],1):e._e()],1)],1)])])})),1):e._e(),a("div",[a("p",{staticClass:"add_answer_btn",staticStyle:{margin:"0 auto",width:"200px"},on:{click:function(t){return e.addBabyFun()}}},[a("i",{staticClass:"el-icon-plus"}),e._v("添加宝宝\n    ")])])])},v=[],_=a("8975"),I={props:{babyArr:{type:Array,default:function(){return[]}}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},noBornOptions:{disabledDate:function(e){return e.getTime()<Date.now()}}}},components:{},created:function(){},methods:{getRandom:_["getRandom"],formInit:function(e,t){var a={name:"",birthday:"",is_born:"",gender:"",can_edit:!0,age_of_month:""};this.babyArr.push(a)},addBabyFun:function(){this.formInit()},removeBaby:function(e){this.$emit("removeBaby",e)}}},w=I,D=(a("26a8"),Object(h["a"])(w,g,v,!1,null,null,null)),F=D.exports,C=a("9039"),T=a("d0100"),k=a("3acd"),x={data:function(){return{babyFormValid:!0,relatedData:{},cusertomerData:{},formData:{},addData:{},userId:"",showDialog:!1,babyArr:[],relativeId:""}},props:{showStep:{type:Boolean,default:!0},pageType:{type:String,default:""}},components:{AddForm:y,Step:T["a"],BabyForm:F,Dialog:C["a"]},created:function(){this.relativeId=this.$route.query.relative_id,this.userId="updateCustomer"===this.pageType?this.$route.params.id:this.$route.query.userId},watch:{relativeId:function(e){e&&this.getData()},userId:function(){this.relativeId||this.getData()}},methods:{removeBaby:function(e){this.babyArr=m.a.remove(this.babyArr,(function(t,a){return!(a===e)}))},getRelatedInfoById:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.relativeId){e.next=3;break}return e.next=3,Object(k["m"])(this.relativeId).then((function(e){e&&(t.relatedData=e.data,t.babyArr=e.data.babys)}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getRelatedInfoById();case 2:if(!this.userId){e.next=5;break}return e.next=5,Object(k["g"])(this.userId).then((function(e){e&&e.data&&(a.cusertomerData=e.data,a.babyArr=a.babyArr.concat(e.data.babys))}));case 5:t=Object.assign(this.cusertomerData,this.relatedData),t.sourceChannel=t.source_channel?t.source_channel:"",this.formData=t;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),submitFun:function(e){var t=this.$refs.babyForm.$refs,a=this;if(m.a.forIn(t,(function(e,t){e&&e.length&&!0!==e[0].disabled?e[0].validate((function(e){if(!e)return a.babyFormValid=!1,!1;a.babyFormValid=!0})):a.babyFormValid=!0})),this.babyFormValid){if(this.addData=e,this.addData.source_channel=this.addData.sourceChannel?this.addData.sourceChannel[2]:"",this.babyArr.length){var r=m.a.filter(this.babyArr,(function(e){return e.can_edit}));r=r.map((function(e){return Object(n["a"])({},e,{name:e.name?e.name:"未知"})})),this.addData.babys=r}else this.addData.babys=[];this.addData.relative_user=this.relativeId,"updateCustomer"!==this.pageType?this.submitApiFun():this.showDialog=!0}},submitApiFun:function(){this.babyFormValid&&this.userId&&this.relativeId?this.customerRelatedUser(this.addData,this.userId):this.babyFormValid&&this.addCustomerFun(this.addData)},dialogCancel:function(){this.showDialog=!1},dialogConfirm:function(){this.submitApiFun(),this.dialogCancel()},addCustomerFun:function(e){var t=this,a=this.userId?k["o"]:k["a"],r=this.userId?"修改":"添加";a(e,this.userId).then((function(e){t.$message({type:e.data.result?"success":"error",message:e.data.result?r+"成功":r+"失败"});var a=t.initCustomerForm();t.$refs.customerForm.formData=a,e&&e.data.result&&t.$router.push({path:"".concat(t.$route.meta.activeMenu),query:{date:(new Date).getTime()}})}))},customerRelatedUser:function(e,t){var a=this;Object(k["d"])(e,t).then((function(e){var t="关联用户";a.$message({type:e.data.result?"success":"error",message:e.data.result?t+"成功":t+"失败"});var r=a.initCustomerForm();a.$refs.customerForm.formData=r,e&&e.data.result&&a.$router.push({path:"".concat(a.$route.meta.activeMenu),query:{date:(new Date).getTime()}})}))},initCustomerForm:function(){var e={nickname:"",weapp_id:"",is_during_pregnancy:"",user_type:"",source_channel:"",customer_ask:"",realName:"",relative_user:"",phone:"",remark:"",sourceChannel:""};return e}}},$=x,A=(a("8e16"),Object(h["a"])($,r,i,!1,null,null,null));t["default"]=A.exports},5118:function(e,t,a){(function(e){var r="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function n(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new n(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new n(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},a("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,a("24aa"))},"550c":function(e,t,a){},6017:function(e,t,a){(function(e,t){(function(e,a){"use strict";if(!e.setImmediate){var r,i=1,n={},s=!1,o=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?f():b()?h():e.MessageChannel?p():o&&"onreadystatechange"in o.createElement("script")?y():g(),l.setImmediate=u,l.clearImmediate=c}function u(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),a=0;a<t.length;a++)t[a]=arguments[a+1];var s={callback:e,args:t};return n[i]=s,r(i),i++}function c(e){delete n[e]}function d(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(a,r);break}}function m(e){if(s)setTimeout(m,0,e);else{var t=n[e];if(t){s=!0;try{d(t)}finally{c(e),s=!1}}}}function f(){r=function(e){t.nextTick((function(){m(e)}))}}function b(){if(e.postMessage&&!e.importScripts){var t=!0,a=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=a,t}}function h(){var t="setImmediate$"+Math.random()+"$",a=function(a){a.source===e&&"string"===typeof a.data&&0===a.data.indexOf(t)&&m(+a.data.slice(t.length))};e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(a){e.postMessage(t+a,"*")}}function p(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;m(t)},r=function(t){e.port2.postMessage(t)}}function y(){var e=o.documentElement;r=function(t){var a=o.createElement("script");a.onreadystatechange=function(){m(t),a.onreadystatechange=null,e.removeChild(a),a=null},e.appendChild(a)}}function g(){r=function(e){setTimeout(m,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,a("24aa"),a("4362"))},"6f5d":function(e,t,a){},"8e16":function(e,t,a){"use strict";var r=a("550c"),i=a.n(r);i.a},d0100:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"step-box margin-bottom-30"},[a("el-steps",{attrs:{space:200,"align-center":"",active:e.activeStep,"finish-status":"success"}},[a("el-step",{attrs:{title:"关联客户"}}),a("el-step",{attrs:{title:"完善客户信息"}})],1)],1)],1)},i=[],n=(a("c5f6"),{data:function(){return{}},props:{activeStep:{type:Number,default:1}}}),s=n,o=a("2877"),l=Object(o["a"])(s,r,i,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-0ad8f405.7b5da7eb.js.map