{"version":3,"sources":["webpack:///./src/views/trade-manage/refund/batch-handle/index.vue?c40c","webpack:///./src/api/refund.js","webpack:///./src/views/trade-manage/refund/batch-handle/index.vue?5387","webpack:///./src/views/trade-manage/refund/batch-handle/index.vue?450c","webpack:///src/views/trade-manage/refund/batch-handle/index.vue","webpack:///./src/views/trade-manage/refund/batch-handle/index.vue?d620","webpack:///./src/views/trade-manage/refund/batch-handle/index.vue"],"names":["getRefundListParams","request","url","method","getRefundList","data","getRefundProcess","agreeRefund","id","refuseRefund","getRefundDetail","changeRefundAmount","reTransfer","successManual","getBatchRefundList","params","batchAgreeRefund","render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","batchHandlerList","scopedSlots","_u","key","fn","scope","row","refundReasonKey","refundOtherReasonDescribe","_v","_s","refundReasonValue","RMBSymbol","fenToYuan","payPrice","refundCount","slot","length","_f","refundTotalAmount","BARLoading","on","handleGoBack","class","batchRefundStatus","dialogVisible","$event","batchRefundResult","count","total","_e","failCount","handleOkFun","staticRenderFns","batchRefundIds","computed","reduce","created","methods","refund_ids","refundFilterQuery","disabled","$router","push","component"],"mappings":"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","file":"static/js/chunk-49306c86.afb80518.js","sourcesContent":["import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"","import request from '@/utils/request'\r\n\r\nexport function getRefundListParams() {\r\n  return request({\r\n    url: '/order_refund/filter',\r\n    method: 'get'\r\n  })\r\n}\r\n\r\nexport function getRefundList(data) {\r\n  return request({\r\n    url: '/order_refund/list',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\nexport function getRefundProcess() {\r\n  return request({\r\n    url: '/order_refund/process_numbers',\r\n    method: 'get'\r\n    // mock: '/order_refund/process_numbers'\r\n  })\r\n}\r\n\r\n// 同意退款\r\nexport function agreeRefund(id) {\r\n  return request({\r\n    url: `/order_refund/${id}/agree`,\r\n    method: 'put'\r\n    // mock: `/order_refund/${id}/agree`\r\n  })\r\n}\r\n\r\n// 拒绝退款\r\nexport function refuseRefund(id, data) {\r\n  return request({\r\n    url: `/order_refund/${id}/refuse`,\r\n    method: 'put',\r\n    data\r\n    // mock: `/order_refund/${id}/refuse`\r\n  })\r\n}\r\n\r\n// 获取退款订单详情\r\nexport function getRefundDetail(id) {\r\n  return request({\r\n    url: `/order_refund/${id}`,\r\n    method: 'get'\r\n    // mock: `/order_refund/${id}`\r\n  })\r\n}\r\n\r\n/**\r\n * 修改退款金额\r\n * @param {String} id\r\n * @param {Object: {\r\n *  refund_amount: Number,\r\n *  change_reason: String\r\n * }} data\r\n */\r\nexport function changeRefundAmount(id, data) {\r\n  return request({\r\n    url: `/order_refund/${id}/change_refund_amount`,\r\n    method: 'put',\r\n    data\r\n    // mock: `/order_refund/${id}/change_refund_amount`\r\n  })\r\n}\r\n\r\n// 申请转账\r\nexport function reTransfer(id) {\r\n  return request({\r\n    url: `/order_refund/${id}/re_transfer`,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\n/**\r\n * 人工退款处理成功\r\n * @param {String} id\r\n * @param {Object: {\r\n *  pay_channel: Number,\r\n *  transfer_amount: String,\r\n *  transfer_success_proof: [string]\r\n * }} data\r\n */\r\nexport function successManual(id, data) {\r\n  return request({\r\n    url: `/order_refund/${id}/success_manual`,\r\n    method: 'put',\r\n    data\r\n    // mock: `/order_refund/${id}/success_manual`\r\n  })\r\n}\r\n\r\n/**\r\n * 通过订单idArr.join(',')获取订单\r\n * @param {String} id\r\n * @param {[String]} params.refund_ids // 需要退款的所有退款 _id\r\n */\r\nexport function getBatchRefundList(params) {\r\n  return request({\r\n    url: '/order_refund/batch/check',\r\n    method: 'get',\r\n    params\r\n    // mock: '/order_refund/batch/check'\r\n  })\r\n}\r\n\r\n/**\r\n * 批量同意退款\r\n * @param {[String]} params.refund_ids // 需要退款的所有退款 _id\r\n */\r\n\r\nexport function batchAgreeRefund(data) {\r\n  return request({\r\n    url: '/order_refund/batch/agree',\r\n    method: 'put',\r\n    data\r\n    // mock: '/order_refund/batch/agree'\r\n  })\r\n}\r\n","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=1&id=5cd748a2&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=1&id=5cd748a2&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"refund-batch-handle\"},[_c('el-table',{staticClass:\"refund-batch-handle__table\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.batchHandlerList}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"orderId\",\"label\":\"宝宝ID\",\"min-width\":\"150\",\"fixed\":\"\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"原因\",\"min-width\":\"240\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"refund__refund-reason-col\"},[(\n              scope.row.refundReasonKey === 'other' &&\n                scope.row.refundOtherReasonDescribe\n            )?_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"content\":scope.row.refundOtherReasonDescribe,\"placement\":\"bottom\"}},[_c('span',{staticClass:\"refund__refund-reason-col__refund-other-reason\"},[_vm._v(_vm._s(scope.row.refundReasonValue))])]):_c('span',[_vm._v(_vm._s(scope.row.refundReasonValue))])],1)]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"交易金额\",\"min-width\":\"140\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(_vm.RMBSymbol(_vm.fenToYuan(scope.row.payPrice))))]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"退款金额\",\"min-width\":\"140\",\"fixed\":\"right\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(_vm.RMBSymbol(_vm.fenToYuan(scope.row.refundCount))))]}}])}),_c('div',{staticClass:\"refund-batch-handle__table__footer\",attrs:{\"slot\":\"append\"},slot:\"append\"},[_c('div',{staticClass:\"refund-batch-handle__table__footer__refund-len\"},[_c('div',[_vm._v(\"总计\")]),_c('div',[_vm._v(\"批量退款订单数：\"+_vm._s(_vm.batchHandlerList.length)+\"笔\")])]),_c('div',{staticClass:\"refund-batch-handle__table__footer__total-amount\"},[_vm._v(\"\\n        批量退款总额：\"+_vm._s(_vm._f(\"RMBSymbol\")(_vm._f(\"fenToYuan\")(_vm.refundTotalAmount)))+\"\\n      \")])])],1),_c('div',{staticClass:\"refund-batch-handle__handler\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"loading\":_vm.BARLoading},on:{\"click\":_vm.batchAgreeRefund}},[_vm._v(\"\\n      批量同意退款\\n    \")]),_c('el-button',{staticClass:\"refund-batch-handle__handler__goback-btn\",attrs:{\"type\":\"primary\",\"plain\":\"\",\"size\":\"small\"},on:{\"click\":_vm.handleGoBack}},[_vm._v(\"\\n      返回退款列表\\n    \")])],1),_c('el-dialog',{class:(\"refund-batch-handle__dialog--\" + (_vm.batchRefundStatus ? 'success' : 'fail')),attrs:{\"visible\":_vm.dialogVisible,\"title\":(\"转账请求\" + (_vm.batchRefundStatus ? '成功' : '失败')),\"width\":\"400px\",\"top\":\"35vh\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('div',{staticClass:\"refund-batch-handle__dialog__body\"},[_c('div',[_vm._v(\"\\n        批量同意退款\"+_vm._s(_vm.batchRefundStatus ? '成功' : '失败')+\"，总计：\"+_vm._s(_vm.batchRefundResult.count)+\"笔；退款总额：\"+_vm._s(_vm._f(\"RMBSymbol\")(_vm._f(\"fenToYuan\")(_vm.batchRefundResult.total)))+\"\\n      \")]),(!_vm.batchRefundStatus)?_c('div',[_vm._v(\"\\n        其中\\n        \"),_c('span',{staticClass:\"cherry\"},[_vm._v(\" \"+_vm._s(_vm.batchRefundResult.failCount)+\"笔 \")]),_vm._v(\"\\n        请求转账\\n        \"),_c('span',{staticClass:\"cherry\"},[_vm._v(\"\\n          失败！\\n        \")])]):_vm._e(),_c('div',{staticClass:\"cherry\"},[(_vm.batchRefundStatus)?_c('span',[_vm._v(\"已全部成功发起转账，待转账！\")]):_c('span',[_vm._v(\"请尽快了解原因，处理后再次发起转账请求！\")])])]),_c('span',{staticClass:\"refund-batch-handle__dialog__footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.handleOkFun}},[_vm._v(\"\\n        确定\\n      \")]),_c('el-button',{staticClass:\"refund-batch-handle__dialog__cancel\",attrs:{\"size\":\"small\"},on:{\"click\":_vm.handleOkFun}},[_vm._v(\"\\n        取消\\n      \")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"refund-batch-handle\">\r\n    <el-table\r\n      class=\"refund-batch-handle__table\"\r\n      :data=\"batchHandlerList\"\r\n      style=\"width: 100%\"\r\n    >\r\n      <el-table-column\r\n        align=\"center\"\r\n        prop=\"orderId\"\r\n        label=\"宝宝ID\"\r\n        min-width=\"150\"\r\n        fixed\r\n      />\r\n      <el-table-column align=\"center\" label=\"原因\" min-width=\"240\">\r\n        <template slot-scope=\"scope\">\r\n          <div class=\"refund__refund-reason-col\">\r\n            <el-tooltip\r\n              v-if=\"\r\n                scope.row.refundReasonKey === 'other' &&\r\n                  scope.row.refundOtherReasonDescribe\r\n              \"\r\n              effect=\"dark\"\r\n              :content=\"scope.row.refundOtherReasonDescribe\"\r\n              placement=\"bottom\"\r\n            >\r\n              <span class=\"refund__refund-reason-col__refund-other-reason\">{{\r\n                scope.row.refundReasonValue\r\n              }}</span>\r\n            </el-tooltip>\r\n            <span v-else>{{ scope.row.refundReasonValue }}</span>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"交易金额\" min-width=\"140\">\r\n        <template slot-scope=\"scope\">{{\r\n          RMBSymbol(fenToYuan(scope.row.payPrice))\r\n        }}</template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        align=\"center\"\r\n        label=\"退款金额\"\r\n        min-width=\"140\"\r\n        fixed=\"right\"\r\n      >\r\n        <template slot-scope=\"scope\">{{\r\n          RMBSymbol(fenToYuan(scope.row.refundCount))\r\n        }}</template>\r\n      </el-table-column>\r\n      <div slot=\"append\" class=\"refund-batch-handle__table__footer\">\r\n        <div class=\"refund-batch-handle__table__footer__refund-len\">\r\n          <div>总计</div>\r\n          <div>批量退款订单数：{{ batchHandlerList.length }}笔</div>\r\n        </div>\r\n        <div class=\"refund-batch-handle__table__footer__total-amount\">\r\n          批量退款总额：{{ refundTotalAmount | fenToYuan | RMBSymbol }}\r\n        </div>\r\n      </div>\r\n    </el-table>\r\n    <div class=\"refund-batch-handle__handler\">\r\n      <el-button\r\n        type=\"primary\"\r\n        size=\"small\"\r\n        :loading=\"BARLoading\"\r\n        @click=\"batchAgreeRefund\"\r\n      >\r\n        批量同意退款\r\n      </el-button>\r\n      <el-button\r\n        class=\"refund-batch-handle__handler__goback-btn\"\r\n        type=\"primary\"\r\n        plain\r\n        size=\"small\"\r\n        @click=\"handleGoBack\"\r\n      >\r\n        返回退款列表\r\n      </el-button>\r\n    </div>\r\n    <el-dialog\r\n      :class=\"\r\n        `refund-batch-handle__dialog--${batchRefundStatus ? 'success' : 'fail'}`\r\n      \"\r\n      :visible.sync=\"dialogVisible\"\r\n      :title=\"`转账请求${batchRefundStatus ? '成功' : '失败'}`\"\r\n      width=\"400px\"\r\n      top=\"35vh\"\r\n      center\r\n    >\r\n      <div class=\"refund-batch-handle__dialog__body\">\r\n        <div>\r\n          批量同意退款{{ batchRefundStatus ? '成功' : '失败' }}，总计：{{\r\n            batchRefundResult.count\r\n          }}笔；退款总额：{{ batchRefundResult.total | fenToYuan | RMBSymbol }}\r\n        </div>\r\n        <div v-if=\"!batchRefundStatus\">\r\n          其中\r\n          <span class=\"cherry\"> {{ batchRefundResult.failCount }}笔 </span>\r\n          请求转账\r\n          <span class=\"cherry\">\r\n            失败！\r\n          </span>\r\n        </div>\r\n        <div class=\"cherry\">\r\n          <span v-if=\"batchRefundStatus\">已全部成功发起转账，待转账！</span>\r\n          <span v-else>请尽快了解原因，处理后再次发起转账请求！</span>\r\n        </div>\r\n      </div>\r\n      <span slot=\"footer\" class=\"refund-batch-handle__dialog__footer\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"handleOkFun\">\r\n          确定\r\n        </el-button>\r\n        <el-button\r\n          class=\"refund-batch-handle__dialog__cancel\"\r\n          size=\"small\"\r\n          @click=\"handleOkFun\"\r\n        >\r\n          取消\r\n        </el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {\r\n  getBatchRefundList as getBatchRefundListApi,\r\n  batchAgreeRefund as batchAgreeRefundApi\r\n} from '@/api/refund'\r\n\r\nimport { localRead, localSave } from '@/utils'\r\nimport { RMBSymbol, fenToYuan } from '@/filters'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      batchRefundIds: [],\r\n      batchHandlerList: [],\r\n      dialogVisible: false,\r\n      batchRefundResult: {},\r\n      BARLoading: false\r\n    }\r\n  },\r\n  computed: {\r\n    refundTotalAmount() {\r\n      return this.batchHandlerList.reduce(\r\n        (curRefundTotalAmount, { refundCount }) =>\r\n          curRefundTotalAmount + refundCount,\r\n        0\r\n      )\r\n    },\r\n    batchRefundStatus() {\r\n      return (\r\n        !this.batchRefundResult.failCount ||\r\n        this.batchRefundResult.failCount === 0\r\n      )\r\n    }\r\n  },\r\n  created() {\r\n    this.batchRefundIds = localRead('batch-refund-ids').split(',')\r\n    this.getBatchRefundList(localRead('batch-refund-ids'))\r\n  },\r\n  methods: {\r\n    RMBSymbol,\r\n    fenToYuan,\r\n    async getBatchRefundList(batchRefundIds) {\r\n      const { data } = await getBatchRefundListApi(\r\n        batchRefundIds ? { refund_ids: batchRefundIds } : {}\r\n      )\r\n      this.batchHandlerList = data.list.map(order => ({\r\n        orderId: order.order_id,\r\n        refundReasonKey: order.refund_reason.key,\r\n        refundReasonValue: order.refund_reason.value,\r\n        refundOtherReasonDescribe: order.refund_reason.other_desc,\r\n        payPrice: order.pay_price,\r\n        refundCount: order.refund_amount\r\n      }))\r\n    },\r\n    batchAgreeRefund() {\r\n      this.BARLoading = true\r\n      batchAgreeRefundApi({\r\n        refund_ids: this.batchRefundIds\r\n      })\r\n        .then(({ data }) => {\r\n          this.batchRefundResult = {\r\n            count: data.count,\r\n            total: data.total,\r\n            failCount: data.fail_count\r\n          }\r\n          this.BARLoading = false\r\n          this.dialogVisible = true\r\n        })\r\n        .catch(() => {\r\n          this.BARLoading = false\r\n          this.$message.error('批量退款失败！')\r\n        })\r\n    },\r\n    handleOkFun() {\r\n      this.dialogVisible = false\r\n      this.handleGoBack()\r\n    },\r\n    handleGoBack() {\r\n      const refundFilterQuery = localRead('refund-filter-query')\r\n        ? JSON.parse(localRead('refund-filter-query'))\r\n        : {}\r\n      refundFilterQuery.disabled = false\r\n      localSave('refund-filter-query', JSON.stringify(refundFilterQuery))\r\n      this.$router.push({ name: 'RefundOrderList' })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.refund-batch-handle {\r\n  .el-dialog--center .el-dialog__body {\r\n    padding: 0;\r\n  }\r\n  .el-dialog__footer {\r\n    padding-top: 0;\r\n  }\r\n  &__dialog {\r\n    &--fail {\r\n      .el-dialog__title {\r\n        color: #f8747f;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n.refund-batch-handle {\r\n  .cherry {\r\n    color: #f8747f;\r\n  }\r\n\r\n  padding: 0 20px;\r\n  &__table {\r\n    &__footer {\r\n      display: flex;\r\n      align-items: flex-end;\r\n      justify-content: space-between;\r\n      padding: 22px 40px;\r\n      background: rgba(246, 247, 251, 0.61);\r\n      &__refund-len {\r\n        padding-left: 10px;\r\n        line-height: 30px;\r\n        color: #0085ff;\r\n      }\r\n      &__total-amount {\r\n        color: #f0717b;\r\n      }\r\n    }\r\n  }\r\n  &__handler {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    padding: 30px 0;\r\n    &__goback-btn {\r\n      margin-left: 20px;\r\n    }\r\n  }\r\n  &__dialog {\r\n    &__body {\r\n      padding: 18px 22px;\r\n      line-height: 22px;\r\n    }\r\n    &__cancel {\r\n      margin-left: 20px;\r\n      color: #999;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=5cd748a2&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\nimport style1 from \"./index.vue?vue&type=style&index=1&id=5cd748a2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5cd748a2\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}