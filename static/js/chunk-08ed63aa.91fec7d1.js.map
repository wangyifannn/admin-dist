{"version":3,"sources":["webpack:///./src/views/medical-service/health-management/components/common/VideoItem.vue?821b","webpack:///./src/views/medical-service/health-management/batchSend.vue?c999","webpack:///./src/views/medical-service/health-management/components/common/VideoUploader.vue?45a5","webpack:///src/views/medical-service/health-management/components/common/VideoUploader.vue","webpack:///./src/views/medical-service/health-management/components/common/VideoUploader.vue?6c1e","webpack:///./src/views/medical-service/health-management/components/common/VideoUploader.vue","webpack:///./src/views/medical-service/health-management/batchSend.vue?ef54","webpack:///src/views/medical-service/health-management/batchSend.vue","webpack:///./src/views/medical-service/health-management/batchSend.vue?8f6e","webpack:///./src/views/medical-service/health-management/batchSend.vue","webpack:///./src/views/medical-service/health-management/components/SendContentPreview.vue?5b77","webpack:///src/views/medical-service/health-management/components/SendContentPreview.vue","webpack:///./src/views/medical-service/health-management/components/SendContentPreview.vue?db5e","webpack:///./src/views/medical-service/health-management/components/SendContentPreview.vue","webpack:///./src/api/upload.js","webpack:///./src/utils/healthManagement/index.js","webpack:///./src/views/medical-service/health-management/components/common/VideoItem.vue?a126","webpack:///src/views/obstetrics-doctor/healthFollow/components/common/VideoItem.vue","webpack:///./src/views/medical-service/health-management/components/common/VideoItem.vue?12c7","webpack:///./src/views/medical-service/health-management/components/common/VideoItem.vue","webpack:///./src/views/medical-service/health-management/components/SendContentPreview.vue?15a2","webpack:///./src/views/medical-service/health-management/batchSend.vue?b6d6"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","attrs","uploadLoading","handleFileError","handleFileSuccess","beforeFileUpload","uploadFileFunc","fileList","handleChange","videoExceed","previewVideo","videoRemove","length","slot","_v","staticStyle","monitorInfo","staticRenderFns","name","props","type","Function","default","Boolean","Array","fileUrlList","components","Monitor","data","methods","meta","$refs","monitor","show","$message","warning","isSuccessType","error","component","directives","rawName","value","status","expression","ruleForm","required","message","trigger","model","callback","$$v","$set","_l","item","key","label","_s","babyList","_e","on","handleImageAdded","contentVideos","handleSave","preview","serviceType","replace","returnEdit","loadingStatus","send","VueEditor","VideoUploader","SendContentPreview","taskId","isSaved","createdTaskId","title","content","contentPic","contentTxt","options","mounted","$route","query","split","isReplace","getTaskContent","splice","removeIndex","res","code","setTimeout","path","babyNum","saveTask","getSimpleText","bus_user","hm","validate","valid","domProps","url","VideoItem","Object","oss","request","method","getImageMeta","postObject","ossData","file","onProgress","FormData","append","OSSAccessKeyId","policy","Signature","headers","onUploadProgress","indexOf","videoMeta","size","Error","extname","filename","a","reverse","join","b","substring","search","upload","random","Math","floor","fileName","Date","getTime","fileType","prefix","vaccineType","row","vaccine_type","vaccineClass","vaccine_class","html","re1","RegExp","msg","slice","statusOptions","$event","showMediaDetail","String"],"mappings":"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","file":"static/js/chunk-08ed63aa.91fec7d1.js","sourcesContent":["import mod from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoItem.vue?vue&type=style&index=0&id=df4e0e06&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoItem.vue?vue&type=style&index=0&id=df4e0e06&scoped=true&lang=scss&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./batchSend.vue?vue&type=style&index=1&lang=scss&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./batchSend.vue?vue&type=style&index=1&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo\",attrs:{\"multiple\":\"\",\"disabled\":_vm.uploadLoading,\"action\":\"\",\"limit\":3,\"on-error\":_vm.handleFileError,\"on-success\":_vm.handleFileSuccess,\"before-upload\":_vm.beforeFileUpload,\"http-request\":_vm.uploadFileFunc,\"file-list\":_vm.fileList,\"on-change\":_vm.handleChange,\"on-exceed\":_vm.videoExceed,\"on-preview\":_vm.previewVideo,\"before-remove\":_vm.videoRemove}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"small\",\"type\":\"primary\",\"disabled\":_vm.fileList.length >= 3,\"loading\":_vm.uploadLoading},slot:\"trigger\"},[_vm._v(\"\\n      上传视频\\n    \")]),_c('div',{staticClass:\"el-upload__tip\",staticStyle:{\"color\":\"#F8747F\"},attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"\\n      温馨提示：视频上传后会在文章末尾依次展示，支持最多3个视频\\n    \")])],1),_c('monitor',{ref:\"monitor\",attrs:{\"monitor-info\":_vm.monitorInfo}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <el-upload\r\n      ref=\"upload\"\r\n      multiple\r\n      :disabled=\"uploadLoading\"\r\n      class=\"upload-demo\"\r\n      action=\"\"\r\n      :limit=\"3\"\r\n      :on-error=\"handleFileError\"\r\n      :on-success=\"handleFileSuccess\"\r\n      :before-upload=\"beforeFileUpload\"\r\n      :http-request=\"uploadFileFunc\"\r\n      :file-list=\"fileList\"\r\n      :on-change=\"handleChange\"\r\n      :on-exceed=\"videoExceed\"\r\n      :on-preview=\"previewVideo\"\r\n      :before-remove=\"videoRemove\"\r\n    >\r\n      <el-button\r\n        slot=\"trigger\"\r\n        size=\"small\"\r\n        type=\"primary\"\r\n        :disabled=\"fileList.length >= 3\"\r\n        :loading=\"uploadLoading\"\r\n      >\r\n        上传视频\r\n      </el-button>\r\n      <div slot=\"tip\" class=\"el-upload__tip\" style=\"color: #F8747F;\">\r\n        温馨提示：视频上传后会在文章末尾依次展示，支持最多3个视频\r\n      </div>\r\n    </el-upload>\r\n    <monitor ref=\"monitor\" :monitor-info=\"monitorInfo\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Monitor from '@/components/Monitor'\r\n\r\nexport default {\r\n  name: 'VideoUploader',\r\n  props: {\r\n    uploadFileFunc: {\r\n      type: Function,\r\n      default: () => {}\r\n    },\r\n    videoRemove: {\r\n      type: Function,\r\n      default: () => {}\r\n    },\r\n    handleChange: {\r\n      type: Function,\r\n      default: () => {}\r\n    },\r\n    handleFileError: {\r\n      type: Function,\r\n      default: () => {}\r\n    },\r\n    uploadLoading: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    fileList: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    fileUrlList: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  components: {\r\n    Monitor\r\n  },\r\n  data() {\r\n    return {\r\n      monitorInfo: {}\r\n    }\r\n  },\r\n  methods: {\r\n    // 预览视频\r\n    previewVideo(file) {\r\n      const previewIndex = this.fileList.findIndex(\r\n        targetfile => targetfile.uid === file.uid\r\n      )\r\n      this.monitorInfo = {\r\n        type: 'video',\r\n        meta: { url: this.fileUrlList[previewIndex].url }\r\n      }\r\n      this.$refs.monitor.show()\r\n    },\r\n    videoExceed() {\r\n      this.$message.warning('最多上传三个文件')\r\n    },\r\n    handleFileSuccess() {\r\n      this.$message({ message: '上传成功', type: 'success' })\r\n    },\r\n    beforeFileUpload(file) {\r\n      const isSuccessType =\r\n        [\r\n          'video/mp4',\r\n          'video/avi',\r\n          'video/flv',\r\n          'video/wmv',\r\n          'video/mkv',\r\n          'video/mov'\r\n        ].indexOf(file.type) >= 0\r\n      if (!isSuccessType) {\r\n        this.$message.error('支持avi、flv、mp4、wmv、mkv、mov、等视频格式')\r\n      }\r\n      return isSuccessType\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoUploader.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoUploader.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VideoUploader.vue?vue&type=template&id=01527055&\"\nimport script from \"./VideoUploader.vue?vue&type=script&lang=js&\"\nexport * from \"./VideoUploader.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"batch-container\"},[_c('el-form',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.status === 'edit'),expression:\"status === 'edit'\"}],ref:\"ruleForm\",attrs:{\"label-width\":\"100px\",\"model\":_vm.ruleForm}},[_c('el-form-item',{attrs:{\"label\":\"服务类型\",\"prop\":\"serviceType\",\"rules\":[{ required: true, message: '请选择', trigger: 'change' }]}},[_c('div',{staticStyle:{\"width\":\"30%\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择发送类型\"},model:{value:(_vm.ruleForm.serviceType),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"serviceType\", $$v)},expression:\"ruleForm.serviceType\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1)]),_c('div',{staticClass:\"baby-number\"},[_c('i',{staticClass:\"iconfont icon-xuanze\"}),_vm._v(\"  已选择\"+_vm._s(_vm.babyList.length)+\"个宝宝\\n    \")]),_c('div',{staticClass:\"batch-tips\"},[_c('div',{staticClass:\"batch-tips_title\"},[_vm._v(\"温馨提示：\")]),_vm._v(\"\\n      发送成功后，所有宝宝的家长都会收到相同的内容，请注意称呼和内容措辞！\\n      请注意一位家长为多个宝宝签约了服务的情况，用户会收到多条相同的消息\\n    \")]),_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\",\"rules\":[{ required: true, message: '请填写标题', trigger: 'blur' }]}},[_c('div',{staticClass:\"input-container\"},[_c('el-input',{attrs:{\"maxlength\":\"20\",\"show-word-limit\":\"\"},model:{value:(_vm.ruleForm.title),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"title\", $$v)},expression:\"ruleForm.title\"}}),_vm._v(\"\\n          \\n        \"),(_vm.replace)?_c('svg-icon',{attrs:{\"icon-class\":\"replace\"}}):_vm._e()],1)]),_c('el-form-item',{attrs:{\"label\":\"内容详情\",\"prop\":\"content\",\"rules\":[\n        { required: true, message: '请填写内容详情', trigger: 'change' }\n      ]}},[_c('vue-editor',{attrs:{\"use-custom-image-handler\":true,\"placeholder\":\"请输入内容详情\"},on:{\"image-added\":_vm.handleImageAdded},model:{value:(_vm.ruleForm.content),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"content\", $$v)},expression:\"ruleForm.content\"}})],1),(_vm.ruleForm.delayDay)?_c('el-form-item',{attrs:{\"label\":\"延期原因\",\"prop\":\"desc\"}},[_c('el-input',{attrs:{\"placeholder\":\"请填写延期原因，用户不可见\",\"rows\":\"5\",\"maxlength\":\"100\",\"show-word-limit\":\"\",\"type\":\"textarea\"},model:{value:(_vm.ruleForm.delayReason),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"delayReason\", $$v)},expression:\"ruleForm.delayReason\"}})],1):_vm._e(),_c('el-form-item',[_c('video-uploader',{ref:\"videoUploader\",attrs:{\"handle-change\":_vm.handleChange,\"upload-file-func\":_vm.uploadFileFunc,\"video-remove\":_vm.videoRemove,\"handle-file-error\":_vm.handleFileError,\"upload-loading\":_vm.uploadLoading,\"fileList\":_vm.fileList,\"file-url-list\":_vm.ruleForm.contentVideos}})],1),_c('el-form-item',[_c('div',{staticClass:\"button-container\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.uploadLoading},on:{\"click\":_vm.handleSave}},[_vm._v(\"保存\")]),_c('el-button',{attrs:{\"disabled\":_vm.uploadLoading},on:{\"click\":_vm.preview}},[_vm._v(\"预览\")])],1)])],1),(_vm.status === 'preview')?_c('div',{staticClass:\"preview-content\"},[_c('div',{staticClass:\"success-item\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"服务类型:\")]),_c('div',{staticClass:\"content\"},[_vm._v(\"\\n        \"+_vm._s(_vm.ruleForm.serviceType === 1 ? '科普指导' : '预防提醒')+\"\\n      \")])]),_c('div',{staticClass:\"baby-number\",staticStyle:{\"margin-left\":\"-40px\"}},[_c('i',{staticClass:\"iconfont icon-xuanze\"}),_vm._v(\"  已选择\"+_vm._s(_vm.babyList.length)+\"个宝宝\\n    \")]),_c('div',[_c('send-content-preview',{attrs:{\"rule-form\":_vm.ruleForm,\"replace\":_vm.replace}})],1),_c('div',{staticClass:\"button-container\"},[_c('el-button',{on:{\"click\":_vm.returnEdit}},[_vm._v(\"返回修改\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.loadingStatus},on:{\"click\":_vm.send}},[_vm._v(\"发送\")])],1)]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"batch-container\">\r\n    <el-form\r\n      v-show=\"status === 'edit'\"\r\n      ref=\"ruleForm\"\r\n      label-width=\"100px\"\r\n      :model=\"ruleForm\"\r\n    >\r\n      <el-form-item\r\n        label=\"服务类型\"\r\n        prop=\"serviceType\"\r\n        :rules=\"[{ required: true, message: '请选择', trigger: 'change' }]\"\r\n      >\r\n        <div style=\"width: 30%\">\r\n          <el-select\r\n            v-model=\"ruleForm.serviceType\"\r\n            placeholder=\"请选择发送类型\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in options\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </div>\r\n      </el-form-item>\r\n      <div class=\"baby-number\">\r\n        <i class=\"iconfont icon-xuanze\" />&nbsp;&nbsp;已选择{{\r\n          babyList.length\r\n        }}个宝宝\r\n      </div>\r\n      <div class=\"batch-tips\">\r\n        <div class=\"batch-tips_title\">温馨提示：</div>\r\n        发送成功后，所有宝宝的家长都会收到相同的内容，请注意称呼和内容措辞！\r\n        请注意一位家长为多个宝宝签约了服务的情况，用户会收到多条相同的消息\r\n      </div>\r\n      <el-form-item\r\n        label=\"标题\"\r\n        prop=\"title\"\r\n        :rules=\"[{ required: true, message: '请填写标题', trigger: 'blur' }]\"\r\n      >\r\n        <div class=\"input-container\">\r\n          <el-input v-model=\"ruleForm.title\" maxlength=\"20\" show-word-limit />\r\n          &nbsp;&nbsp;\r\n          <svg-icon v-if=\"replace\" icon-class=\"replace\" />\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item\r\n        label=\"内容详情\"\r\n        prop=\"content\"\r\n        :rules=\"[\r\n          { required: true, message: '请填写内容详情', trigger: 'change' }\r\n        ]\"\r\n      >\r\n        <vue-editor\r\n          v-model=\"ruleForm.content\"\r\n          :use-custom-image-handler=\"true\"\r\n          placeholder=\"请输入内容详情\"\r\n          @image-added=\"handleImageAdded\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item v-if=\"ruleForm.delayDay\" label=\"延期原因\" prop=\"desc\">\r\n        <el-input\r\n          v-model=\"ruleForm.delayReason\"\r\n          placeholder=\"请填写延期原因，用户不可见\"\r\n          rows=\"5\"\r\n          maxlength=\"100\"\r\n          show-word-limit\r\n          type=\"textarea\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <video-uploader\r\n          ref=\"videoUploader\"\r\n          :handle-change=\"handleChange\"\r\n          :upload-file-func=\"uploadFileFunc\"\r\n          :video-remove=\"videoRemove\"\r\n          :handle-file-error=\"handleFileError\"\r\n          :upload-loading=\"uploadLoading\"\r\n          :fileList=\"fileList\"\r\n          :file-url-list=\"ruleForm.contentVideos\"\r\n        ></video-uploader>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <div class=\"button-container\">\r\n          <el-button\r\n            type=\"primary\"\r\n            :disabled=\"uploadLoading\"\r\n            @click=\"handleSave\"\r\n            >保存</el-button\r\n          >\r\n          <el-button :disabled=\"uploadLoading\" @click=\"preview\">预览</el-button>\r\n        </div>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div v-if=\"status === 'preview'\" class=\"preview-content\">\r\n      <div class=\"success-item\">\r\n        <div class=\"label\">服务类型:</div>\r\n        <div class=\"content\">\r\n          {{ ruleForm.serviceType === 1 ? '科普指导' : '预防提醒' }}\r\n        </div>\r\n      </div>\r\n      <div class=\"baby-number\" style=\"margin-left: -40px\">\r\n        <i class=\"iconfont icon-xuanze\" />&nbsp;&nbsp;已选择{{\r\n          babyList.length\r\n        }}个宝宝\r\n      </div>\r\n      <div>\r\n        <send-content-preview\r\n          :rule-form=\"ruleForm\"\r\n          :replace=\"replace\"\r\n        ></send-content-preview>\r\n      </div>\r\n      <div class=\"button-container\">\r\n        <el-button @click=\"returnEdit\">返回修改</el-button>\r\n        <el-button type=\"primary\" :loading=\"loadingStatus\" @click=\"send\"\r\n          >发送</el-button\r\n        >\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { VueEditor } from 'vue2-editor'\r\nimport { upload } from '@/api/upload'\r\nimport VideoUploader from './components/common/VideoUploader'\r\nimport SendContentPreview from './components/SendContentPreview'\r\nimport {\r\n  createBatchTask,\r\n  sendTask,\r\n  getTaskContent\r\n} from '@/api/healthManagement'\r\nimport { getSimpleText } from '@/utils/healthManagement'\r\n\r\nexport default {\r\n  name: 'BatchSend',\r\n  components: {\r\n    VueEditor,\r\n    VideoUploader,\r\n    SendContentPreview\r\n  },\r\n  data() {\r\n    return {\r\n      taskId: '',\r\n      serviceType: '',\r\n      loadingStatus: false,\r\n      replace: false,\r\n      uploadLoading: false,\r\n      monitorInfo: {},\r\n      fileList: [],\r\n      isSaved: false,\r\n      createdTaskId: '',\r\n      status: 'edit',\r\n      ruleForm: {\r\n        serviceType: null,\r\n        title: '',\r\n        content: '',\r\n        contentPic: '',\r\n        contentTxt: '',\r\n        contentVideos: []\r\n      },\r\n      options: [\r\n        {\r\n          value: 1,\r\n          label: '科普指导'\r\n        },\r\n        {\r\n          value: 2,\r\n          label: '预防提醒'\r\n        }\r\n      ],\r\n      babyList: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.babyList = this.$route.query.babyList.split(',')\r\n    this.replace = this.$route.query.isReplace\r\n    this.serviceType = this.$route.query.serviceType\r\n    this.createdTaskId = this.$route.query.taskId\r\n    // 如果是已保存的任务，路由参数中有任务的id\r\n    if (this.$route.query.serviceType) {\r\n      this.getTaskContent()\r\n    }\r\n  },\r\n  methods: {\r\n    // 上传视频\r\n    videoRemove(file, fileList) {\r\n      const removeIndex = this.fileList.findIndex(\r\n        targetfile => targetfile.uid === file.uid\r\n      )\r\n      this.ruleForm.contentVideos.splice(removeIndex, 1)\r\n    },\r\n    handleChange(file, fileList) {\r\n      this.fileList = fileList\r\n    },\r\n    async uploadFileFunc(option) {\r\n      this.uploadLoading = true\r\n      const file = option.file\r\n      const { url } = await upload(file, progress => {})\r\n      const name = file.name\r\n      const videoObj = {\r\n        url,\r\n        name\r\n      }\r\n      this.ruleForm.contentVideos.push(videoObj)\r\n      this.uploadLoading = false\r\n    },\r\n    handleFileError() {\r\n      this.uploadLoading = false\r\n    },\r\n    // 获取已保存的任务详情\r\n    getTaskContent() {\r\n      getTaskContent(this.createdTaskId, { type: 1 }).then(res => {\r\n        if (res.code === 20000) {\r\n          const { title, content, contentVideos, is_replace } = res.data\r\n          this.ruleForm = {\r\n            serviceType: this.serviceType,\r\n            title,\r\n            content,\r\n            contentVideos\r\n          }\r\n          // 已保存任务的代班情况\r\n          this.replace = is_replace\r\n          // 回显视频详情\r\n          this.fileList = contentVideos\r\n        }\r\n      })\r\n    },\r\n    // 发送任务\r\n    send() {\r\n      this.loadingStatus = true\r\n      sendTask(this.createdTaskId, { type: 1 }).then(res => {\r\n        if (res.code === 20000) {\r\n          this.$message.success('发送成功')\r\n          this.loadingStatus = false\r\n          setTimeout(() => {\r\n            this.$router.push({\r\n              path: '/medical-service/batch-detail',\r\n              query: {\r\n                babyNum: this.babyList.length,\r\n                taskId: this.createdTaskId\r\n              }\r\n            })\r\n          }, 2000)\r\n        }\r\n      })\r\n    },\r\n    // 保存图文消息\r\n    saveTask() {\r\n      const { title, content, serviceType } = this.ruleForm\r\n      const data = {\r\n        title,\r\n        content,\r\n        serviceType,\r\n        babyList: this.babyList,\r\n        contentPic: this.ruleForm.contentPic,\r\n        contentTxt: this.getSimpleText(this.ruleForm.content),\r\n        contentVideos: this.ruleForm.contentVideos,\r\n        bus_user: this.$route.query.hm\r\n      }\r\n      const params = {\r\n        taskId: this.createdTaskId\r\n      }\r\n      return createBatchTask(params, data)\r\n    },\r\n    // 点击保存按钮\r\n    handleSave() {\r\n      this.$refs.ruleForm.validate(valid => {\r\n        if (valid) {\r\n          this.saveTask().then(res => {\r\n            if (res.code === 20000) {\r\n              this.$message.success('保存成功')\r\n              this.isSaved = true\r\n              this.createdTaskId = res.data._id\r\n            }\r\n          })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 预览\r\n    preview() {\r\n      this.$refs.ruleForm.validate(valid => {\r\n        if (valid) {\r\n          if (!this.isSaved) {\r\n            this.saveTask().then(res => {\r\n              if (res.code === 20000) {\r\n                this.status = 'preview'\r\n                this.createdTaskId = res.data._id\r\n              }\r\n            })\r\n          } else {\r\n            this.status = 'preview'\r\n          }\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 从富文本中提取文本文字\r\n    getSimpleText,\r\n    // 图文编辑器上传图片\r\n    async handleImageAdded(file, Editor, cursorLocation) {\r\n      // 上传图片操作\r\n      const data = await upload(file, progress => {})\r\n      // 把获取到的图片url 插入到鼠标所在位置 回显图片\r\n      Editor.insertEmbed(cursorLocation, 'image', encodeURI(data.url))\r\n      // 给后台发送封面图\r\n      if (!this.ruleForm.contentPic) {\r\n        this.ruleForm.contentPic = encodeURI(data.url)\r\n      }\r\n    },\r\n    // 返回修改\r\n    returnEdit() {\r\n      this.status = 'edit'\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.batch-container {\r\n  padding: 50px 500px 50px 50px;\r\n  font-size: 16px;\r\n  color: #17233d;\r\n  border: 1px solid #ebeef5;\r\n  .baby-number {\r\n    margin-left: -30px;\r\n    padding: 20px 100px 20px 100px;\r\n    font-weight: bold;\r\n    color: #2d8cf0;\r\n  }\r\n  .batch-tips {\r\n    position: relative;\r\n    padding: 10px 460px 20px 100px;\r\n    line-height: 20px;\r\n    color: #f88690;\r\n    &_title {\r\n      position: absolute;\r\n      left: 30px;\r\n      font-weight: bolder;\r\n    }\r\n  }\r\n  .button-container {\r\n    padding-top: 100px;\r\n    padding-right: 50px;\r\n    text-align: right;\r\n  }\r\n  .preview-content {\r\n    position: relative;\r\n    overflow: auto;\r\n    margin: 0 auto;\r\n    padding-bottom: 70px;\r\n    width: 640px;\r\n    min-height: 943px;\r\n    background-color: #fcfcfc;\r\n    border: 1px solid #ebeef5;\r\n    .button-container {\r\n      position: absolute;\r\n      bottom: 15px;\r\n      width: 100%;\r\n      text-align: center;\r\n    }\r\n    .success-item {\r\n      display: flex;\r\n      margin-top: 50px;\r\n      font-size: 16px;\r\n      color: #17233d;\r\n      .label {\r\n        margin-right: 30px;\r\n        font-weight: bold;\r\n        text-align: right;\r\n        flex: 2;\r\n      }\r\n      .content {\r\n        padding-right: 30px;\r\n        flex: 7;\r\n      }\r\n      .rich-text {\r\n        width: 60%;\r\n        line-height: 30px;\r\n        word-wrap: break-word;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.input-container {\r\n  .el-input {\r\n    width: 50%;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./batchSend.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./batchSend.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./batchSend.vue?vue&type=template&id=cbfe7fcc&scoped=true&\"\nimport script from \"./batchSend.vue?vue&type=script&lang=js&\"\nexport * from \"./batchSend.vue?vue&type=script&lang=js&\"\nimport style0 from \"./batchSend.vue?vue&type=style&index=0&id=cbfe7fcc&scoped=true&lang=scss&\"\nimport style1 from \"./batchSend.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cbfe7fcc\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"preview\"},[_c('div',{staticClass:\"preview__title\"},[_vm._v(\"\\n      \"+_vm._s(_vm.ruleForm.title)+\"  \\n      \"),(_vm.replace)?_c('svg-icon',{attrs:{\"icon-class\":\"replace\"}}):_vm._e()],1),_c('div',{staticClass:\"preview__content rich-text rich-text__image--max380\",domProps:{\"innerHTML\":_vm._s(_vm.ruleForm.content)}})]),(_vm.ruleForm.contentVideos && _vm.ruleForm.contentVideos.length > 0)?_c('div',_vm._l((_vm.ruleForm.contentVideos),function(ref){\nvar url = ref.url;\nreturn _c('div',{key:url,staticStyle:{\"text-align\":\"center\"}},[_c('video-item',{attrs:{\"url\":url}})],1)}),0):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"preview\">\r\n      <div class=\"preview__title\">\r\n        {{ ruleForm.title }}&nbsp;&nbsp;\r\n        <svg-icon v-if=\"replace\" icon-class=\"replace\" />\r\n      </div>\r\n      <div\r\n        class=\"preview__content rich-text rich-text__image--max380\"\r\n        v-html=\"ruleForm.content\"\r\n      />\r\n    </div>\r\n    <div v-if=\"ruleForm.contentVideos && ruleForm.contentVideos.length > 0\">\r\n      <div\r\n        v-for=\"{ url } in ruleForm.contentVideos\"\r\n        :key=\"url\"\r\n        style=\"text-align: center\"\r\n      >\r\n        <video-item :url=\"url\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport VideoItem from './common/VideoItem'\r\n\r\nexport default {\r\n  name: 'SendContentPreview',\r\n  components: {\r\n    VideoItem\r\n  },\r\n  props: {\r\n    ruleForm: {\r\n      type: Object,\r\n      default: () => {}\r\n    },\r\n    replace: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.preview {\r\n  padding: 10px 60px;\r\n  line-height: 22px;\r\n  font-size: 16px;\r\n  &__title {\r\n    font-size: 18px;\r\n    font-weight: bold;\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SendContentPreview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SendContentPreview.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SendContentPreview.vue?vue&type=template&id=38b1573a&scoped=true&\"\nimport script from \"./SendContentPreview.vue?vue&type=script&lang=js&\"\nexport * from \"./SendContentPreview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SendContentPreview.vue?vue&type=style&index=0&id=38b1573a&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"38b1573a\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\r\nexport const oss = () => {\r\n  return request({\r\n    url: '/oss/auth',\r\n    method: 'get'\r\n  })\r\n}\r\n\r\nexport const getImageMeta = url => {\r\n  return request({\r\n    url: url + '?x-oss-process=image/info',\r\n    method: 'get'\r\n  })\r\n}\r\nexport const postObject = async ({ oss: ossData, key, file, onProgress }) => {\r\n  const data = new FormData()\r\n  data.append('OSSAccessKeyId', ossData.OSSAccessKeyId)\r\n  data.append('success_action_status', 200)\r\n  data.append('policy', ossData.policy)\r\n  data.append('Signature', ossData.Signature)\r\n  data.append('key', key)\r\n  data.append('file', file)\r\n  let url = 'https://pic1.baobaohehu.com/'\r\n  await request({\r\n    url,\r\n    method: 'post',\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    },\r\n    onUploadProgress: onProgress || null,\r\n    data\r\n  })\r\n  url = url + key\r\n  let meta\r\n  if (file.type.indexOf('image') > -1) {\r\n    meta = await getImageMeta(url)\r\n  } else if (file.type.indexOf('video') > -1) {\r\n    meta = {\r\n      ...file.videoMeta,\r\n      size: file.size\r\n    }\r\n  } else if (file.type.indexOf('audio') > -1) {\r\n    meta = {\r\n      size: file.size,\r\n      type: file.type\r\n    }\r\n  } else {\r\n    throw new Error(\r\n      '当前上传的类型不是image或者video；当前上传的类型是' + file.type\r\n    )\r\n  }\r\n  return {\r\n    url,\r\n    meta: meta\r\n  }\r\n}\r\n// 获取文件后缀名\r\nexport const extname = filename => {\r\n  if (!filename || typeof filename !== 'string') {\r\n    return false\r\n  }\r\n  const a = filename\r\n    .split('')\r\n    .reverse()\r\n    .join('')\r\n  const b = a\r\n    .substring(0, a.search(/\\./))\r\n    .split('')\r\n    .reverse()\r\n    .join('')\r\n  return b\r\n}\r\n/**\r\n * 封装下oss获取跟上传\r\n * @param file\r\n * @param onProgress\r\n * @returns {Promise.<*>}\r\n */\r\nexport const upload = async (file, onProgress) => {\r\n  const { data } = await oss()\r\n  const random = Math.floor(Math.random() * (100 - 1)) + 1\r\n  let fileName = new Date().getTime()\r\n  const fileType = extname(file.name)\r\n  fileName = fileName + random + '.' + fileType\r\n  const key = `${data.path}/${data.prefix}/${fileName}`\r\n  const res = await postObject({ oss: data, key, file, onProgress })\r\n  return res\r\n}\r\n","import $router from '@/router'\r\nexport const gotoNewPage = function(path) {\r\n  $router.push(`prevention/${path}`)\r\n}\r\n\r\nexport const vaccineType = function(row) {\r\n  switch (row.vaccine_type) {\r\n    case 1:\r\n      return '减毒'\r\n    case 2:\r\n      return '灭活'\r\n    case 3:\r\n      return '多糖'\r\n  }\r\n}\r\n\r\nexport const vaccineClass = function(row) {\r\n  switch (row.vaccine_class) {\r\n    case 1:\r\n      return '一类'\r\n    case 2:\r\n      return '二类'\r\n  }\r\n}\r\n\r\nexport const getSimpleText = function(html) {\r\n  const re1 = new RegExp('<.+?>', 'g') // 匹配html标签的正则表达式，\"g\"是搜索匹配多个符合的内容\r\n  const msg = html.replace(re1, '') // 执行替换成空字符\r\n  if (msg.length > 38) {\r\n    return msg.slice(0, 38) + '...'\r\n  }\r\n  return msg\r\n}\r\n\r\nexport const statusOptions = [\r\n  {\r\n    value: 0,\r\n    label: '待发送'\r\n  },\r\n  {\r\n    value: 2,\r\n    label: '已保存'\r\n  },\r\n  {\r\n    value: 3,\r\n    label: '已发送'\r\n  },\r\n  {\r\n    value: 1,\r\n    label: '留言待回复'\r\n  },\r\n  {\r\n    value: 4,\r\n    label: '已完成'\r\n  },\r\n  {\r\n    value: 5,\r\n    label: '已取消'\r\n  },\r\n  {\r\n    value: 6,\r\n    label: '已关闭'\r\n  },\r\n  {\r\n    value: 100,\r\n    label: '延期'\r\n  }\r\n]\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"video-container\"},[_c('img',{attrs:{\"src\":_vm.url + '?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg',\"width\":\"480\"}}),_c('div',{staticClass:\"video-container__play-icon\",on:{\"click\":function($event){return _vm.showMediaDetail(_vm.url)}}},[_c('div',{staticClass:\"el-icon-video-play\"})]),_c('monitor',{ref:\"monitor\",attrs:{\"monitor-info\":_vm.monitorInfo}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"video-container\">\r\n      <img\r\n        :src=\"url + '?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg'\"\r\n        width=\"480\"\r\n      />\r\n      <div class=\"video-container__play-icon\" @click=\"showMediaDetail(url)\">\r\n        <div class=\"el-icon-video-play\" />\r\n      </div>\r\n      <monitor ref=\"monitor\" :monitor-info=\"monitorInfo\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Monitor from '@/components/Monitor'\r\n\r\nexport default {\r\n  name: 'VideoItem',\r\n  components: {\r\n    Monitor\r\n  },\r\n  props: {\r\n    url: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      monitorInfo: {}\r\n    }\r\n  },\r\n  methods: {\r\n    showMediaDetail(url) {\r\n      this.monitorInfo = {\r\n        type: 'video',\r\n        meta: { url }\r\n      }\r\n      this.$refs.monitor.show()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.video-container {\r\n  position: relative;\r\n  margin: 0 auto 20px;\r\n  width: 480px;\r\n  text-align: center;\r\n  cursor: pointer;\r\n  &__play-icon {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    background: rgba(0, 0, 0, 0.3);\r\n    cursor: pointer;\r\n    div {\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      font-size: 35px;\r\n      color: #fff;\r\n      transform: translate(-50%, -50%);\r\n      &:hover {\r\n        color: #2d8cf0;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VideoItem.vue?vue&type=template&id=df4e0e06&scoped=true&\"\nimport script from \"./VideoItem.vue?vue&type=script&lang=js&\"\nexport * from \"./VideoItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./VideoItem.vue?vue&type=style&index=0&id=df4e0e06&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"df4e0e06\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SendContentPreview.vue?vue&type=style&index=0&id=38b1573a&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SendContentPreview.vue?vue&type=style&index=0&id=38b1573a&scoped=true&lang=scss&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./batchSend.vue?vue&type=style&index=0&id=cbfe7fcc&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./batchSend.vue?vue&type=style&index=0&id=cbfe7fcc&scoped=true&lang=scss&\""],"sourceRoot":""}