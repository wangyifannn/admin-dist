(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03ef0716"],{"045c":function(e,t,a){"use strict";var n=a("7e83"),r=a.n(n);r.a},1275:function(e,t,a){},"1ea9":function(e,t,a){"use strict";var n=a("7ce0"),r=a.n(n);r.a},"21b4":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fd-team-add"},[a("h1",{staticClass:"margin-left-20 color-576277"},[e._v(e._s(e.pageTitle))]),a("div",{staticClass:"team-form"},[a("el-form",{ref:"team-info",attrs:{model:e.teamInfo,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"团队名称",prop:"name",rules:[{required:!0,message:"请填写团队名称",trigger:"blur"}]}},[a("el-input",{attrs:{size:"small",maxlength:"10","show-word-limit":"",placeholder:"请输入团队名称",disabled:"编辑"===e.pageAction},model:{value:e.teamInfo.name,callback:function(t){e.$set(e.teamInfo,"name",t)},expression:"teamInfo.name"}})],1),"共享团队"===e.pageRole?a("el-form-item",{attrs:{label:"团队类型",prop:"category",rules:[{required:!0,message:"请选择团队类型",trigger:"change"}]}},[a("el-select",{attrs:{disabled:"编辑"===e.pageAction,placeholder:"请选择团队类型",size:"small",filterable:"",clearable:""},model:{value:e.teamInfo.category,callback:function(t){e.$set(e.teamInfo,"category",t)},expression:"teamInfo.category"}},e._l(e.$store.state.dictionary.teamCategories,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"共享团队"===e.pageRole&&e.teamInfo.category?a("el-form-item",{attrs:{label:"团队成员",prop:"members",rules:[{required:!0,message:"请选择团队成员",trigger:"blur"}]}},[a("el-select",{attrs:{placeholder:"请选择团队成员",size:"small",multiple:"",filterable:"",clearable:""},model:{value:e.teamInfo.members,callback:function(t){e.$set(e.teamInfo,"members",t)},expression:"teamInfo.members"}},e._l(e.commonTeamMembers,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"儿科基础团队"===e.pageRole||"产科基础团队"===e.pageRole?a("el-form-item",{attrs:{label:"医生科室",rules:[{required:!0,message:"请填写",trigger:"blur"}]}},[a("el-input",{attrs:{disabled:"",value:"儿科基础团队"===e.pageRole?"儿科":"产科"}})],1):e._e(),"儿科基础团队"===e.pageRole?a("DoctorsSelect",{attrs:{label:"医生",selectDisable:"编辑"===e.pageAction,prop:"doctor",rules:[{required:!0,message:"请选择医生",trigger:"change"}]},model:{value:e.teamInfo.doctor,callback:function(t){e.$set(e.teamInfo,"doctor",t)},expression:"teamInfo.doctor"}}):e._e(),"产科基础团队"===e.pageRole?a("ChankeDoctorSelect",{attrs:{label:"医生",selectDisable:"编辑"===e.pageAction,prop:"doctor",rules:[{required:!0,message:"请选择医生",trigger:"change"}]},model:{value:e.teamInfo.doctor,callback:function(t){e.$set(e.teamInfo,"doctor",t)},expression:"teamInfo.doctor"}}):e._e(),"儿科基础团队"===e.pageRole?a("HmSelect",{ref:"hmSelect",attrs:{label:"健康管理师",placeholder:"请选择健康管理师",prop:"healthManagers"},model:{value:e.teamInfo.healthManagers,callback:function(t){e.$set(e.teamInfo,"healthManagers",t)},expression:"teamInfo.healthManagers"}}):e._e(),a("el-form-item",{attrs:{label:"团队简介",prop:"desc",rules:[{required:!0,message:"请输入简介",trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",placeholder:"请填写团队简介，填写完成的信息将在小程序展示，请慎重填写！"},model:{value:e.teamInfo.desc,callback:function(t){e.$set(e.teamInfo,"desc",t)},expression:"teamInfo.desc"}})],1),a("el-form-item",{attrs:{prop:"skill",label:"团队擅长",rules:[{required:!0,message:"请输入成员擅长",trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",placeholder:"请填写团队擅长，填写完成的信息将在小程序展示，请慎重填写！"},model:{value:e.teamInfo.skill,callback:function(t){e.$set(e.teamInfo,"skill",t)},expression:"teamInfo.skill"}})],1),a("el-form-item",{attrs:{label:"团队图片",prop:"imageUrl",rules:[{required:!0,message:"请上传团队图片",trigger:"change"}]}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"http-request":e.uploadFunc,"before-upload":e.beforeAvatarUpload}},[e.teamInfo.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.teamInfo.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),a("div",{staticClass:"el-upload__tip tips",attrs:{slot:"tip"},slot:"tip"},[e._v("\n            图片格式支持：BMP、JPEG、JPG、PNG，大小不超过2M\n            上传的图片将在小程序展示，请慎重上传！\n            为保证小程序端的美观，请上传654 * 368px或等比例图片\n          ")])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("team-info")}}},[e._v("确认"+e._s(this.formActionText))])],1)],1)],1),a("el-dialog",{attrs:{title:e.pageRole+"信息确认",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"confirm"},[a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("团队名称：")]),a("div",{staticClass:"confirm__item--content"},[e._v(e._s(e.teamInfo.name))])]),"共享团队"===e.pageRole?a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("团队类型：")]),a("div",{staticClass:"confirm__item--content"},[e._v("\n          "+e._s(e._f("teamCategory")(e.teamInfo.category))+"\n        ")])]):e._e(),"共享团队"===e.pageRole?a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("团队成员：")]),a("div",{staticClass:"confirm__item--content"},[e._v(e._s(e.membersNameList()))])]):e._e(),"儿科基础团队"===e.pageRole?a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("健康管理师：")]),a("div",{staticClass:"confirm__item--content"},[e._v(e._s(e.hmNameList()))])]):e._e(),a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("团队简介：")]),a("div",{staticClass:"confirm__item--content"},[e._v(e._s(e.teamInfo.desc))])]),a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("团队擅长：")]),a("div",{staticClass:"confirm__item--content"},[e._v(e._s(e.teamInfo.skill))])]),a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[e._v("团队图片：")]),a("div",{staticClass:"confirm__item--content"},[a("el-avatar",{attrs:{size:"large",shape:"square",src:e.teamInfo.imageUrl}})],1)]),"编辑"===e.pageAction?a("div",{staticClass:"confirm__item"},[a("div",{staticClass:"confirm__item--label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("修改原因：\n        ")]),a("div",{staticClass:"confirm__item--content"},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.editReason,callback:function(t){e.editReason=t},expression:"editReason"}})],1)]):e._e(),a("div",{staticClass:"tips margin-left-20"},[e._v("\n        提交的部分信息将展示在小程序并影响业务，请确保信息的准确性!\n      ")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("返回修改")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmForm}},[e._v("确认"+e._s(this.formActionText))])],1)])])],1)},r=[],i=(a("96cf"),a("3b8d")),o=(a("6762"),a("2fdb"),a("7f7f"),a("23ba")),s=a("bb80"),l=a("8975"),c=a("91b6"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group-select"},[a("el-form-item",{attrs:{label:e.label,prop:e.prop,rules:e.rules}},[a("el-select",{attrs:{value:e.value,placeholder:e.placeholder,disabled:e.selectDisable,clearable:""},on:{change:e.onValueChange}},e._l(e.options,(function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label}},[e._v(e._s(t.label))])})),1)],1)],1)},m=[],f={data:function(){return{optionValue:"",options:[]}},props:{selectDisable:{type:Boolean,default:!1},value:{type:String,default:""},moduleName:{type:String,default:"医生"},label:{type:String,default:"医生"},prop:{type:String,default:""},rules:{type:Array,default:function(){return[]}},filterOption:{type:String,default:""},placeholder:{type:String,default:"请选择"}},watch:{value:function(e){this.optionValue=e}},created:function(){this.getDoctors()},methods:{getDoctors:function(){var e=this,t={bus_role:"doctor",department:"pediatric"};Object(s["h"])(t).then((function(t){var a=t.data.list;e.options=a.map((function(e){return{value:e._id,label:e.name}}))}))},onValueChange:function(e){this.$emit("input",e)}}},p=f,d=(a("1ea9"),a("2877")),g=Object(d["a"])(p,u,m,!1,null,null,null),h=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group-select"},[a("el-form-item",{attrs:{label:e.label,prop:e.prop,rules:e.rules}},[a("el-select",{attrs:{value:e.value,placeholder:e.placeholder,disabled:e.selectDisable,clearable:""},on:{change:e.onValueChange}},e._l(e.options,(function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label}},[e._v(e._s(t.label))])})),1)],1)],1)},v=[],_={data:function(){return{optionValue:"",options:[]}},props:{selectDisable:{type:Boolean,default:!1},value:{type:String,default:""},moduleName:{type:String,default:"医生"},label:{type:String,default:"医生"},prop:{type:String,default:""},rules:{type:Array,default:function(){return[]}},filterOption:{type:String,default:""},placeholder:{type:String,default:"请选择"}},watch:{value:function(e){this.optionValue=e}},created:function(){this.getDoctors()},methods:{getDoctors:function(){var e=this,t={bus_role:"doctor",department:"obstetrics"};Object(s["h"])(t).then((function(t){var a=t.data.list;e.options=a.map((function(e){return{value:e._id,label:e.name}}))}))},onValueChange:function(e){this.$emit("input",e)}}},y=_,I=(a("c948"),Object(d["a"])(y,b,v,!1,null,null,null)),C=I.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group-select"},[a("el-form-item",{attrs:{label:e.label,prop:e.prop,rules:e.rules}},[a("el-select",{attrs:{value:e.value,placeholder:e.placeholder,disabled:e.selectDisable,multiple:"",clearable:""},on:{change:e.onValueChange}},e._l(e.options,(function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label}},[e._v(e._s(t.label))])})),1)],1)],1)},k=[],O={data:function(){return{optionValue:"",options:[]}},props:{selectDisable:{type:Boolean,default:!1},value:{type:Array,default:function(){return[]}},moduleName:{type:String,default:"健康管理师"},label:{type:String,default:"健康管理师"},prop:{type:String,default:""},rules:{type:Array,default:function(){return[]}},filterOption:{type:String,default:""},placeholder:{type:String,default:"请选择"}},watch:{value:function(e){this.optionValue=e}},created:function(){this.getDoctors()},methods:{getDoctors:function(){var e=this,t={bus_role:"hm"};Object(s["h"])(t).then((function(t){var a=t.data.list;e.options=a.map((function(e){return{value:e._id,label:e.name}}))}))},onValueChange:function(e){this.$emit("input",e)}}},R=O,S=(a("44e0"),Object(d["a"])(R,x,k,!1,null,null,null)),$=S.exports,j={components:{DoctorsSelect:h,ChankeDoctorSelect:C,HmSelect:$},data:function(){return{commonTeamMembers:[],allHms:[],editReason:"",dialogVisible:!1,teamInfo:{name:"",healthManagers:[],imageUrl:"",department:"",category:"",members:[],desc:"",skill:"",doctor:""}}},computed:{pageTitle:function(){return this.pageAction+this.pageRole},pageRole:function(){return Object(l["fdTeamType"])(this.$route.params.type)},pageAction:function(){return this.$route.params.id?"编辑":"新增"},formActionText:function(){return this.$route.params.id?"修改":"新增"},teamCategory:function(){return this.teamInfo.category}},watch:{teamCategory:function(e){var t,a=this;this.teamInfo.members=[],"DIETICIAN"===e?t={bus_role:"dietician"}:"NEIFENMI"===e&&(t={bus_role:"doctor",department:"endocrine"}),Object(s["h"])(t).then((function(e){var t=e.data.list;a.commonTeamMembers=t.map((function(e){return{value:e._id,label:e.name}}))}))}},created:function(){"编辑"===this.pageAction&&this.getEditInfoById()},methods:{membersNameList:function(){var e=this,t=this.commonTeamMembers.filter((function(t){if(e.teamInfo.members.includes(t.value))return t})),a=t.map((function(e){return e.label}));return a.join(",")},hmNameList:function(){var e=this;if(this.$refs.hmSelect){var t=this.$refs.hmSelect.options,a=t.filter((function(t){if(e.teamInfo.healthManagers.includes(t.value))return t})),n=a.map((function(e){return e.label}));return n.join(",")}return""},handleAvatarSuccess:function(e,t){this.uploading=!1,this.$message({message:"上传成功",type:"success"})},uploadFunc:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])(t.file,(function(e){}));case 2:a=e.sent,this.teamInfo.imageUrl=a.url;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),beforeAvatarUpload:function(e){this.uploading=!0;var t=["image/png","image/jpeg","image/jpg","image/bmp"].indexOf(e.type)>=0,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},submitForm:function(e){var t=this;this.$refs[e].validate((function(e,a){if(!e)return a.imageUrl&&t.$message.error(a.imageUrl[0].message),!1;t.dialogVisible=!0}))},confirmForm:function(){var e=this;if("新增"===this.pageAction){var t={type:this.$route.params.type,name:this.teamInfo.name,avatar:this.teamInfo.imageUrl,description:this.teamInfo.desc,expert:this.teamInfo.skill};"共享团队"===this.pageRole?(t.category=this.teamInfo.category,t.common_members=this.teamInfo.members):"儿科基础团队"===this.pageRole?(t.doctor=this.teamInfo.doctor,t.hms=this.teamInfo.healthManagers):"产科基础团队"===this.pageRole&&(t.doctor=this.teamInfo.doctor),Object(o["a"])(t).then((function(t){e.$message.success("新增成功"),e.dialogVisible=!1,e.$router.push({name:"FDTeamList",params:{type:e.$route.params.type}})}))}else if("编辑"===this.pageAction){if(!this.editReason)return void this.$message.warning("请填写修改原因");var a={avatar:this.teamInfo.imageUrl,description:this.teamInfo.desc,expert:this.teamInfo.skill,update_remark:this.editReason};"共享团队"===this.pageRole?a.common_members=this.teamInfo.members:"儿科基础团队"===this.pageRole&&(a.hms=this.teamInfo.healthManagers),Object(o["e"])(this.$route.params.id,a).then((function(t){e.$message.success("信息更新成功"),e.dialogVisible=!1,e.$router.push({name:"FDTeamList",params:{type:e.$route.params.type}})}))}},getEditInfoById:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(o["c"])(this.$route.params.id).then((function(e){var a=Object.assign({},e.data);t.teamInfo.name=a.name,t.teamInfo.desc=a.description,t.teamInfo.skill=a.expert,t.teamInfo.imageUrl=a.avatar,"共享团队"===t.pageRole?(t.teamInfo.category=a.category,setTimeout((function(){t.teamInfo.members=a.common_members.map((function(e){return e._id}))}),500)):"儿科基础团队"===t.pageRole?(t.teamInfo.doctor=a.doctor.name,t.teamInfo.healthManagers=a.hms.map((function(e){return e._id}))):"产科基础团队"===t.pageRole&&(t.teamInfo.doctor=a.doctor.name)}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},w=j,A=(a("045c"),a("6d5f2"),a("4ae5"),Object(d["a"])(w,n,r,!1,null,"e3e47ba8",null));t["default"]=A.exports},"23ba":function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return l}));var n=a("b775");function r(e){return Object(n["a"])({url:"/fd/corps",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/fd/corps",method:"post",data:e})}function o(e,t){return Object(n["a"])({url:"/fd/corps/".concat(e,"/status"),method:"put",data:t})}function s(e,t){return Object(n["a"])({url:"/fd/corps/".concat(e),method:"put",data:t})}function l(e){return Object(n["a"])({url:"/fd/corps/".concat(e),method:"get"})}},"44e0":function(e,t,a){"use strict";var n=a("1275"),r=a.n(n);r.a},"4ae5":function(e,t,a){"use strict";var n=a("d7d3"),r=a.n(n);r.a},"6d5f2":function(e,t,a){"use strict";var n=a("dcae"),r=a.n(n);r.a},"7ce0":function(e,t,a){},"7d67":function(e,t,a){},"7e83":function(e,t,a){},"91b6":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return u}));a("7f7f"),a("386d"),a("28a5");var n=a("db72"),r=(a("96cf"),a("3b8d")),i=a("b775"),o=function(){return Object(i["a"])({url:"/oss/auth",method:"get"})},s=function(e){return Object(i["a"])({url:e+"?x-oss-process=image/info",method:"get"})},l=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,o,l,c,u,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.oss,r=t.key,o=t.file,l=t.onProgress,c=new FormData,c.append("OSSAccessKeyId",a.OSSAccessKeyId),c.append("success_action_status",200),c.append("policy",a.policy),c.append("Signature",a.Signature),c.append("key",r),c.append("file",o),u="https://pic1.baobaohehu.com/",e.next=11,Object(i["a"])({url:u,method:"post",headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l||null,data:c});case 11:if(u+=r,!(o.type.indexOf("image")>-1)){e.next=18;break}return e.next=15,s(u);case 15:m=e.sent,e.next=27;break;case 18:if(!(o.type.indexOf("video")>-1)){e.next=22;break}m=Object(n["a"])({},o.videoMeta,{size:o.size}),e.next=27;break;case 22:if(!(o.type.indexOf("audio")>-1)){e.next=26;break}m={size:o.size,type:o.type},e.next=27;break;case 26:throw new Error("当前上传的类型不是image或者video；当前上传的类型是"+o.type);case 27:return e.abrupt("return",{url:u,meta:m});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(e){if(!e||"string"!==typeof e)return!1;var t=e.split("").reverse().join(""),a=t.substring(0,t.search(/\./)).split("").reverse().join("");return a},u=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var n,r,i,s,u,m,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:return n=e.sent,r=n.data,i=Math.floor(99*Math.random())+1,s=(new Date).getTime(),u=c(t.name),s=s+i+"."+u,m="".concat(r.path,"/").concat(r.prefix,"/").concat(s),e.next=11,l({oss:r,key:m,file:t,onProgress:a});case 11:return f=e.sent,e.abrupt("return",f);case 13:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},c948:function(e,t,a){"use strict";var n=a("7d67"),r=a.n(n);r.a},d7d3:function(e,t,a){},dcae:function(e,t,a){}}]);
//# sourceMappingURL=chunk-03ef0716.c972beac.js.map