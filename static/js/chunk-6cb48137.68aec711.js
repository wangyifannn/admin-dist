(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cb48137"],{"1fc9":function(e,t,o){},"2e86":function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("MyTable",{attrs:{size:"mini",stripe:!1,border:!0,multiple:!1,outlineBorder:!1,operation:e.operation,column:e.column,data:e.tableData,currentPage:e.currentPage,pageSize:e.pageSize,total:e.total},on:{followCustomer:e.followCustomer,detail:e.detail,customerTableSwitchChange:e.handleStatusColClick,handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange},scopedSlots:e._u([{key:"isRelative",fn:function(t){return[t.row.isRelative?o("div",[o("div",[e._v("是")]),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.clearRelative(t.row)}}},[e._v("\n          解除关联\n        ")])],1):o("div",[o("div",[e._v("否")]),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.goToRelative(t.row)}}},[e._v("\n          关联客户\n        ")])],1)]}},{key:"supervisor",fn:function(t){return[o("div",[o("div",[e._v("\n          "+e._s(t.row.supervisor&&t.row.supervisor.name?t.row.supervisor.name:"-")+"\n        ")]),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.changeCharge(t.row)}}},[e._v("更换负责人\n        ")])],1)]}}])}),o("follow-customer-dialog",{attrs:{"customer-id":e.currentCustomerId,followDialogVisible:e.followDialogVisible},on:{closeDialog:function(t){e.followDialogVisible=!1},followSuccess:e.getCustomerList}}),o("RelativeDialog",{attrs:{"customer-id":e.currentCustomerId,relativeDialogVisible:e.relativeDialogVisible},on:{cancelRelativeSuccess:e.getCustomerList,closeDialog:function(t){e.relativeDialogVisible=!1}}})],1)},a=[],i=(o("ac6a"),o("7f7f"),o("116c")),s=o("b5b3"),n=o("3acd"),l=o("d95e"),c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"确认解除关联信息提示",visible:e.relativeDialogVisible,width:"45%","before-close":e.handleClose,center:!1},on:{"update:visible":function(t){e.relativeDialogVisible=t}}},[o("div",{staticClass:"margin-bottom-30"},[o("CustomerBasicInfo",{attrs:{"customer-id":e.customerId,"ellipsis-length":12}})],1),o("div",{staticClass:"relative"},[e._v("\n    确认解除关联该客户吗？\n  ")]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleClose}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.cancelRelative}},[e._v("确认")])],1)])},u=[],h=o("7df0"),m=o("9873"),d={name:"relativeCustomerDialog",props:{relativeDialogVisible:{type:Boolean,default:!1},customerId:{type:String,default:""}},components:{CustomerBasicInfo:h["a"]},data:function(){return{pickerOptions:m["a"],relativeForm:{action:"",actionDate:"",desc:""}}},methods:{cancelRelative:function(){var e=this;Object(n["b"])(this.customerId).then((function(t){2e4===t.code&&(e.$message.success("取消关联成功"),e.$emit("cancelRelativeSuccess"))}))},handleClose:function(){this.$emit("closeDialog")}}},p=d,f=(o("e247"),o("dbf0"),o("2877")),g=Object(f["a"])(p,c,u,!1,null,"49eb1474",null),v=g.exports,b={data:function(){var e={nowPage:"customerTable",show:!0,fixed:"right",size:"small",width:180,minWidth:100,label:"操作",btns:[{type:"text",size:"",content:"查看详情",icon:"",handle:"detail",class:"button-operator"},{type:"text",size:"",content:"跟进客户",icon:"",handle:"followCustomer",class:"button-operator"}]};return{currentCustomerId:"",followDialogVisible:!1,relativeDialogVisible:!1,loading:!1,customerTypeValue:"",moduleName:"客户类型",dialogType:"status",dialogContent:"",titleOprator:"新增",dialogTitle:"",dialogVisible:!1,column:[],formItem:[],formData:{},tableData:[],pageSize:10,currentPage:1,total:0,operation:e}},components:{MyTable:s["a"],FollowCustomerDialog:l["a"],RelativeDialog:v},props:{supervisor:{type:String,default:""},searchParams:{type:Object,default:function(){}},searchFlag:{type:Boolean,default:!1}},watch:{searchFlag:function(e){!0===e&&this.getCustomerList()}},created:function(){this.fieldInit(),this.getCustomerList()},methods:{ifShowChargeColomn:function(){"owner"===this.$route.meta.name&&this.column.length?this.column[6].show=!1:this.column.length&&(this.column[6].show=!0)},changeCharge:function(e){this.$emit("changeCharge",e)},handleSizeChange:function(e){this.pageSize=e,this.getCustomerList()},goToRelative:function(e){this.$router.push({path:"/crm/customer/".concat(this.$route.meta.name,"/related"),query:{userId:e.id}})},clearRelative:function(e){this.currentCustomerId=e.id,this.relativeDialogVisible=!0},fieldInit:function(){var e=Object(i["a"])("customerList");e.forEach((function(e){e.width&&"auto"!=e.width&&(e.width="300")})),this.column=e,this.ifShowChargeColomn()},handleStatusColClick:function(e){var t=e.row;e.$index;this.dialogTitle="状态切换提示",this.dialogType="status",this.dialogContent="确认".concat(t.status?"开启":"关闭","该客户类型吗？"),this.dialogShow()},detail:function(e){this.$router.push({path:"/crm/customer/".concat(this.$route.meta.name,"/detail/").concat(e.id)})},followCustomer:function(e){var t=this;this.currentCustomerId=e.id,this.$nextTick((function(){t.followDialogVisible=!0}))},handleCurrentChange:function(e){this.currentPage=e,this.getCustomerList()},setTableData:function(e){var t=this,o=e.list;this.tableData=o.map((function(e,o){return{nickname:e.nickname?e.nickname:"",weapp_id:e.weapp_id?e.weapp_id:"",customer_ask:e.customer_ask?e.customer_ask:"",user_type:e.user_type?e.user_type:"-",isRelative:!!e.is_relative&&e.is_relative,have_contract:e.have_contract?e.have_contract:"-",fd_sign_status:e.fd_sign_status?e.fd_sign_status:"未知",is_during_pregnancy:e.is_during_pregnancy?e.is_during_pregnancy:"-",remark:e.remark?e.remark:"-",supervisor:e.supervisor?e.supervisor:"",creator:e.creator?e.creator:"-",createAt:e.created_at?t.formatTime(e.created_at):"-",updatedAt:e.updated_at?t.formatTime(e.updated_at):"-",source_channel:e.source_channel?e.source_channel:"-",babys:e.babys?e.babys:"-",id:e._id}}))},getCustomerList:function(){var e=this,t={current_page:this.currentPage,page_size:this.pageSize};this.relativeDialogVisible=!1,this.followDialogVisible=!1,this.loading=!0;var o=Object.assign({},t,this.searchParams);o.supervisor=this.supervisor?this.supervisor:o.supervisor,Object(n["i"])(o).then((function(t){e.loading=!1,t&&(e.total=t.data.count,e.setTableData(t.data),e.$emit("searchFlag",!1))})).catch((function(t){e.loading=!1}))}}},w=b,_=Object(f["a"])(w,r,a,!1,null,null,null);t["a"]=_.exports},5078:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-button",{staticClass:"crm__search__collapse-btn",attrs:{type:"text"},on:{click:e.ifShowFun}},[e._v("\n    "+e._s(e.searchFormShowText)+"\n    "),o("i",{staticClass:"el-icon--right",class:e.searchFormShow?"el-icon-arrow-up":"el-icon-arrow-down"})])],1)},a=[],i={data:function(){return{}},props:{searchFormShow:{type:Boolean,default:!0}},computed:{searchFormShowText:function(){return this.searchFormShow?"收起":"展开搜索条件"}},methods:{ifShowFun:function(){this.$emit("ifShowFun")}}},s=i,n=o("2877"),l=Object(n["a"])(s,r,a,!1,null,null,null);t["a"]=l.exports},"58f6":function(e,t,o){},"5c6d":function(e,t,o){},"61e7":function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("MyForm",{ref:"operatorActionAddForm",attrs:{form:e.form,formData:e.formData,formItem:e.formItem},on:{resetForm:e.resetForm,submit:e.searchSubmit}})},a=[],i=o("116c"),s=o("63d4"),n=o("2ef0"),l=o.n(n),c={data:function(){var e={showFormBorder:!1,showTitle:!1,ref:"operatorActionAddForm",labelWidth:"120px",labelPositon:"right",style:"notprepend",column:3,btnStyle:"inline",hasSubmit:!0,btnRight:!0,cancleShow:!0,submitText:"搜索",cancleText:"重置"};return{searchParams:{},formItem:[],formData:{},form:e,initData:{user_id:"",weapp_info:"",baby_name:"",sourceChannel:"",user_type:"",createAt:"",creator:"",supervisor:"",relative_status:"",fd_sign:""}}},props:{showCharge:{type:Boolean,default:!0},optionsVal:{type:String,default:""},moduleName:{type:String,default:""}},components:{MyForm:s["a"]},created:function(){this.formInit(this.initData),!1===this.showCharge?this.formItem[5].show=!1:this.formItem[5].show=!0},methods:{searchSubmit:function(e){if(e&&e.sourceChannel){var t=l.a.flatMap(e.sourceChannel,2);e.source_channel=t.length?t:""}this.$emit("search",e)},resetForm:function(){this.formData.createAt="",this.$emit("search",{})},formInit:function(e){this.formItem=Object(i["b"])("customerListSearch","item"),this.formData=e||Object(i["b"])("customerListSearch","data")}}},u=c,h=o("2877"),m=Object(h["a"])(u,r,a,!1,null,null,null);t["a"]=m.exports},"753c":function(e,t,o){"use strict";var r=o("58f6"),a=o.n(r);a.a},b607:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"更换负责人",visible:e.followDialogVisible,width:"45%","before-close":e.handleClose,center:!1},on:{"update:visible":function(t){e.followDialogVisible=t},opened:e.resetChangeForm}},["single"===e.changeType?o("div",{staticClass:"margin-bottom-30"},[o("customer-basic-info",{attrs:{"customer-id":e.customerId,"ellipsis-length":12}})],1):e._e(),o("div",{staticClass:"follow"},[o("el-form",{ref:"changeForm",attrs:{model:e.changeForm,"label-position":"right","label-width":"120px"}},[o("SupervisorSelect",{attrs:{prop:"preSuperVisor",label:"选择原负责人",selectDisable:"single"===e.changeType,rules:[{required:!0,message:"请选择负责人",trigger:"change"}]},model:{value:e.changeForm.preSuperVisor,callback:function(t){e.$set(e.changeForm,"preSuperVisor",t)},expression:"changeForm.preSuperVisor"}}),o("SupervisorSelect",{attrs:{label:"选择新负责人",prop:"currentSuperVisor","filter-option":e.changeForm.preSuperVisor,rules:[{required:!0,message:"请选择负责人",trigger:"change"}]},model:{value:e.changeForm.currentSuperVisor,callback:function(t){e.$set(e.changeForm,"currentSuperVisor",t)},expression:"changeForm.currentSuperVisor"}}),o("el-form-item",{attrs:{label:"更换原因",prop:"reason",rules:[{required:!0,message:"请填写更换原因",trigger:"blur"}]}},[o("el-input",{attrs:{type:"textarea",rows:3,"show-word-limit":"",maxlength:"100",placeholder:"请输入内容"},model:{value:e.changeForm.reason,callback:function(t){e.$set(e.changeForm,"reason",t)},expression:"changeForm.reason"}})],1)],1)],1),o("div",{staticClass:"form-tip"},["batch"===e.changeType?o("div",[e._v("\n      此操作会将原负责人的所有客户全部转移至新负责人，请谨慎操作！\n    ")]):e._e(),o("div",[e._v("\n      请确认新负责人已录入过客户信息！\n    ")])]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.changeSuperVisor}},[e._v("确认更换")])],1)])},a=[],i=o("4e37"),s=o("7df0"),n=o("9873"),l=o("3acd"),c={name:"changeSupervisorDialog",props:{followDialogVisible:{type:Boolean,default:!1},customerId:{type:String,default:""},changeType:{type:String,default:"single"},preSupervisor:{type:String,default:""}},components:{SupervisorSelect:i["a"],CustomerBasicInfo:s["a"]},data:function(){return{pickerOptions:n["a"],changeForm:{preSuperVisor:"",currentSuperVisor:"",reason:""}}},methods:{changeSuperVisor:function(){var e=this;this.$refs.changeForm.validate((function(t){if(!t)return!1;var o={prev:e.changeForm.preSuperVisor,now:e.changeForm.currentSuperVisor,reason:e.changeForm.reason};"single"===e.changeType&&(o.customer=e.customerId),Object(l["c"])(o).then((function(t){2e4===t.code&&(e.$message.success("更换负责人成功"),e.$emit("changeSuccess"),e.$emit("closeDialog"))}))}))},handleClose:function(){this.$emit("closeDialog")},resetChangeForm:function(){this.$refs.changeForm.resetFields(),this.changeForm.preSuperVisor=this.preSupervisor}}},u=c,h=(o("753c"),o("2877")),m=Object(h["a"])(u,r,a,!1,null,"677a4585",null);t["a"]=m.exports},dbf0:function(e,t,o){"use strict";var r=o("5c6d"),a=o.n(r);a.a},e247:function(e,t,o){"use strict";var r=o("1fc9"),a=o.n(r);a.a}}]);
//# sourceMappingURL=chunk-6cb48137.68aec711.js.map