(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b65174f"],{"231b":function(e,t,r){"use strict";var a=r("7d3d"),n=r.n(a);n.a},"27f3":function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return p})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return f}));r("6b54");var a=r("75fc"),n=(r("c5f6"),r("8090")),s=function(e){return JSON.parse(JSON.stringify(e))},c=function(e){return Object(n["a"])(e)&&!e.some((function(e){return e instanceof Object}))},i=function(e){return Object(n["a"])(e)&&e.every((function(e){return c(e)}))},o=function(e,t){if(!i(e))throw new Error("params target2dArray is not a strict 2dArray");var r=t||e.reduce((function(e,t){return Math.max(e,Number(u(t)+1))}),0),a=Array.apply(null,{length:r}).map((function(e){return""}));return e.filter((function(e){return e.some((function(e){return Boolean(e)}))})).map((function(e){return e.concat(a).slice(0,r)}))},u=function(e){var t=e.length-1;while(t>-1){if(e[t])return t;if(0===t)return!1;t--}return!1},d=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var c=s(t);if(c.some((function(e){return!Object(n["a"])(e)})))throw new Error("type of oneArg is not array");var i=c.reverse();return i.reduce((function(e,t,r){return 0===r?e.concat(t):e.length>=t.length?e:(t.splice.apply(t,[0,e.length].concat(Object(a["a"])(e))),t)}),[])},f=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=s(t);if(n.some((function(e){return!i(e)})))throw new Error("one of target2dArrays is not a strict 2dArray");var c=n.reverse();return c.reduce((function(e,t,r){if(0===r)return e.concat(t);var n=e.map((function(e,r){return d(t[r]||[],e)}));return e.length<t.length?(t.splice.apply(t,[0,n.length].concat(Object(a["a"])(n))),t):n}),[])},l=function(e,t){return c(e)&&c(t)?e.toString()===t.toString():(console.error("传入的数组不是 1dArray"),!1)},p=function(e,t){return i(e)&&i(t)?e.length===t.length&&e.every((function(e,r){return l(e,t[r])})):(console.error("传入的数组不是 2dArray"),!1)}},"2a72":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"recipe-add"},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"180px",rules:e.rules}},[r("el-form-item",{attrs:{label:"模板名称：",prop:"title"}},["check"!==e.pageType?r("el-input",{staticStyle:{width:"70%"},attrs:{maxlength:"50","show-word-limit":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}):r("span",[e._v(e._s(e.form.title))])],1),r("el-form-item",{attrs:{label:"选择背景图：",prop:"bg_type"}},["check"!==e.pageType?r("el-radio-group",{model:{value:e.form.bg_type,callback:function(t){e.$set(e.form,"bg_type",t)},expression:"form.bg_type"}},[r("el-radio",{attrs:{label:"A"}}),r("el-radio",{attrs:{label:"B"}})],1):r("span",[e._v(e._s(e.form.bg_type))])],1),r("el-form-item",{attrs:{label:"食谱时长：",prop:"duration"}},["check"!==e.pageType?r("el-select",{model:{value:e.form.duration,callback:function(t){e.$set(e.form,"duration",t)},expression:"form.duration"}},[r("el-option",{attrs:{label:"周",value:1}}),r("el-option",{attrs:{label:"月",value:2}})],1):r("span",[e._v(e._s(1===e.form.duration?"周":"月"))])],1),r("el-form-item",{attrs:{label:"表格：",rules:[{required:!0,message:"请填写",trigger:"blur"}]}},[r("c-hot-table",{attrs:{height:300,readonly:"check"===e.pageType},model:{value:e.curHotTableData,callback:function(t){e.curHotTableData=t},expression:"curHotTableData"}})],1),r("el-form-item",{attrs:{label:"注释：",prop:"description"}},["check"!==e.pageType?r("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:10},maxlength:"1000","show-word-limit":""},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}):r("span",[e._v(e._s(e.form.description))])],1),"check"!==e.pageType?r("el-form-item",[r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")]),r("el-button",{on:{click:e.publish}},[e._v("发布")])],1)]):e._e()],1),r("div",{staticClass:"recipes-image"},[r("HtmlToImage",{ref:"htmlToImage",staticClass:"recipe-preview"},[r("div",{staticClass:"recipe",style:{width:"640px",paddingTop:"20px",backgroundImage:"url("+e.curRecipeBgOpt().recipeBg+")"}},[r("img",{staticClass:"recipe__header-img",attrs:{width:"100%",src:e.curRecipeBgOpt().recipeHeadBg,alt:"加载失败"}}),r("div",{staticClass:"recipe__body"},[r("div",{staticClass:"recipe__body__header"},[r("span",{staticClass:"recipe__body__header__title"},[e._v(e._s(e.form.title))]),r("span",{staticClass:"recipe__body__header__sign"},[e._v("十月呵护营养师"+e._s(e.form.dietician&&e.form.dietician.name))])]),r("c-table",{attrs:{data:e.effHtData}}),r("div",{staticClass:"recipe__body__notes"},[r("div",{domProps:{innerHTML:e._s(e.form.description)}})])],1)])])],1)],1)},n=[],s=r("75fc"),c=(r("96cf"),r("3b8d")),i=(r("7f7f"),r("f561")),o=r("dc3a"),u=r("c6a9"),d=r("27f3"),f=r("91ff"),l=r.n(f),p=r("2c4d"),b=r("1e42"),h=r("91b6"),m=function(e){return e.concat(Array.apply(null,{length:31-e.length}).reduce((function(e){return e.concat("")}),[]))}(["周一","周二","周三","周四","周五","周六","周日"]),j=Array.apply(null,{length:31}).reduce((function(e,t,r){return e.concat([["第"+(r+1)+"天"]])}),[]),g={name:"RecipesTemplate",components:{CHotTable:i["a"],CTable:o["a"],HtmlToImage:u["a"]},props:{pageType:{type:String,default:"add"}},data:function(){return{publishUrl:"",dietician:this.$store.state.user.name,templateId:"",recipesId:"",rules:{title:[{required:!0,message:"请输入食谱名称",trigger:"blur"}],bg_type:[{required:!0,message:"请选择背景图",trigger:"change"}],duration:[{required:!0,message:"请选择食谱时长",trigger:"change"}],description:[{required:!0,message:"请填写注释",trigger:"blur"}]},form:{title:"",bg_type:"A",duration:1,description:""},curHotTableData:l.a.helper.createEmptySpreadsheetData(31,8),baseRecipeTableData:[["食谱表","7:00","9:30","12:00","15:00","18:00","21:00"]],effHtData:[],curRecBgOpts:p["a"]}},watch:{curHotTableData:{handler:function(e){this.effHtData=Object(d["c"])(e)},deep:!0},duration:function(e){this.durationInit(),this.recipeDurChangeHandle(e)}},computed:{duration:function(){return this.form.duration}},created:function(){var e=this;"add"===this.pageType?(this.durationInit(),this.recipeDurChangeHandle(1)):(this.templateId=this.$route.query.id,Object(b["f"])(this.templateId).then((function(t){e.form=t.data,e.form.duration||(e.form.duration=1),e.curHotTableData=t.data.content})))},methods:{handleSave:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.form.validate((function(e){if(!e)return!1;t.form.content=t.effHtData,"add"!==t.pageType||t.recipesId?Object(b["m"])(t.templateId,t.form).then((function(e){2e4===e.code&&(t.recipesId=e.data._id,t.$message.success("更新成功"))})):Object(b["c"])(t.form).then((function(e){2e4===e.code&&(t.recipesId=e.data._id,t.templateId=t.recipesId,t.$message.success("保存成功"))}))}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),publishRecipes:function(e){var t=this;Object(b["k"])(e).then((function(e){2e4===e.code&&(t.$message.success("发布成功"),t.$router.back(-1))}))},publish:function(){var e=this;this.recipesId?this.publishRecipes(this.recipesId):this.$refs.form.validate((function(t){if(!t)return!1;e.form.content=e.effHtData,"add"===e.pageType?Object(b["c"])(e.form).then((function(t){2e4===t.code&&(e.recipesId=t.data._id,e.publishRecipes(e.recipesId))})):Object(b["m"])(e.templateId,e.form).then((function(t){2e4===t.code&&(e.recipesId=t.data._id,e.publishRecipes(e.recipesId))}))}))},getRecipeUrl:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.htmlToImage.htmlToCanvas(!0);case 2:return r=e.sent,r.name=t,e.next=6,Object(h["c"])(r,(function(e){}));case 6:return a=e.sent,n=a.url,this.publishUrl=n,e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),curRecipeBgOpt:function(){var e=this,t=this.curRecBgOpts.filter((function(t){return t.type===e.form.bg_type}));return 1===t.length?t[0]:{}},recipeDurChangeHandle:function(e){this.curHotTableData=Object(d["a"])(this.curHotTableData,this.durationToTableData[e])},durationInit:function(){this.durationToTableData={1:Object(d["a"])(this.baseRecipeTableData,[[]].concat(Object(s["a"])(m.map((function(e){return[e]}))))),2:Object(d["a"])(this.baseRecipeTableData,[[]].concat(Object(s["a"])(j)))}}}},y=g,v=(r("231b"),r("2877")),k=Object(v["a"])(y,a,n,!1,null,"1c1c0398",null);t["a"]=k.exports},"2c4d":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=[{type:"A",recipeBg:"https://pic1.baobaohehu.com/fd/chat/5b286b6471d886154b417389/20190315173403272BG-02.jpg",recipeHeadBg:"https://pic1.baobaohehu.com/fd/chat/5b286b6471d886154b417389/20190315173403272mother-header.png"},{type:"B",recipeBg:"https://pic1.baobaohehu.com/fd/chat/5b286b6471d886154b417389/20190315172908007BG-01.jpg",recipeHeadBg:"https://pic1.baobaohehu.com/fd/chat/5b286b6471d886154b417389/20190315172908007baby-header.png"}]},"7d3d":function(e,t,r){},8090:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("6b54");function a(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}}a("Object"),a("String");var n=Array.isArray||a("Array");a("Function")},"91b6":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return d}));r("7f7f"),r("386d"),r("28a5");var a=r("db72"),n=(r("96cf"),r("3b8d")),s=r("b775"),c=function(){return Object(s["a"])({url:"/oss/auth",method:"get"})},i=function(e){return Object(s["a"])({url:e+"?x-oss-process=image/info",method:"get"})},o=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,n,c,o,u,d,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.oss,n=t.key,c=t.file,o=t.onProgress,u=new FormData,u.append("OSSAccessKeyId",r.OSSAccessKeyId),u.append("success_action_status",200),u.append("policy",r.policy),u.append("Signature",r.Signature),u.append("key",n),u.append("file",c),d="https://pic1.baobaohehu.com/",e.next=11,Object(s["a"])({url:d,method:"post",headers:{"Content-Type":"multipart/form-data"},onUploadProgress:o||null,data:u});case 11:if(d+=n,!(c.type.indexOf("image")>-1)){e.next=18;break}return e.next=15,i(d);case 15:f=e.sent,e.next=27;break;case 18:if(!(c.type.indexOf("video")>-1)){e.next=22;break}f=Object(a["a"])({},c.videoMeta,{size:c.size}),e.next=27;break;case 22:if(!(c.type.indexOf("audio")>-1)){e.next=26;break}f={size:c.size,type:c.type},e.next=27;break;case 26:throw new Error("当前上传的类型不是image或者video；当前上传的类型是"+c.type);case 27:return e.abrupt("return",{url:d,meta:f});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(e){if(!e||"string"!==typeof e)return!1;var t=e.split("").reverse().join(""),r=t.substring(0,t.search(/\./)).split("").reverse().join("");return r},d=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,s,i,d,f,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return a=e.sent,n=a.data,s=Math.floor(99*Math.random())+1,i=(new Date).getTime(),d=u(t.name),i=i+s+"."+d,f="".concat(n.path,"/").concat(n.prefix,"/").concat(i),e.next=11,o({oss:n,key:f,file:t,onProgress:r});case 11:return l=e.sent,e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},e945:function(e,t,r){var a={"./af":"c00a","./af.js":"c00a","./ar":"c97e","./ar-dz":"0162","./ar-dz.js":"0162","./ar-kw":"fae4","./ar-kw.js":"fae4","./ar-ly":"aa71","./ar-ly.js":"aa71","./ar-ma":"5d88","./ar-ma.js":"5d88","./ar-sa":"a10a","./ar-sa.js":"a10a","./ar-tn":"152f","./ar-tn.js":"152f","./ar.js":"c97e","./az":"54cd","./az.js":"54cd","./be":"3dd4","./be.js":"3dd4","./bg":"a802","./bg.js":"a802","./bm":"7cd9","./bm.js":"7cd9","./bn":"7151","./bn.js":"7151","./bo":"323a","./bo.js":"323a","./br":"3138","./br.js":"3138","./bs":"acbc","./bs.js":"acbc","./ca":"0876","./ca.js":"0876","./cs":"0aef","./cs.js":"0aef","./cv":"8be7","./cv.js":"8be7","./cy":"6764","./cy.js":"6764","./da":"7612","./da.js":"7612","./de":"4da8","./de-at":"976e","./de-at.js":"976e","./de-ch":"686e","./de-ch.js":"686e","./de.js":"4da8","./dv":"39df","./dv.js":"39df","./el":"4c94","./el.js":"4c94","./en-au":"4415","./en-au.js":"4415","./en-ca":"499b","./en-ca.js":"499b","./en-gb":"4e86","./en-gb.js":"4e86","./en-ie":"7c7e","./en-ie.js":"7c7e","./en-nz":"f766","./en-nz.js":"f766","./eo":"8135","./eo.js":"8135","./es":"6ebc","./es-do":"e481","./es-do.js":"e481","./es-us":"d75c","./es-us.js":"d75c","./es.js":"6ebc","./et":"e662","./et.js":"e662","./eu":"65b7","./eu.js":"65b7","./fa":"0028","./fa.js":"0028","./fi":"5fd1","./fi.js":"5fd1","./fo":"72f4","./fo.js":"72f4","./fr":"6e81","./fr-ca":"c471","./fr-ca.js":"c471","./fr-ch":"f797","./fr-ch.js":"f797","./fr.js":"6e81","./fy":"d8b9","./fy.js":"d8b9","./gd":"94ef","./gd.js":"94ef","./gl":"c74b","./gl.js":"c74b","./gom-latn":"5601","./gom-latn.js":"5601","./gu":"2a3d1","./gu.js":"2a3d1","./he":"9669","./he.js":"9669","./hi":"e85f","./hi.js":"e85f","./hr":"bf5e","./hr.js":"bf5e","./hu":"9901","./hu.js":"9901","./hy-am":"012e","./hy-am.js":"012e","./id":"ba8c","./id.js":"ba8c","./is":"c6c1","./is.js":"c6c1","./it":"6101","./it.js":"6101","./ja":"f2b8","./ja.js":"f2b8","./jv":"d9e8","./jv.js":"d9e8","./ka":"4d4c","./ka.js":"4d4c","./kk":"b770","./kk.js":"b770","./km":"b388","./km.js":"b388","./kn":"a056","./kn.js":"a056","./ko":"44157","./ko.js":"44157","./ky":"d2f5","./ky.js":"d2f5","./lb":"01fe","./lb.js":"01fe","./lo":"d759","./lo.js":"d759","./lt":"d47b","./lt.js":"d47b","./lv":"3793","./lv.js":"3793","./me":"b26f","./me.js":"b26f","./mi":"d0b2","./mi.js":"d0b2","./mk":"8357","./mk.js":"8357","./ml":"b4f4","./ml.js":"b4f4","./mr":"96b4","./mr.js":"96b4","./ms":"9bf3","./ms-my":"64f3","./ms-my.js":"64f3","./ms.js":"9bf3","./mt":"44b6","./mt.js":"44b6","./my":"35e88","./my.js":"35e88","./nb":"cd6b","./nb.js":"cd6b","./ne":"ee29","./ne.js":"ee29","./nl":"fd25","./nl-be":"11d4","./nl-be.js":"11d4","./nl.js":"fd25","./nn":"a90d","./nn.js":"a90d","./pa-in":"048e","./pa-in.js":"048e","./pl":"b099","./pl.js":"b099","./pt":"8cc1","./pt-br":"cd1a","./pt-br.js":"cd1a","./pt.js":"8cc1","./ro":"4f7b","./ro.js":"4f7b","./ru":"4a7a","./ru.js":"4a7a","./sd":"441d","./sd.js":"441d","./se":"1e99","./se.js":"1e99","./si":"6c0c","./si.js":"6c0c","./sk":"5234","./sk.js":"5234","./sl":"f896","./sl.js":"f896","./sq":"34ed","./sq.js":"34ed","./sr":"849e","./sr-cyrl":"85d6","./sr-cyrl.js":"85d6","./sr.js":"849e","./ss":"4061","./ss.js":"4061","./sv":"d88f","./sv.js":"d88f","./sw":"e7a7","./sw.js":"e7a7","./ta":"d3b3","./ta.js":"d3b3","./te":"eed5","./te.js":"eed5","./tet":"b816","./tet.js":"b816","./th":"19cc","./th.js":"19cc","./tl-ph":"672a","./tl-ph.js":"672a","./tlh":"3f0d","./tlh.js":"3f0d","./tr":"b6ff","./tr.js":"b6ff","./tzl":"3455","./tzl.js":"3455","./tzm":"4707","./tzm-latn":"022c","./tzm-latn.js":"022c","./tzm.js":"4707","./uk":"6901","./uk.js":"6901","./ur":"bc69","./ur.js":"bc69","./uz":"1d5c","./uz-latn":"1f6a","./uz-latn.js":"1f6a","./uz.js":"1d5c","./vi":"9128","./vi.js":"9128","./x-pseudo":"a886","./x-pseudo.js":"a886","./yo":"1db8","./yo.js":"1db8","./zh-cn":"ed0f","./zh-cn.js":"ed0f","./zh-hk":"b487","./zh-hk.js":"b487","./zh-tw":"1940","./zh-tw.js":"1940"};function n(e){var t=s(e);return r(t)}function s(e){var t=a[e];if(!(t+1)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t}n.keys=function(){return Object.keys(a)},n.resolve=s,e.exports=n,n.id="e945"}}]);
//# sourceMappingURL=chunk-0b65174f.04d1065b.js.map