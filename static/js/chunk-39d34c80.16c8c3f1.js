(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39d34c80"],{"4cc3":function(e,t,r){"use strict";var o=r("5386"),n=r.n(o);n.a},5386:function(e,t,r){},"5da3":function(e,t,r){},"6c1b":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"coupon-add rights-add"},[r("div",{staticClass:"coupon-add__form"},[r("div",{staticClass:"coupon-add__form--title"},[e._v(" "+e._s(e.pageType)+"权益")]),r("div",{staticClass:"coupon-add__form--content"},[r("el-form",{ref:"couponForm",attrs:{model:e.form,"label-width":"180px"}},[r("div",{staticStyle:{width:"600px"}},[r("el-form-item",{attrs:{label:"权益名称：",prop:"name",rules:[{required:!0,message:"请输入标题",trigger:"blur"}]}},[r("el-input",{attrs:{disabled:"编辑"===e.pageType,placeholder:"请输入",maxlength:"20","show-word-limit":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),r("div",{staticStyle:{width:"600px"}},[r("el-form-item",{attrs:{label:"请选择权益类型：",prop:"type",rules:[{required:!0,message:"请选择权益类型",trigger:"blur"}]}},[r("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"编辑"===e.pageType,placeholder:"请选择权益类型",clearable:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.$store.state.dictionary.rightsType,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-form-item",{attrs:{label:"优惠形式：",prop:"discount_mode",rules:[{required:!0,message:"请选择优惠形式",trigger:"blur"}]}},[r("el-radio-group",{attrs:{disabled:"编辑"===e.pageType},model:{value:e.form.discount_mode,callback:function(t){e.$set(e.form,"discount_mode",t)},expression:"form.discount_mode"}},[r("el-radio",{attrs:{label:"PRICE"}},[e._v(" 优惠金额")]),r("el-radio",{attrs:{label:"PERCENT"}},[e._v("优惠折扣")])],1)],1),"PRICE"===e.form.discount_mode?r("div",{staticClass:"money-item"},[r("el-form-item",{attrs:{label:"优惠金额：",prop:"discount_value",rules:[{required:!0,message:"请输入优惠值",trigger:"change"}]}},[r("el-input",{staticStyle:{width:"80%"},attrs:{disabled:"编辑"===e.pageType,placeholder:"请输入"},on:{input:e.checkMoney,change:e.MoneyToFixed},model:{value:e.form.discount_value,callback:function(t){e.$set(e.form,"discount_value",t)},expression:"form.discount_value"}}),e._v("\n             元 "),r("span",{staticClass:"money-tips"},[e._v(e._s(e.moneyTips))])],1)],1):e._e(),"PERCENT"===e.form.discount_mode?r("div",{staticClass:"money-item"},[r("el-form-item",{attrs:{label:"优惠折扣：",prop:"discount_value",rules:[{required:!0,message:"请输入优惠折扣",trigger:"blur"}]}},[r("el-input-number",{staticStyle:{width:"80%"},attrs:{max:9.9,min:0,step:1},model:{value:e.form.discount_value,callback:function(t){e.$set(e.form,"discount_value",e._n(t))},expression:"form.discount_value"}}),e._v("\n             折\n            "),r("span",{staticClass:"money-tips-discount"},[e._v(e._s(e.moneyTipsDiscount))])],1)],1):e._e(),r("el-form-item",{attrs:{label:"适用套餐：",prop:"scope_product",rules:[{required:!0,message:"请选择适用套餐",trigger:"change"}]}},[r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),r("div",{staticStyle:{margin:"5px 0"}}),r("el-checkbox-group",{on:{change:e.handleCheckedChange},model:{value:e.form.scope_product,callback:function(t){e.$set(e.form,"scope_product",t)},expression:"form.scope_product"}},[r("div",e._l(e.products,(function(t){return r("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)])],1),"ASK"!==e.form.type?r("div",[r("el-form-item",{attrs:{label:"适用人群：",prop:"scope_user",rules:[{required:!0,message:"请选择适用人群",trigger:"change"}]}},[r("el-radio-group",{model:{value:e.form.scope_user,callback:function(t){e.$set(e.form,"scope_user",t)},expression:"form.scope_user"}},e._l(e.$store.state.dictionary.scopeUser,(function(t){return r("el-radio",{key:t.value,attrs:{label:t.value}},[e._v("\n                "+e._s(t.label))])})),1)],1),r("div",{staticClass:"tips-wrap"},[r("div",[e._v("\n              无所选套餐购买记录用户：指从未购买过所选套餐的用户\n            ")]),r("div",[e._v("\n              无任何套餐购买记录用户：指从未购买过任何套餐的用户\n            ")])])],1):e._e(),r("el-form-item",{attrs:{label:"权益描述：",prop:"description",rules:[{required:!0,message:"请输入权益描述",trigger:"blur"}]}},[r("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",rows:"4",placeholder:"请输入"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("el-form-item",[r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitCoupon}},[e._v("确认"+e._s("新增"===e.pageType?e.pageType:"修改"))])],1)])],1)],1)])])},n=[],c=(r("c5f6"),r("b7be")),a=r("8975"),u=r("f1c9"),i=r("2ef0"),s=r.n(i),d={name:"Add",data:function(){return{moneyTips:"请确保填写的优惠金额准确无误，以免对公司造成损失",moneyTipsDiscount:"如需设置88折优惠，请填写8.8",isIndeterminate:!1,checkAll:!1,products:[],form:{name:"",type:"",description:"",discount_mode:null,discount_value:null,scope_product:[],scope_user:""}}},computed:{pageType:function(){return"update"===this.$route.params.type?"编辑":"add"===this.$route.params.type?"新增":""}},created:function(){var e=this;this.getProducts(),"new"!==this.$route.params.id&&Object(c["i"])(this.$route.params.id).then((function(t){e.form=e.pickCommonFormItem(t.data),e.$nextTick((function(){e.form.scope_product=t.data.scope_product.map((function(e){return e.batch_id})),e.checkAll=e.form.scope_product.length===e.products.length})),e.form.discount_value=t.data.discount_value/100,"FD"===e.form.type&&(e.form.scope_user=t.data.scope_user)}))},methods:{MoneyToFixed:function(e){Number(e)&&(this.form.discount_value=Number(e).toFixed(2))},checkMoney:function(e){isNaN(Number(e))&&(this.form.discount_value="")},pickCommonFormItem:function(e){return s.a.pick(e,["name","type","description","discount_mode","scope_product"])},handleCheckedChange:function(e){var t=e.length;this.checkAll=t===this.products.length,this.isIndeterminate=t>0&&t<this.products.length},handleCheckAllChange:function(e){var t=this.products.map((function(e){return e.value}));this.form.scope_product=e?t:[],this.isIndeterminate=!1},fenToYuan:a["fenToYuan"],getProducts:function(){var e=this,t={show_history:0};Object(u["d"])(t).then((function(t){var r=t.data.list;e.products=r.map((function(e){return{value:e.batch_id,label:"".concat(e.title," ").concat(e.sub_title,"   (").concat(e.version," ¥").concat(e.price/100,".00)")}}))}))},submitCoupon:function(){var e=this;this.$refs.couponForm.validate((function(t){if(!t)return!1;var r=e.pickCommonFormItem(e.form);r.discount_value=100*e.form.discount_value,"FD"===e.form.type&&(r.scope_user=e.form.scope_user),"新增"===e.pageType?Object(c["b"])(r).then((function(t){e.$message.success("新增权益成功"),e.$router.push({name:"RightsList"})})):Object(c["j"])(e.$route.params.id,r).then((function(t){e.$message.success("更新权益成功"),e.$router.push({name:"RightsList"})}))}))}}},l=d,p=(r("e80b"),r("4cc3"),r("2877")),m=Object(p["a"])(l,o,n,!1,null,"03a6d974",null);t["default"]=m.exports},b7be:function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"b",(function(){return c})),r.d(t,"i",(function(){return a})),r.d(t,"j",(function(){return u})),r.d(t,"k",(function(){return i})),r.d(t,"g",(function(){return s})),r.d(t,"f",(function(){return d})),r.d(t,"e",(function(){return l})),r.d(t,"a",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"c",(function(){return f}));var o=r("b775");function n(e){return Object(o["a"])({url:"/trade/quanyi",method:"get",params:e})}function c(e){return Object(o["a"])({url:"/trade/quanyi",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/trade/quanyi/".concat(e),method:"get"})}function u(e,t){return Object(o["a"])({url:"/trade/quanyi/".concat(e),method:"put",data:t})}function i(e,t){return Object(o["a"])({url:"/trade/quanyi/".concat(e,"/status"),method:"put",data:t})}function s(e){return Object(o["a"])({url:"/discount_coupon/list",method:"get",params:e})}function d(){return Object(o["a"])({url:"/discount_coupon/filter",method:"get"})}function l(){return Object(o["a"])({url:"/discount_coupon/create_info",method:"get"})}function p(e){return Object(o["a"])({url:"/discount_coupon",method:"post",data:e})}function m(e){return Object(o["a"])({url:"discount_coupon/".concat(e,"/create_qrcode"),method:"put"})}function f(e){return Object(o["a"])({url:"/discount_coupon/"+e._id+"/change_status",method:"put",data:e})}},e80b:function(e,t,r){"use strict";var o=r("5da3"),n=r.n(o);n.a},f1c9:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return u})),r.d(t,"f",(function(){return i})),r.d(t,"c",(function(){return s}));var o=r("b775");function n(e){return Object(o["a"])({url:"/fd/products",method:"get",params:e})}function c(e){return Object(o["a"])({url:"/fd/products",method:"post",data:e})}function a(e,t){return Object(o["a"])({url:"/fd_service_type/services",method:"get",params:t})}function u(e,t){return Object(o["a"])({url:"/fd/products/".concat(e,"/status"),method:"put",data:t})}function i(e,t){return Object(o["a"])({url:"/fd/products/".concat(e),method:"put",data:t})}function s(e){return Object(o["a"])({url:"/fd/products/".concat(e),method:"get"})}}}]);
//# sourceMappingURL=chunk-39d34c80.16c8c3f1.js.map