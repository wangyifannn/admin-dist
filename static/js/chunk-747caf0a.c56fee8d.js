(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-747caf0a","chunk-333f921d","chunk-6d887106","chunk-333f921d","chunk-b939e5e4","chunk-2a4a4f78"],{"00ef":function(e,t,s){},"0152":function(e,t,s){"use strict";var a=s("33eb"),n=s.n(a);n.a},"0195":function(e,t,s){"use strict";var a=s("8824"),n=s.n(a);n.a},"03cb":function(e,t,s){"use strict";var a=s("64e6"),n=s.n(a);n.a},"0520":function(e,t,s){"use strict";var a=s("db8d"),n=s.n(a);n.a},"0692":function(e,t,s){},"0831":function(e,t,s){"use strict";var a=s("f467"),n=s.n(a);n.a},"0945":function(e,t,s){},"09d0":function(e,t,s){},"09f5":function(e,t,s){},"0e08":function(e,t,s){},"0e79":function(e,t,s){},"0f00":function(e,t,s){},"117b":function(e,t,s){},"11b6":function(e,t,s){},1201:function(e,t,s){"use strict";var a=s("00ef"),n=s.n(a);n.a},"17e4":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chanke_health_file_detail"},[s("div",[s("span",{staticStyle:{"vertical-align":"middle",display:"inline-block"}},[s("el-avatar",{attrs:{size:"medium",src:e.userInfo.avatar}})],1),s("span",{staticClass:"margin-right-30"},[e._v(" 用户："+e._s(e.userInfo.nickname)+" ")]),s("div",{class:e.memberId?"wrap":"no_wrap"},[s("span",{staticClass:"margin-right-30"},[e._v(" 患者姓名："+e._s(e.member.name)+" ")]),s("span",[e._v(" 当前阶段："+e._s(e.curStageTxt(e.cur_stage))+" ")])])]),s("el-tabs",{staticStyle:{"margin-top":"20px"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"basic_info"}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v("基本信息")]),s("div",{staticClass:"patient_info"},[s("div",[s("span",{staticClass:"span-key"},[e._v("患者姓名：")]),s("span",{staticClass:"span-val"},[e._v("\n            "+e._s(e.member.name)+"\n          ")])]),s("div",[s("span",{staticClass:"span-key"},[e._v("出生日期：")]),s("span",{staticClass:"span-val"},[e._v("\n            "+e._s(e._f("formatTime")(new Date(e.member.birthday),"{y}-{m}-{d}"))+"\n          ")])]),s("div",[s("span",{staticClass:"span-key"},[e._v("年龄： ")]),s("span",{staticClass:"span-val"},[e._v("\n            "+e._s(e.member.age_of_month_value.year)+"岁\n          ")])]),s("div",[s("span",{staticClass:"span-key"},[e._v("职业： ")]),s("span",{staticClass:"span-val"},[e._v("\n            "+e._s(e.member.chanke.profession||"--")+"\n          ")])])]),s("basicInfoForm",{attrs:{basicInfo:e.chankeBasicInfo,dataChange:e.dataChange,memberId:e.memberId,pageType:e.pageType,btnDisabled:!("hm"===e.role)},on:{dataChange:e.setDataChange,submitSuccess:e.getDetail}})],1),s("el-tab-pane",{attrs:{name:"byz"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:"byz"===e.cur_stage,expression:"cur_stage === 'byz'"}],attrs:{"icon-class":"select"}}),e._v("\n        备孕中\n      ")],1),s("byzForm",{attrs:{byzInfo:e.byzInfo,btnDisabled:!("byz"===e.cur_stage&&"hm"===e.role)},on:{byzSubmit:e.formSubmit}})],1),s("el-tab-pane",{attrs:{name:"hyz"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:"hyz"===e.cur_stage,expression:"cur_stage === 'hyz'"}],attrs:{"icon-class":"select"}}),e._v("\n        怀孕中")],1),s("hyzForm",{attrs:{hyzInfo:e.hyzInfo,btnDisabled:!("hyz"===e.cur_stage&&"hm"===e.role)},on:{hyzSubmit:e.formSubmit}})],1),s("el-tab-pane",{attrs:{name:"crq"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:"crq"===e.cur_stage,expression:"cur_stage === 'crq'"}],attrs:{"icon-class":"select"}}),e._v("\n        产褥期")],1),s("crqForm",{attrs:{crqInfo:e.crqInfo,btnDisabled:!("crq"===e.cur_stage&&"hm"===e.role)},on:{crqSubmit:e.formSubmit}})],1)],1)],1)},n=[],r=s("db72"),i=s("7b1f"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fileDeatil_answer_box"},[s("div",{staticClass:"fileDeatil_form_box"},[s("div",{staticClass:"fileDeatil_form_item"},[s("MyForm",{ref:"healthfileForm",attrs:{form:e.fileDeatilFormAttr,formItem:e.formItem,formData:e.formData},on:{submit:e.getsubmit}},[s("fksssForm",{ref:"fksssForm",attrs:{slot:"fksss",fksssData:e.formData.fuke_showshu_historys},on:{removeFksss:e.removeFksssFun,addFksss:e.addFksssData},slot:"fksss"}),s("sxsForm",{ref:"sxsForm",attrs:{slot:"sxs",sxsData:e.formData.shuxue_historys},on:{addSxs:e.addSxsData,removeSxs:e.removeSxsFun},slot:"sxs"}),s("ycsForm",{ref:"ycsForm",attrs:{slot:"ycs",ycsData:e.formData.yc_historys},on:{addYcs:e.addYcsData,removeYcs:e.removeYcsFun},slot:"ycs"}),s("div",{staticClass:"align-left fontsize-12 color-orange",attrs:{slot:"updateInfo"},slot:"updateInfo"},[e._v("\n          最近保存时间："+e._s(e.formatTime(e.formData.update_at))),s("br"),e._v("\n          修改人："+e._s(e.formData.update_user)+"\n        ")])],1)],1)])])},l=[],c=(s("ac6a"),s("63d4")),u={};(function(e){var t={item:[{type:"radio",name:"is_schedule",value:"",width:"100%",label:"月经史(月经是否规律)：",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择月经史（月经是否规律）",trigger:"blur"}]},{cascaderItem:["is_schedule"],cascaderValue:!0,type:"inputnumber",name:"period_start",value:"",colSpan:6,width:"100%",min:1,max:100,label:"周期：",unit:"天",show:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{cascaderItem:["is_schedule"],cascaderValue:!0,type:"inputnumber",name:"period_end",value:"",colSpan:18,width:"100%",min:1,max:100,label:"至",unit:"天",show:!0},{cascaderItem:["is_schedule"],cascaderValue:!0,type:"inputnumber",name:"duration_start",value:"",colSpan:6,width:"100%",unit:"天",min:1,max:20,label:"每次持续：",show:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{cascaderItem:["is_schedule"],cascaderValue:!0,type:"inputnumber",name:"duration_end",value:"",colSpan:18,min:1,max:20,width:"100%",label:"至",unit:"天",show:!0},{cascaderItem:["is_schedule"],cascaderValue:!0,type:"radio",name:"measure",value:"",width:"100%",label:"月经量：",show:!0,options:[{value:"too_much",label:"过多"},{value:"much",label:"多"},{value:"middle",label:"中"},{value:"little",label:"少"},{value:"too_little",label:"过少"}],rules:[{required:!0,message:"请选择月经量",trigger:"blur"}]},{cascaderItem:["is_schedule"],cascaderValue:!0,type:"html",name:"yjtip",value:'<div class="align-left fontsize-12 color-999">针对月经量过多过少给用户的温馨提示：</br>月经过多：80ml就是过多，如果用卫生巾的量评估，大概每1-2个小时就浸透一大片的卫生巾或卫生棉；</br>月经过少：月经量少于20ml为过少，如果用卫生巾的量评估，一片夜用卫生巾浸满的时候血量大概为20-31ml。</div>',width:"100%",label:"",show:!0},{cascaderItem:["is_schedule"],cascaderValue:!1,type:"textarea",maxlength:100,showlimit:!0,name:"measure_desc",value:"",width:"100%",label:"说明：",show:!0,placeholder:"请输入",rules:[{required:!0,message:"请输入",trigger:"blur"}]},{type:"radio",name:"has_past_history",value:"",width:"100%",label:"既往史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"checkbox",cascaderItem:["has_past_history"],cascaderValue:!0,name:"past_historys",value:"",width:"100%",label:"",options:[{value:"xzb",label:"心脏病"},{value:"szjb",label:"肾脏疾病"},{value:"gzjb",label:"肝脏疾病"},{value:"gxy",label:"高血压"},{value:"px",label:"贫血"},{value:"tnb",label:"糖尿病"},{value:"yg",label:"乙肝"},{value:"other",label:"其他"}],show:!0,rules:[{required:!0,message:"请选择",trigger:"blur"}]},{cascaderItem:["past_historys"],cascaderValue:"other",type:"textarea",maxlength:100,showlimit:!0,name:"past_other_desc",value:"",width:"100%",label:"说明：",show:!0,placeholder:"请输入",rules:[{required:!0,message:"请输入",trigger:"blur"}]},{type:"radio",name:"has_family_history",value:"",width:"100%",label:"家族史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!1,message:"请选择",trigger:"blur"}]},{type:"checkbox",cascaderItem:["has_family_history"],cascaderValue:!0,name:"family_historys",value:"",width:"100%",label:"",options:[{value:"ycxjb",label:"遗传性疾病史"},{value:"jsb",label:"精神病史"},{value:"other",label:"其他"}],show:!0,rules:[{required:!0,message:"请选择",trigger:"blur"}]},{cascaderItem:["family_historys"],cascaderValue:"other",type:"textarea",maxlength:100,showlimit:!0,name:"family_other_desc",value:"",width:"100%",label:"说明：",show:!0,placeholder:"请输入",rules:[{required:!0,message:"请输入",trigger:"blur"}]},{type:"radio",name:"has_personal_history",value:"",width:"100%",label:"个人史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"checkbox",cascaderItem:["has_personal_history"],cascaderValue:!0,name:"personal_historys",value:"",width:"100%",label:"",options:[{value:"yj",label:"饮酒"},{value:"xy",label:"吸烟"},{value:"fyyw",label:"服用药物"},{value:"jcydyhwz",label:"接触有毒有害物质"},{value:"jcfsx",label:"接触放射线"},{value:"other",label:"其他"}],show:!0,rules:[{required:!0,message:"请选择",trigger:"blur"}]},{cascaderItem:["personal_historys"],cascaderValue:"other",type:"textarea",maxlength:100,showlimit:!0,name:"personal_other_desc",value:"",width:"100%",label:"说明：",show:!0,placeholder:"请输入",rules:[{required:!0,message:"请输入",trigger:"blur"}]},{type:"radio",name:"has_fuke_shoushu_history",value:"",width:"100%",label:"妇科手术史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{show:!0,type:"slot",cascaderItem:["has_fuke_shoushu_history"],cascaderValue:!0,slotName:"fksss"},{type:"radio",name:"has_ywgm_history",value:"",width:"100%",label:"药物过敏史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{cascaderItem:["has_ywgm_history"],cascaderValue:!0,type:"text",maxlength:50,showlimit:!0,name:"ywgm_desc",value:"",width:"100%",label:"过敏药物：",show:!0,placeholder:"请输入",rules:[{required:!0,message:"请输入",trigger:"blur"}]},{type:"radio",name:"has_shuxue_history",value:"",width:"100%",label:"输血史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!1,message:"请选择",trigger:"blur"}]},{show:!0,cascaderItem:["has_shuxue_history"],cascaderValue:!0,type:"slot",slotName:"sxs"},{type:"radio",name:"has_yc_history",value:"",width:"100%",label:"孕产史：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{show:!0,type:"slot",cascaderItem:["has_yc_history"],cascaderValue:!0,slotName:"ycs"},{type:"radio",name:"has_baby",value:"",width:"100%",label:"现子女情况：",show:!0,options:[{value:!0,label:"有"},{value:!1,label:"无"}],rules:[{required:!1,message:"请选择现子女情况",trigger:"blur"}]},{cascaderItem:["has_baby"],cascaderValue:!0,type:"inputnumber",name:"boy_num",value:"",width:"100%",label:"男：",show:!0,colSpan:7,min:0,max:5,rules:[{required:!0,message:"请输入0-5的整数",trigger:"blur"}]},{cascaderItem:["has_baby"],cascaderValue:!0,type:"inputnumber",name:"girl_num",value:"",width:"100%",min:0,max:5,colSpan:7,label:"女：",show:!0,rules:[{required:!0,message:"请输入0-5的整数",trigger:"blur"}]},{show:!0,type:"slot",slotName:"updateInfo"}],data:{is_schedule:"",period_start:"",period_end:"",yjtip:"",duration_start:"",duration_end:"",measure:"",measure_desc:"",has_past_history:!1,past_historys:[],past_other_desc:"",has_family_history:"",family_historys:[],family_other_desc:"",has_personal_history:"",personal_historys:[],personal_other_desc:"",has_fuke_shoushu_history:!1,has_shuxue_history:"",shuxue_historys:[{desc:"",at:""}],has_yc_history:"",yc_historys:[{hy_at:"",is_gwy:"",fenmian_status:"",fenmian_at:"",fenmian_mode:"",is_ceqie:""}],fuke_showshu_historys:[{name:"",at:""}],has_ywgm_history:"",ywgm_desc:"",update_at:"",update_user:""}};e.form=t})(u);var d=u,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fksss_box"},[e.fksssData.length?s("div",[e._l(e.fksssData,(function(t,a){return s("el-row",{key:a+"baby"},[s("div",{staticClass:"fksss_form_box"},[s("div",{staticClass:"form_item"},[a>0?s("i",{staticClass:"el-icon-close close_baby_icon",on:{click:function(t){return e.removeFksss(a)}}}):e._e(),s("MyForm",{attrs:{myRef:"fksssForm",form:e.fksssFormAttr,formItem:e.formItem,formData:t}})],1)])])})),s("el-row",[s("p",{staticClass:"add_answer_btn",on:{click:function(t){return e.addFksssFun()}}},[s("i",{staticClass:"el-icon-plus"}),e._v("添加\n      ")])])],2):e._e()])},h=[],p={};(function(e){var t={item:[{type:"text",name:"name",labelWidth:"60px",value:"",width:"100%",label:"手术名称",maxlength:50,showlimit:!0,show:!0,rules:[{required:!0,message:"请输入",trigger:"blur"}]},{name:"at",value:"",width:"100%",label:"手术日期",labelWidth:"60px",show:!0,showBefore:!0,type:"date",placeholder:"请选择手术日期",rules:[{required:!0,message:"请选择手术日期",trigger:"blur"}]}],data:{fuke_showshu_historys:[{name:"",at:""}]}};e.form=t})(p);var f=p,g={props:{fksssData:{type:Array,default:function(){return[]}}},data:function(){var e={showFormBorder:!1,showTitle:!1,labelWidth:"90px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!1,btnRight:!0,userId:"",relativeId:"",cancleShow:!1,submitText:"确认提交",cancleText:""};return{fksssFormAttr:e,formItem:[]}},components:{MyForm:c["a"]},created:function(){this.formInit()},methods:{submitForm:function(){var e=this;this.$refs["fksssForm"].validate((function(t){if(!t)return!1;e.$emit("submit",e.formData)}))},formInit:function(e,t){this.formItem=f.form.item},addFksssFun:function(){this.$emit("addFksss")},removeFksss:function(e){this.$emit("removeFksss",e)}}},b=g,y=(s("e405"),s("2877")),_=Object(y["a"])(b,m,h,!1,null,null,null),v=_.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sxs_box"},[e.sxsData.length?s("div",[e._l(e.sxsData,(function(t,a){return s("el-row",{key:a+"sxs"},[s("div",{staticClass:"sxs_form_box"},[s("div",{staticClass:"form_item"},[a>0?s("i",{staticClass:"el-icon-close close_baby_icon",on:{click:function(t){return e.removesxs(a)}}}):e._e(),s("MyForm",{attrs:{myRef:"sxsForm",form:e.sxsFormAttr,formItem:e.formItem,formData:t}})],1)])])})),s("el-row",[s("p",{staticClass:"add_answer_btn",on:{click:function(t){return e.addsxsFun()}}},[s("i",{staticClass:"el-icon-plus"}),e._v("添加\n      ")])])],2):e._e()])},k=[],x={};(function(e){var t={item:[{type:"text",name:"desc",labelWidth:"80px",value:"",width:"100%",label:"输血情况",maxlength:50,showlimit:!0,show:!0,colSpan:11,rules:[{required:!0,message:"请输入",trigger:"blur"}]},{name:"at",value:"",width:"100%",label:"输血日期",labelWidth:"80px",colSpan:10,show:!0,type:"date",placeholder:"请选择输血日期",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},rules:[{required:!0,message:"请选择输血日期",trigger:"blur"}]}],data:{fksssItem:[{desc:"",at:""}]}};e.form=t})(x);var C=x,F={props:{sxsData:{type:Array,default:function(){return[]}}},data:function(){var e={showFormBorder:!1,showTitle:!1,labelWidth:"90px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!1,btnRight:!0,userId:"",relativeId:"",cancleShow:!1,submitText:"确认提交",cancleText:""};return{sxsFormAttr:e,formItem:[]}},components:{MyForm:c["a"]},created:function(){this.formInit()},methods:{formInit:function(e,t){this.formItem=C.form.item},addsxsFun:function(){this.$emit("addSxs")},removesxs:function(e){this.$emit("removeSxs",e)}}},T=F,I=(s("a7c9"),Object(y["a"])(T,w,k,!1,null,null,null)),S=I.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ycs_box"},[e.ycsData.length?s("div",[e._l(e.ycsData,(function(t,a){return s("el-row",{key:a+"baby"},[s("div",{staticClass:"ycs_form_box"},[s("div",{staticClass:"form_item"},[a>0?s("i",{staticClass:"el-icon-close close_baby_icon",on:{click:function(t){return e.removeycs(a)}}}):e._e(),s("MyForm",{attrs:{myRef:"ycsForm",form:e.ycsFormAttr,formItem:e.formItem,formData:t}})],1)])])})),s("el-row",[s("p",{staticClass:"add_answer_btn",on:{click:function(t){return e.addycsFun()}}},[s("i",{staticClass:"el-icon-plus"}),e._v("添加\n      ")])])],2):e._e()])},j=[],O={};(function(e){var t={item:[{name:"hy_at",value:"",width:"100%",label:"怀孕日期",labelWidth:"80px",colSpan:10,show:!0,type:"date",placeholder:"请选择怀孕日期",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},rules:[{required:!0,message:"请选择怀孕日期",trigger:"blur"}]},{type:"radio",name:"is_gwy",value:"",width:"100%",label:"宫外孕:",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"radio",name:"fenmian_status",value:"",width:"100%",label:"分娩情况:",show:!0,options:[{value:"normal",label:"正常"},{value:"zaochan",label:"早产"},{value:"liuchan",label:"流产"},{value:"yinchan",label:"引产"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{name:"fenmian_at",value:"",width:"100%",label:"分娩日期",labelWidth:"80px",cascaderItem:["fenmian_status"],cascaderType:"array",cascaderValue:["normal","zaochan"],colSpan:10,show:!0,type:"date",placeholder:"请选择分娩日期",showBefore:!0,rules:[{required:!0,message:"请选择分娩日期",trigger:"blur"}]},{name:"fenmian_mode",value:"",width:"100%",label:"分娩方式",labelWidth:"80px",colSpan:10,show:!0,cascaderType:"array",cascaderItem:["fenmian_status"],cascaderValue:["normal","zaochan"],type:"select",placeholder:"请选择分娩方式",options:[{label:"阴道分娩",value:"ydfm"},{label:"剖宫产",value:"pgc"}],rules:[{required:!0,message:"请填写分娩情况",trigger:"blur"}]},{type:"radio",name:"is_ceqie",cascaderItem:["fenmian_mode"],cascaderValue:"ydfm",value:"",width:"100%",label:"是否侧切:",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]}]};e.form=t})(O);var $=O,A={props:{ycsData:{type:Array,default:function(){return[]}}},data:function(){var e={showFormBorder:!1,showTitle:!1,labelWidth:"90px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!1,btnRight:!0,userId:"",relativeId:"",cancleShow:!1,submitText:"确认提交",cancleText:""};return{ycsFormAttr:e,formItem:[]}},components:{MyForm:c["a"]},watch:{},created:function(){this.formInit()},methods:{formInit:function(e,t){this.formItem=$.form.item,console.log(this.formItem)},addycsFun:function(){this.$emit("addYcs")},removeycs:function(e){this.$emit("removeYcs",e)}}},z=A,B=(s("6056"),Object(y["a"])(z,D,j,!1,null,null,null)),M=B.exports,L=s("2ef0"),E=s.n(L),N={props:{memberId:{type:String,default:""},basicInfo:{type:Object,default:function(){}},dataChange:{type:Boolean,default:!1},pageType:{type:String,default:""},btnDisabled:{type:Boolean,default:!1}},data:function(){var e={showFormBorder:!1,showTitle:!1,ref:"healthfileForm",labelWidth:"120px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!0,userId:"",relativeId:"",cancleShow:!1,submitText:"修改并保存",cancleText:""};return{fileDeatilFormAttr:e,fksssFormValid:!1,ycsFormValid:!1,sxsFormValid:!1,formItem:[],formData:{}}},components:{MyForm:c["a"],fksssForm:v,ycsForm:M,sxsForm:S},watch:{basicInfo:{handler:function(e){this.dataChange&&(this.formInit(),this.getData())},deep:!0},btnDisabled:function(e){this.fileDeatilFormAttr.submitDisabled=e}},created:function(){this.formInit(),this.fileDeatilFormAttr.submitDisabled=this.btnDisabled},methods:{addSxsData:function(){var e={desc:"",at:""};this.formData.shuxue_historys.push(e)},addFksssData:function(){var e={name:"",at:""};this.formData.fuke_showshu_historys.push(e)},addYcsData:function(){var e={hy_at:"",is_gwy:"",fenmian_status:"",fenmian_at:"",fenmian_mode:"",is_ceqie:""};this.formData.yc_historys.push(e)},getData:function(){var e=Object.assign({},this.formData,this.basicInfo.yuejing,this.basicInfo.chanke_history,this.basicInfo.baby_info);this.basicInfo.chanke_history&&this.basicInfo.chanke_history.yc_historys||(e.yc_historys=[{hy_at:"",is_gwy:"",fenmian_status:"",fenmian_at:"",fenmian_mode:"",is_ceqie:""}]),this.basicInfo.chanke_history&&this.basicInfo.chanke_history.shuxue_historys||(e.shuxue_historys=[{desc:"",at:""}]),this.basicInfo.chanke_history&&this.basicInfo.chanke_history.fuke_showshu_historys||(e.fuke_showshu_historys=[{name:"",at:""}]),e.update_user=this.basicInfo.update_user,e.update_at=this.basicInfo.update_at,this.formData=e,this.$emit("dataChange",!1)},removeFksssFun:function(e){this.formData.fuke_showshu_historys=E.a.remove(this.formData.fuke_showshu_historys,(function(t,s){return!(s===e)}))},removeSxsFun:function(e){this.formData.shuxue_historys=E.a.remove(this.formData.shuxue_historys,(function(t,s){return!(s===e)}))},removeYcsFun:function(e){this.formData.yc_historys=E.a.remove(this.formData.yc_historys,(function(t,s){return!(s===e)}))},formInit:function(e,t){this.formItem=d.form.item,"chat"===this.pageType&&(this.formItem[1].colSpan=18,this.formItem[2].colSpan=18,this.formItem[3].colSpan=18,this.formItem[4].colSpan=18),this.formData=d.form.data},ycsValid:function(){var e=this.$refs.ycsForm.$children,t=this;e.length?E()(e).forEach((function(e,s){var a=e.$children&&e.$children.length?e.$children[0].$refs:"";a&&a.ycsForm&&a.ycsForm.validate((function(e){t.ycsFormValid=!!e}))})):t.ycsFormValid=!0},fksssValid:function(){var e=this.$refs.fksssForm.$children,t=this;e.length?E()(e).forEach((function(e,s){var a=e.$children&&e.$children.length?e.$children[0].$refs:"";a&&a.fksssForm&&a.fksssForm.validate((function(e){t.fksssFormValid=!!e}))})):t.fksssFormValid=!0},sxsValid:function(){var e=this.$refs.sxsForm.$children,t=this;e.length?E()(e).forEach((function(e,s){var a=e.$children&&e.$children.length?e.$children[0].$refs:"";a&&a.sxsForm&&a.sxsForm.validate((function(e){t.sxsFormValid=!!e}))})):t.sxsFormValid=!0},getsubmit:function(e){var t=this;if(this.formData.has_fuke_shoushu_history?this.fksssValid():this.fksssFormValid=!0,this.fksssFormValid)if(this.formData.has_shuxue_history?this.sxsValid():this.sxsFormValid=!0,this.sxsFormValid)if(this.formData.has_yc_history?this.ycsValid():this.ycsFormValid=!0,this.ycsFormValid){var s=this.formData,a=this.formData,n=this.formData,r={yuejing:s,baby_info:n,chanke_history:a,update_key:"chanke_basic_info"},o=this.$route.params.id||this.memberId||this.basicInfo.member.id;Object(i["z"])(o,r).then((function(e){t.$message({type:"success",message:"修改并保存成功"}),t.$route.params.id||t.$store.dispatch("chat/getActivedUserInfo",{babyId:t.$store.state.chat.activedBabyId}),t.$emit("submitSuccess")}))}else this.$message.error("请填写孕产史");else this.$message.error("请填写输血史");else this.$message.error("请填写妇科手术史")}}},R=N,q=(s("e1de"),Object(y["a"])(R,o,l,!1,null,null,null)),P=q.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"byz_form"},[s("MyForm",{ref:"byzForm",attrs:{form:e.form,formData:e.formData,formItem:e.formItem},on:{submit:e.byzSubmit,resetForm:e.reset}},[s("div",{staticClass:"align-left fontsize-12 color-orange",attrs:{slot:"updateInfo"},slot:"updateInfo"},[e._v("\n      最近保存时间："+e._s(e.formatTime(e.formData.update_at))),s("br"),e._v("\n      修改人："+e._s(e.formData.update_user)+"\n    ")])])],1)},U=[],H=s("af7d"),W={data:function(){var e={showFormBorder:!1,showTitle:!1,ref:"byzForm",labelWidth:"150px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!0,btnRight:!1,cancleShow:!1,submitText:"修改并保存",cancleText:""};return{searchParams:{},formItem:[],formData:{},form:e}},props:{byzInfo:{type:Object,default:function(){}},btnDisabled:{type:Boolean,default:!1}},watch:{byzInfo:{handler:function(e){this.formInit(),this.getData()},deep:!0},btnDisabled:function(e){this.form.submitDisabled=e},"formData.is_checked":function(e){this.formItem[4].show=!1!==e&&this.formData.has_unusual_status},"formData.has_unusual_status":function(e){this.formItem[4].show=this.formData.has_unusual_status}},components:{MyForm:c["a"]},created:function(){this.formInit(),this.form.submitDisabled=this.btnDisabled},methods:{getData:function(){var e=Object.assign({},this.byzInfo);this.formData=e},byzSubmit:function(e){this.$emit("byzSubmit",e)},formInit:function(e){this.formItem=Object(H["b"])("byzForm","item"),this.formData=e||Object(H["b"])("byzForm","data")},reset:function(){this.$emit("searchFun")}}},G=W,Y=(s("aaff"),Object(y["a"])(G,V,U,!1,null,"f090e75e",null)),K=Y.exports,Q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"hyz_form"},[s("MyForm",{ref:"hyzForm",attrs:{form:e.form,formData:e.formData,formItem:e.formItem},on:{submit:e.submit,resetForm:e.reset}},[s("div",{staticClass:"align-left fontsize-12 color-orange",attrs:{slot:"updateInfo"},slot:"updateInfo"},[e._v("\n      最近保存时间："+e._s(e.formatTime(e.formData.update_at))),s("br"),e._v("\n      修改人："+e._s(e.formData.update_user)+"\n    ")])])],1)},J=[],X={data:function(){var e={showFormBorder:!1,showTitle:!1,ref:"hyzForm",labelWidth:"140px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!0,btnRight:!1,cancleShow:!1,submitText:"修改并保存",cancleText:""};return{searchParams:{},formItem:[],formData:{},form:e}},props:{hyzInfo:{type:Object,default:function(){}},btnDisabled:{type:Boolean,default:!1}},watch:{hyzInfo:{handler:function(e){this.formInit(),this.getData()},deep:!0},btnDisabled:function(e){this.form.submitDisabled=this.btnDisabled}},components:{MyForm:c["a"]},created:function(){this.formInit(),this.form.submitDisabled=this.btnDisabled},methods:{getData:function(){var e=Object.assign({},this.hyzInfo);this.formData=e},submit:function(e){this.$emit("hyzSubmit",e)},formInit:function(e){this.formItem=Object(H["b"])("hyzForm","item"),this.formData=e||Object(H["b"])("hyzForm","data")},reset:function(){this.$emit("searchFun")}}},Z=X,ee=(s("2c0a"),Object(y["a"])(Z,Q,J,!1,null,"4785988f",null)),te=ee.exports,se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"crq_form"},[s("MyForm",{ref:"crqForm",attrs:{form:e.form,formData:e.formData,formItem:e.formItem},on:{submit:e.submit,resetForm:e.reset}},[s("div",{staticClass:"align-left fontsize-12 color-orange",attrs:{slot:"updateInfo"},slot:"updateInfo"},[e._v("\n      最近保存时间："+e._s(e.formatTime(e.formData.update_at))),s("br"),e._v("\n      修改人："+e._s(e.formData.update_user)+"\n    ")])])],1)},ae=[],ne={data:function(){var e={showFormBorder:!1,showTitle:!1,ref:"crqForm",labelWidth:"150px",labelPositon:"right",style:"notprepend",column:1,hasSubmit:!0,btnRight:!1,cancleShow:!1,submitText:"修改并保存",cancleText:""};return{searchParams:{},formItem:[],formData:{},form:e}},props:{crqInfo:{type:Object,default:function(){}},btnDisabled:{type:Boolean,default:!1}},components:{MyForm:c["a"]},created:function(){this.formInit(),this.form.submitDisabled=this.btnDisabled},watch:{crqInfo:{handler:function(e){this.formInit(),this.getData()},deep:!0},btnDisabled:function(e){this.form.submitDisabled=e}},methods:{getData:function(){var e=Object.assign({},this.crqInfo);this.formData=e},submit:function(e){this.$emit("crqSubmit",e)},formInit:function(e){this.formItem=Object(H["b"])("crqForm","item"),this.formData=e||Object(H["b"])("crqForm","data")},reset:function(){this.$emit("searchFun")}}},re=ne,ie=(s("0152"),Object(y["a"])(re,se,ae,!1,null,"30c0057d",null)),oe=ie.exports,le=s("8975"),ce=s("2f62"),ue={props:{memberId:{type:String,default:""},department:{type:String,default:""},pageType:{type:String,default:""}},computed:Object(r["a"])({},Object(ce["c"])(["role"])),data:function(){return{activeName:"basic_info",cur_stage:"",userInfo:"",chankeBasicInfo:{},member:{remark:"",name:"",age:"",avatar:"",age_of_month_value:{year:""},chanke:{profession:""}},byzInfo:{},hyzInfo:{},crqInfo:{},dataChange:!1}},components:{basicInfoForm:P,byzForm:K,hyzForm:te,crqForm:oe},created:function(){this.getDetail()},watch:{activeName:function(){this.getDetail()},memberId:function(e,t){e!==t&&this.getDetail()}},methods:{setDataChange:function(e){this.dataChange=e},getDetail:function(){var e=this;(this.$route.params.id||this.memberId)&&(this.memberId&&"chanke"!==this.department||Object(i["o"])(this.$route.params.id||this.memberId,"chanke_"+this.activeName).then((function(t){t&&(e.member=t.data.member,e.userInfo=t.data.user_info,e.cur_stage=t.data.cur_stage,"basic_info"===e.activeName?(e.chankeBasicInfo=t.data.chanke_basic_info,e.dataChange=!0):"byz"===e.activeName?e.byzInfo=t.data.chanke_byz:"hyz"===e.activeName?e.hyzInfo=t.data.chanke_hyz:e.crqInfo=t.data.chanke_crq)})))},curStageTxt:le["curStageTxt"],formSubmit:function(e){var t=this,s={update_key:"chanke_"+this.activeName};s=Object.assign({},s,e);var a=this.memberId||this.$route.params.id;Object(i["z"])(a,s).then((function(e){t.$message({type:"success",message:"修改并保存成功"}),t.$route.params.id||t.$store.dispatch("chat/getActivedUserInfo",{babyId:t.$store.state.chat.activedBabyId}),t.getDetail()}))}}},de=ue,me=(s("eb95"),Object(y["a"])(de,a,n,!1,null,"2329a705",null));t["default"]=me.exports},1840:function(e,t,s){},"1d24":function(e,t,s){"use strict";var a=s("67f3"),n=s.n(a);n.a},"1d3d":function(e,t,s){},"1e85":function(e,t,s){},"1f62":function(e,t,s){},"208d":function(e,t,s){"use strict";var a=s("8703"),n=s.n(a);n.a},"215c":function(e,t,s){},2275:function(e,t,s){"use strict";var a=s("395b"),n=s.n(a);n.a},2413:function(e,t,s){},"242d":function(e,t,s){"use strict";var a=s("f28d"),n=s.n(a);n.a},"24d7":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.msgBody.subType&&"todo"===e.msgBody.subType?s("el-row",{attrs:{type:"flex",justify:"align-center"===e.textAlign?"center":""}},["round_apply_transfer"===e.msgBody.noticeType?s("ReplyUser",{attrs:{replyContent:e.msgBody.adminDesc,"msg-id":e.item._id,operated:e.msgBody.operated,btnIsDisabled:e.btnIsDisabled(e.msgBody),userIntent:e.msgBody.userDesc}}):e._e(),e.msgBody.noticeType&&"transfer_apply"===e.msgBody.noticeType||"transfer_reject"===e.msgBody.noticeType?s("TransferContent",{attrs:{item:e.item,msgOptions:e.msgBody,"bus-role":e.msgBody.bus_role,btnIsDisabled:e.btnIsDisabled(e.msgBody),"notice-type":e.msgBody.noticeType,operated:e.msgBody.operated,reason:e.msgBody.reason,"msg-id":e.item._id},on:{confirm:e.confirm}}):e._e(),e.msgBody.noticeType&&"transfer_accept"===e.msgBody.noticeType?s("TransferAccept",{class:e.textAlign,attrs:{msgId:e.item._id,btnIsDisabled:e.btnIsDisabled(e.msgBody),operated:e.msgBody.operated,msgOptions:e.msgBody},on:{confirm:e.confirm}}):e._e()],1):e._e(),e.msgBody.subType&&"todo"===e.msgBody.subType?e._e():s("el-row",{attrs:{type:"flex",justify:"align-center"===e.textAlign?"center":""}},[s("SystemContent",{class:e.textAlign,attrs:{"msg-type":e.msgBody.subType&&"record"===e.msgBody.subType?"systemWarnning":"systemInfo",content:e.msgBody.content}})],1)],1)},n=[],r=s("db72"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"reply-user-box"},[s("p",{staticClass:"user_intent"},[e._v("\n    "+e._s(e.userIntent)+"\n  ")]),e.operated?s("el-row",[s("span",{staticClass:"span_key"},[e._v("回复用户留言")]),s("p",{staticClass:"notic-reason-box"},[e._v("\n      "+e._s(e.replyContent)+"\n    ")])]):e._e(),e.operated?e._e():s("div",[s("el-row",[s("span",{staticClass:"span_key"},[e._v("回复用户留言")]),s("el-input",{staticClass:"relpy_textarea",attrs:{type:"textarea",rows:3,maxlength:"100","show-word-limit":"",placeholder:"请输入内容"},model:{value:e.replyData,callback:function(t){e.replyData=t},expression:"replyData"}})],1),s("el-row",{attrs:{gutter:24,type:"flex",justify:"center"}},[s("el-button",{staticClass:"btn-group",attrs:{type:"primary",size:"mini",disabled:!(!1===e.btnIsDisabled&&e.activedBaby.is_asking)},on:{click:e.confirmUserIntent}},[e._v("\n        确认\n      ")])],1)],1)],1)},o=[],l=s("f44d"),c=s("2f62"),u={name:"reply-user-box",props:{userIntent:{type:String,default:""},operated:{type:Boolean,default:!0},btnIsDisabled:{type:Boolean,default:!0},replyContent:{type:String,default:""},msgId:{type:String,default:""}},data:function(){return{replyData:""}},computed:Object(r["a"])({},Object(c["c"])(["activedBabyId","activedBaby","userInfo"])),methods:{confirmUserIntent:function(){var e=this;this.replyData?Object(l["c"])(this.msgId,{desc:this.replyData,result:"已确认"}).then((function(t){e.$message({type:t.data.result?"success":"warning",message:t.data.result?"回复成功":"回复失败"}),t&&(e.$store.dispatch("chat/getLastC2CHistoryMessages","",{root:!0}),e.$store.dispatch("chat/getLastAsk"))})):this.$message.warning("回复内容不能为空")}}},d=u,m=(s("567c"),s("2877")),h=Object(m["a"])(d,i,o,!1,null,"38928f7d",null),p=h.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"transfer-apply-content"},[s("el-row",{attrs:{gutter:24}},[s("span",{staticClass:"transfer_key"},[e._v(e._s(e.msgOptions.title))])]),s("el-row",{attrs:{gutter:24}},[s("span",{staticClass:"transfer_key"},[e._v(e._s("transfer_reject"!==e.noticeType?"转诊原因：":"拒绝原因："))]),s("p",{staticClass:"notic-reason-box"},[e._v(e._s(e.msgOptions.reason||"无"))]),e.msgOptions.operateResult.result_text?s("p",{staticClass:"padding-top-10"},[e._v("\n      "+e._s(e.msgOptions.operateResult.result_text)+"\n    ")]):e._e(),e.operated?s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-button",{staticClass:"notic_disabled_btn margin-top-10",attrs:{size:"mini",type:"info",disabled:!0}},[e._v("\n        "+e._s(e.msgOptions.operateResult.result)+"\n      ")])],1):e._e()],1),!1===e.operated?s("el-row",{staticClass:"btn-group"},["transfer_reject"!==e.noticeType?s("el-button",{attrs:{type:"primary",disabled:e.btnIsDisabled,size:"mini"},on:{click:e.acceptFun}},[e._v("\n      同意转诊\n    ")]):e._e(),"transfer_reject"!==e.noticeType?s("el-button",{staticClass:"reject_btn",attrs:{disabled:e.btnIsDisabled,size:"mini"},on:{click:e.rejectFun}},[e._v("\n      无需转诊\n    ")]):e._e(),"transfer_reject"===e.noticeType?s("el-button",{attrs:{disabled:e.btnIsDisabled,type:"primary",size:"mini"},on:{click:e.confirmAccept}},[e._v("\n      确认\n    ")]):e._e()],1):e._e(),e.showReason&&e.rejectRequest?s("el-row",{staticClass:"margin-top-10",attrs:{gutter:24}},[s("span",{staticClass:"transfer_key"},[s("i",{staticClass:"el-icon-info",staticStyle:{color:"#FF4E4E","margin-bottom":"5px"}}),e._v("拒绝原因：\n    ")]),s("span",{staticClass:"transfer_value"},[s("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:3,maxlength:"100","show-word-limit":"",placeholder:"请输入拒绝健康管理师转诊请求的原因"},model:{value:e.reject_reason,callback:function(t){e.reject_reason=t},expression:"reject_reason"}})],1)]):e._e()],1)},g=[],b=s("51a5"),y={name:"TransferContent",props:{item:{type:Object,default:function(){}},msgOptions:{type:Object,default:function(){}},busRole:{type:String,default:""},btnIsDisabled:{type:Boolean,default:!0},noticeType:{type:String,default:""},operated:{type:Boolean,default:!0},msgId:{type:String,default:""}},data:function(){return{reject_reason:"",showReason:!1,rejectRequest:!0}},computed:Object(r["a"])({},Object(c["c"])(["lastAsk","userInfo"])),methods:{confirmAccept:function(){this.$emit("confirm",this.msgId)},rejectFun:function(){var e=this;if(this.showReason){var t={message_id:this.msgId,transfer_reject_reason:this.reject_reason};this.reject_reason&&Object(b["m"])(this.item.fdAsk,t).then((function(t){var s="拒绝转诊";e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"成功":s+"失败"}),t.data.result?e.rejectRequest=!1:e.rejectRequest=!0}))}else this.showReason||(this.showReason=!0)},acceptFun:function(){var e=this;this.item.fdAsk?Object(b["a"])(this.item.fdAsk,{message_id:this.msgId}).then((function(t){e.$message({type:t.data.result?"success":"error",message:t.data.result?"同意转诊成功":"同意转诊失败"}),t.data.result&&e.$store.dispatch("chat/getLastC2CHistoryMessages","",{root:!0})})):this.$message({type:"success",message:"同意转诊失败，请重试"})}}},_=y,v=(s("2bb6"),Object(m["a"])(_,f,g,!1,null,"6c2012b7",null)),w=v.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"notic-box"},[s("p",[e._v("\n    "+e._s(e.msgOptions.content)+"\n  ")]),e.operated?s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-button",{staticClass:"notic_disabled_btn margin-top-10 margin-bottom-10",attrs:{size:"mini",type:"info",disabled:!0}},[e._v("\n      "+e._s(e.msgOptions.operateResult.result)+"\n    ")])],1):e._e(),e.operated?e._e():s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-button",{staticClass:"margin-top-10 margin-bottom-10",attrs:{size:"mini",type:"primary",disabled:e.btnIsDisabled},on:{click:e.confirmAccept}},[e._v("\n      确认\n    ")])],1)],1)},x=[],C={props:{operated:{type:Boolean,default:!0},msgOptions:{type:Object,default:function(){}},btnIsDisabled:{type:Boolean,default:!0},msgId:{type:String,default:""}},data:function(){return{}},methods:{confirmAccept:function(){this.$emit("confirm",this.msgId)}}},F=C,T=Object(m["a"])(F,k,x,!1,null,null,null),I=T.exports,S=s("7160"),D={props:{msgBody:{type:Object,default:function(){}},item:{type:Object,default:function(){}},textAlign:{type:String,default:"align-center"}},components:{ReplyUser:p,TransferContent:w,TransferAccept:I,SystemContent:S["a"]},data:function(){return{}},computed:Object(r["a"])({},Object(c["c"])(["userInfo"])),methods:{btnIsDisabled:function(e){return!(e.bus_role_id===this.userInfo.id)},confirm:function(e){var t=this;if(e){var s={result:"已确认"};Object(l["d"])(e,s).then((function(e){t.$message({type:e&&e.data.result?"success":"error",message:e.message}),t.$store.dispatch("chat/getLastAsk")}))}else this.$message.info("messageId不能为空")}}},j=D,O=Object(m["a"])(j,a,n,!1,null,null,null);t["a"]=O.exports},"271d":function(e,t,s){"use strict";var a=s("31ce"),n=s.n(a);n.a},"2a9e":function(e,t,s){"use strict";var a=s("9284"),n=s.n(a);n.a},"2bb6":function(e,t,s){"use strict";var a=s("1f62"),n=s.n(a);n.a},"2bc0":function(e,t,s){"use strict";var a=s("af6d"),n=s.n(a);n.a},"2c0a":function(e,t,s){"use strict";var a=s("09f5"),n=s.n(a);n.a},"2c79":function(e,t,s){},"2d64":function(e,t,s){},"2edf":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"baby-box cursor-pointer",class:e.activedBaby.family_member&&e.babyDetail.family_member&&e.babyDetail.family_member._id===e.activedBaby.family_member._id?"active_baby":"",on:{click:function(t){return e.handleBaby(e.babyDetail)}}},[e.babyDetail.is_asking?s("div",{staticClass:"consulting"},[e._v("\n    咨询中\n  ")]):e._e(),s("el-row",{staticClass:"baby-collapse"},[s("el-col",{attrs:{span:-1!==e.pathName.indexOf("diagnose")?6:3}},[s("div",{staticClass:"baby-avatar",style:{backgroundImage:"url("+e.babyDetail.family_member.avatar+")"}})]),s("el-col",{staticClass:"clearfix baby-collapse-right",attrs:{span:17}},[s("p",{staticClass:"float-left name"},[e._v(e._s(e.babyDetail.family_member.name))]),s("p",{staticClass:"float-right"},[s("my-copy",{attrs:{copyKey:e.babyDetail.family_member.name}}),e.department?e._e():s("i",{staticClass:"cursor-pointer margin-left-10",class:e.showDetail?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:e.showDetailFun}})],1)])],1),s("div",{staticClass:"baby-info-box"},[s("el-row",{staticClass:"clearfix"},[s("el-col",{staticClass:"baby-id",attrs:{span:11}},[s("span",[e._v("ID：")]),s("span",{staticClass:"span-val"},[e._v(e._s(e.babyDetail.family_member.id))])]),s("el-col",{style:-1!==e.pathName.indexOf("diagnose")?"margin-left:5px":"margin-left:0px",attrs:{span:9}},[s("my-copy",{staticClass:"float-right",attrs:{copyKey:e.babyDetail.family_member.id}})],1)],1),s("ServiceInfo",{attrs:{serviceInfo:e.babyDetail.fd_contract_info,department:e.babyDetail.family_member.type,fdProduct:e.babyDetail.fd_product}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showDetail,expression:"showDetail"}]},[s("BabyCard",{attrs:{isShow:e.showDetail,department:e.babyDetail.family_member.type,babyDetail:e.babyDetail}})],1)],1)],1)},n=[],r=s("db72"),i=s("2f62"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isShow?s("div",{staticClass:"baby-info-card"},[e.userInfoItem.length?s("div",e._l(e.userInfoItem,(function(t,a){return s("div",{key:a},[t.show?s("span",[t.label?s("span",[e._v(e._s(t.label))]):e._e(),t.value?s("span",{staticClass:"span-val"},[e._v("\n          "+e._s(t.value)+"\n        ")]):e._e(),t.html?s("p",{staticClass:"span-val",domProps:{innerHTML:e._s(t.html)}}):e._e()]):e._e()])})),0):e._e(),s("div",{staticClass:"margin-top-10"},[s("span",{staticClass:"add_remark_btn",class:"hm"!==e.role?"notAllow":"",on:{click:e.showAddTextareaFun}},[e._v(e._s(e.tipContent)+"备注（内部可见、不限字数）")])]),e.haveRemark&&!e.showAddTextarea?s("div",[e.remark?s("p",{staticClass:"remark_text"},[e._v(e._s(e.remark))]):e._e(),e.remarkCreatedAt?s("p",{staticClass:"created_at"},[e._v("\n      "+e._s(e.formatTime(e.remarkCreatedAt))+"\n    ")]):e._e()]):e._e(),e.showAddTextarea?s("div",{staticClass:"clearfix"},[s("el-input",{attrs:{type:"textarea",rows:"4","aria-placeholder":"请填写备注信息"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),s("el-button",{staticClass:"float-right margin-top-10",attrs:{type:"primary",size:"mini"},on:{click:e.saveRemarkFun}},[e._v("保存")])],1):e._e()]):e._e()},l=[],c=s("802d"),u=s("7a26"),d=s("8975"),m={name:"BabyInfoCard",props:{babyDetail:{type:Object,deault:function(){}},isShow:{type:Boolean,default:!1},department:{type:String,default:"erke"}},data:function(){return{userInfoItem:[],showAddTextarea:!1,tipContent:"",remark:"",remarkCreatedAt:"",haveRemark:""}},computed:Object(r["a"])({},Object(i["c"])({role:"role"})),watch:{babyDetail:{handler:function(){this.init()},deep:!0},isShow:function(){this.init()}},created:function(){this.init()},methods:{fenmianModeTxt:d["fenmianModeTxt"],feedModeTxt:d["feedModeTxt"],getChankeInfo:u["b"],init:function(){this.isShow&&(this.initCard(),"chanke"===this.department?this.getChankeData(this.babyDetail):this.getErkeData(this.babyDetail))},curStageTxt:d["curStageTxt"],booleanToTxt:d["booleanToTxt"],measureToTxt:d["measureToTxt"],getErkeData:function(e){this.userInfoItem=[];var t="",s=e.family_member;if(s.health_record&&s.health_record.baby_detail_info){var a=s.health_record.baby_detail_info.wyfs;a&&a.length&&(t=a.join("，"))}else t="未知";var n=[{show:!0,label:"性别：",value:1===s.gender?"男":2===s.gender?"女":"未知"},{show:!0,label:"出生孕周：",value:s.gestational_weeks||0===s.gestational_weeks?s.gestational_weeks+"周"+s.gestational_days+"天":""},{show:!0,label:"出生日期：",value:this.formatTime(s.birthday,"{y}-{m}-{d}")},{show:!0,label:"月龄：",value:s.age_of_month},{show:!0,label:"喂养方式：",value:t}];this.userInfoItem=n},getChankeData:function(e){this.userInfoItem=[];var t=e.family_member,s=t.chanke?t.chanke.cur_stage:t.cur_stage,a=e.health_record?e.health_record:t.health_record;if(a){var n=Object.assign({},a.chanke_basic_info.yuejing,a.chanke_basic_info.chanke_history,a.chanke_byz,a.chanke_hyz,a.chanke_crq);this.userInfoItem=this.getChankeInfo(s,n,"","",!0)}},initCard:function(){var e=this.babyDetail.family_member;this.showAddTextarea=!1,this.haveRemark=e&&e.remark?e.remark.content:"",this.remark=e&&e.remark?e.remark.content:"",this.remark&&(this.remarkCreatedAt=e.remark.created_at),this.tipContent=this.haveRemark?"修改":"添加"},showAddTextareaFun:function(){"hm"===this.role&&(this.showAddTextarea=!0)},hideAddTextareaFun:function(){this.showAddTextarea=!1},saveRemarkFun:function(){var e=this;if(this.remark){var t=this.babyDetail.family_member._id;Object(c["a"])(t,{remark:this.remark}).then((function(t){t&&t.data.result&&(e.hideAddTextareaFun(),e.haveRemark=!0,e.remark=t.data.remark.content,e.remarkCreatedAt=t.data.remark.created_at,e.tipContent="修改",-1!==e.$route.path.indexOf("diagnose")&&e.$store.dispatch("chat/getActivedUserInfo"));var s="保存";e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"成功":s+"失败"})}))}else this.$message({type:"warning",message:"备注不能为空"})}}},h=m,p=s("2877"),f=Object(p["a"])(h,o,l,!1,null,null,null),g=f.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.serviceInfo?s("div",[s("p",{staticClass:"margin-top-20 margin-bottom-6"},[e._v("\n    套餐信息\n  ")]),e._v("\n  生效中的套餐："+e._s(e.fdProduct?e.fdProduct.name:"-")+"\n  "),s("el-tooltip",{staticClass:"package",attrs:{effect:"dark",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"package-detail"},["chanke"!==e.department?s("div",[e._v("\n          绑定医生："+e._s(e.serviceInfo.doctor?e.serviceInfo.doctor.name:"无")+"\n        ")]):e._e(),"chanke"!==e.department?s("div",[e._v("\n          绑定营养师："+e._s(e.serviceInfo.dietician?e.serviceInfo.dietician.name:"无")+"\n        ")]):e._e(),s("div",[e._v("\n          "+e._s("chanke"===e.department?"绑定产科医生：":"绑定健康管理师：")+"\n          "+e._s(e.serviceInfo.hm?e.serviceInfo.hm.name:"无")+"\n        ")]),s("p",{staticClass:"color-blue",staticStyle:{margin:"10px 0 0"}},[e._v("\n          当前套餐中咨询转诊余量：\n        ")]),e.serviceTransfer.length?s("div",e._l(e.serviceTransfer,(function(t,a){return s("div",{key:a},[e.serverFilter(t).key?s("p",[s("span",{staticStyle:{display:"inline-block","min-width":"150px"}},[e._v("\n                "+e._s(e.serverFilter(t).key)+"：\n              ")]),s("span",[e._v(" "+e._s(e.serviceInfo[t]))])]):e._e()])})),0):e._e(),s("div",[s("p",{staticStyle:{margin:"10px 0 0"}},[e._v("套餐包含其他服务：")]),e._l(e.serviceInfo.service_items,(function(t,a){return s("span",{key:"service_items"+a},[e._v("\n            "+e._s(t))])}))],2)])]),s("i",{staticClass:"el-icon-info"})]),s("div",[e._v("\n    服务有效期：\n    "+e._s(e.formatTime(e.serviceInfo.started_at,"{y}-{m}-{d}")||"无")+"到"+e._s(e.formatTime(e.serviceInfo.ended_at,"{y}-{m}-{d}")||"无")+"\n  ")])],1):e._e()},y=[],_={props:{serviceInfo:{type:Object,default:function(){}},fdProduct:{type:Object,default:function(){}},department:{type:String,default:"erke"}},data:function(){return{serviceTransferNull:!0,serviceTransfer:[]}},created:function(){this.getServiceByDepartment()},watch:{department:function(e){this.getServiceByDepartment()}},methods:{getServiceByDepartment:function(){"chanke"===this.department?this.serviceTransfer=["total","month","common_text_total","common_text_month","common_voice_total","common_voice_month"]:"erke"===this.department&&(this.serviceTransfer=["total","month","doctor_text_total","doctor_text_month","dietician_text_total","dietician_text_month","doctor_voice_month","doctor_voice_total"])},serverFilter:function(e){var t={key:""};switch(e){case"total":"chanke"===this.department?t.key="产科医生咨询总次数":t.key="咨询总次数";break;case"month":"chanke"===this.department?t.key="本月产科医生咨询次数":t.key="本月咨询次数";break;case"doctor_text_total":t.key="图文转诊医生总次数";break;case"doctor_text_month":t.key="本月图文转诊医生次数";break;case"dietician_text_total":t.key="图文转诊营养师总次数";break;case"dietician_text_month":t.key="本月图文转诊营养师次数";break;case"doctor_voice_month":t.key="本月电话转诊医生次数";break;case"doctor_voice_total":t.key="电话转诊医生总次数";break;case"common_text_total":t.key="图文转诊其他医生总次数";break;case"common_text_month":t.key="本月图文转诊其他医生次数";break;case"common_voice_total":t.key="电话转诊其他医生总次数";break;case"common_voice_month":t.key="本月电话转诊其他医生次数";break;default:return t}return t}}},v=_,w=Object(p["a"])(v,b,y,!1,null,null,null),k=w.exports,x=s("ed08"),C={components:{BabyCard:g,ServiceInfo:k},props:{babyDetail:{type:Object,default:function(){}},department:{type:String,default:""},isShow:{type:Boolean,default:!1}},data:function(){return{showDetail:!1,pathName:window.location.pathname}},watch:{"babyDetail.is_asking":function(e){!0===e&&(this.showDetail=!0)},isShow:function(e){this.showDetail=e},activedBabyId:function(e,t){t===this.babyDetail.family_member._id&&this.saveDataToLocal(t,this.showDetail);var s=Object(x["i"])("babyInfo"+e);if(s){var a=JSON.parse(s);this.showDetail=a.showDetail}else this.showDetail=!1}},computed:Object(r["a"])({},Object(i["c"])(["activedBaby","activedBabyId"])),created:function(){this.babyDetail.is_asking&&(this.showDetail=!0),this.showDetail=this.isShow},methods:{saveDataToLocal:function(e,t){var s=e,a={babyId:s,showDetail:t,remark:""},n=JSON.stringify(a);Object(x["j"])("babyInfo"+s,n)},showDetailFun:function(){this.showDetail=!this.showDetail},handleBaby:function(e){if(!this.department){var t={clickTag:"baby",session_id:e.session_id,userId:"",babyId:e.family_member?e.family_member._id:""};this.$store.dispatch("setCustomerInfo",t)}}}},F=C,T=(s("6c2c"),Object(p["a"])(F,a,n,!1,null,null,null));t["a"]=T.exports},3056:function(e,t,s){"use strict";var a=s("2d64"),n=s.n(a);n.a},"31ce":function(e,t,s){},"33b7":function(e,t,s){"use strict";var a=s("3523"),n=s.n(a);n.a},"33eb":function(e,t,s){},3523:function(e,t,s){},"38e1":function(e,t,s){"use strict";var a=s("f60f"),n=s.n(a);n.a},"395b":function(e,t,s){},"3a00":function(e,t,s){},"3acd":function(e,t,s){"use strict";s.d(t,"i",(function(){return n})),s.d(t,"l",(function(){return r})),s.d(t,"m",(function(){return i})),s.d(t,"g",(function(){return o})),s.d(t,"a",(function(){return l})),s.d(t,"o",(function(){return c})),s.d(t,"d",(function(){return u})),s.d(t,"k",(function(){return d})),s.d(t,"f",(function(){return m})),s.d(t,"e",(function(){return h})),s.d(t,"h",(function(){return p})),s.d(t,"n",(function(){return f})),s.d(t,"c",(function(){return g})),s.d(t,"j",(function(){return b})),s.d(t,"b",(function(){return y}));var a=s("b775");function n(e){return Object(a["a"])({url:"/crm/customer/list",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/crm/user/list",method:"get",params:e})}function i(e){return Object(a["a"])({url:"/crm/user/".concat(e),method:"get",params:e})}function o(e){return Object(a["a"])({url:"/crm/customer/".concat(e,"/detail"),method:"get",params:e})}function l(e){return Object(a["a"])({url:"/crm/customer",method:"post",data:e})}function c(e,t){return Object(a["a"])({url:"/crm/customer/".concat(t,"/update"),method:"put",data:e})}function u(e,t){return Object(a["a"])({url:"/crm/customer/".concat(t,"/relative"),method:"put",data:e})}function d(e,t){return Object(a["a"])({url:"/crm/customer/".concat(e,"/orders"),method:"get",params:t})}function m(e){return Object(a["a"])({url:"/crm/customer/".concat(e,"/brief_info"),method:"get"})}function h(e,t){return Object(a["a"])({url:"/crm/customer/".concat(e,"/path"),method:"post",data:t})}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a["a"])({url:"/crm/customer/".concat(e,"/path/list"),method:"get",params:t})}function f(){return Object(a["a"])({url:"/crm/basic/customer/supervisor/options",method:"get"})}function g(e){return Object(a["a"])({url:"/crm/customer/change_supervisor",method:"put",data:e})}function b(e){return Object(a["a"])({url:"/crm/customer/".concat(e,"/creator_options"),method:"get"})}function y(e){return Object(a["a"])({url:"/crm/customer/".concat(e,"/cancel_relative"),method:"put"})}},"3bc1":function(e,t,s){"use strict";var a=s("2c79"),n=s.n(a);n.a},"3f52":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"customer-info"},["chat"!==e.pageType?s("div",[s("p",{staticClass:"color-black margin-right-10 margin-bottom-10"},[e._v("用户信息")])]):e._e(),s("el-row",{staticClass:"clearfix",attrs:{type:"flex",justify:"space-between"}},[s("el-col",{attrs:{span:"chat"===e.pageType?6:3}},[s("el-avatar",{key:e.user.user_id,attrs:{size:"large",src:e.user.avatar}})],1),s("el-col",{attrs:{span:"chat"===e.pageType?14:15}},[e.remarkEditable?s("input",{directives:[{name:"model",rawName:"v-model",value:e.remarkName,expression:"remarkName"},{name:"myfocus",rawName:"v-myfocus"}],staticStyle:{width:"100px"},domProps:{value:e.remarkName},on:{blur:e.onRemarkBlur,input:function(t){t.target.composing||(e.remarkName=t.target.value)}}}):s("div",{staticStyle:{"font-size":"14px",color:"#17233D"},attrs:{title:e.edit&&"hm"===e.role?"双击修改备注名":""},on:{dblclick:function(t){return e.editRemark(e.user)}}},[s("span",[e._v("\n          "+e._s(e.user.name||"-")+"\n        ")])]),s("el-row",[s("span",{staticClass:"span-key"},[e._v("ID：")]),s("span",{staticClass:"span-val"},[e._v(e._s(e.user.user_id||"-"))])])],1),s("el-col",{attrs:{span:4}},[s("my-copy",{staticClass:"float-right",attrs:{copyKey:e.user.name}}),s("my-copy",{staticClass:"float-right",attrs:{copyKey:e.user.user_id}})],1)],1),s("el-row",{staticStyle:{margin:"6px 0"},attrs:{type:"flex",justify:"space-between"}},[s("el-col",{attrs:{span:18}},[s("span",{staticClass:"span-key"},[e._v("昵称：")]),e._v(e._s(e.user.nickname||e.user.nick_name||"-")+"\n    ")]),s("my-copy",{staticClass:"float-right",style:"chat"!==e.pageType?"margin-right:11px":"",attrs:{copyKey:e.user.nickname||e.user.nick_name}})],1),s("el-row",[s("div",[s("span",{staticClass:"add_remark_btn",class:"hm"!==e.role?"notAllow":"",on:{click:e.showAddTextareaFun}},[e._v(e._s(e.tipContent)+"备注（最多50字）")])]),e.haveRemark&&!e.showAddTextarea?s("div",[e.remark?s("p",{staticClass:"remark_text"},[e._v(e._s(e.remark))]):e._e(),e.user.remark&&e.user.remark.created_at?s("p",{staticClass:"created_at"},[e._v("\n        "+e._s(e.formatTime(e.user.remark.created_at))+"\n      ")]):e._e()]):e._e(),e.showAddTextarea?s("div",{staticClass:"clearfix"},[s("el-input",{attrs:{type:"textarea",rows:"3",maxlength:"50","show-word-limit":"","aria-placeholder":"请填写备注信息"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),s("el-button",{staticClass:"float-right margin-top-10",attrs:{type:"primary",size:"mini"},on:{click:e.saveRemarkFun}},[e._v("保存")])],1):e._e()])],1)},n=[],r=(s("7f7f"),s("96cf"),s("3b8d")),i=s("db72"),o=s("2f62"),l=s("802d"),c=s("18e9"),u={name:"UserInfo",props:{user:{type:Object,default:function(){}},pageType:{type:String,default:"chat"}},data:function(){return{showAddTextarea:!1,tipContent:"",remark:"",haveRemark:"",remarkEditable:!1,remarkName:"",edit:!0}},components:{MyCopy:c["a"]},computed:Object(i["a"])({},Object(o["c"])(["role","userInfo","activedUserId"])),watch:{role:function(){this.edit="hm"===this.role},user:function(e){this.remark=e&&e.remark?e.remark.content:"",this.haveRemark=e&&e.remark?e.remark.content:"",this.tipContent=this.haveRemark?"修改":"添加",this.hideAddTextareaFun();var t=window.localStorage.getItem("editStatus"+this.activedUserId),s=window.localStorage.getItem("user"+this.activedUserId+"remark");!0===t&&(this.showAddTextareaFun(),this.remark=s)},showAddTextarea:function(e){e?(window.localStorage.setItem("editStatus"+this.activedUserId,e),window.localStorage.setItem("user"+this.activedUserId+"remark",this.remark)):(window.localStorage.removeItem("editStatus"+this.activedUserId),window.localStorage.removeItem("user"+this.activedUserId+"remark"))}},created:function(){},methods:{changeChatUserRemarkFun:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={remark:t?"":this.remark,remark_name:t||""},e.next=3,Object(l["b"])(this.user._id,s);case 3:a=e.sent,n=a.data,this.$message({type:n.result?"success":"error",message:n.result?"保存成功":n.message}),n&&n.result&&(t||(this.hideAddTextareaFun(),this.haveRemark=!0,this.tipContent="修改"),-1!==this.$route.path.indexOf("diagnose")&&this.$store.dispatch("chat/getActivedUserInfo"),this.$emit("updateInfo"));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showAddTextareaFun:function(){"hm"===this.role&&(this.showAddTextarea=!0)},hideAddTextareaFun:function(){this.showAddTextarea=!1},saveRemarkFun:function(){this.remark?this.changeChatUserRemarkFun():this.$message({type:"warning",message:"备注不能为空"})},editRemark:function(e){"hm"===this.role&&this.edit&&(this.remarkEditable=!0,this.remarkName=e.name)},onRemarkBlur:function(){this.remarkEditable=!1,this.changeChatUserRemarkFun(this.remarkName)}}},d=u,m=(s("6068"),s("2877")),h=Object(m["a"])(d,a,n,!1,null,"01fd87a9",null);t["a"]=h.exports},"408a":function(e,t,s){},4398:function(e,t,s){"use strict";var a=s("3a00"),n=s.n(a);n.a},"4a43":function(e,t,s){},"4b77":function(e,t,s){},"4d15":function(e,t,s){},"4dce":function(e,t,s){"use strict";var a=s("0e79"),n=s.n(a);n.a},"4ed2":function(e,t,s){"use strict";var a=s("c50f"),n=s.n(a);n.a},"504c":function(e,t,s){var a=s("9e1e"),n=s("0d58"),r=s("6821"),i=s("52a7").f;e.exports=function(e){return function(t){var s,o=r(t),l=n(o),c=l.length,u=0,d=[];while(c>u)s=l[u++],a&&!i.call(o,s)||d.push(e?[s,o[s]]:o[s]);return d}}},5118:function(e,t,s){(function(e){var a="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,n=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(n.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new r(n.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},s("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,s("24aa"))},"51d8":function(e,t,s){},52337:function(e,t,s){"use strict";var a=s("7182"),n=s.n(a);n.a},"529f":function(e,t,s){"use strict";var a=s("51d8"),n=s.n(a);n.a},"542e":function(e,t,s){},"567c":function(e,t,s){"use strict";var a=s("1840"),n=s.n(a);n.a},"57ee":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"file-detail"},[!e.babyId||e.isChatPage?s("div",{staticClass:"baby-info"},[s("el-avatar",{attrs:{size:32,src:e.babyInfo.user&&e.babyInfo.avatar}}),s("span",{staticClass:"user-name"},[e._v("用户： "+e._s(e.babyInfo.user.name)+"  "),e.replace?s("svg-icon",{attrs:{"icon-class":"replace"}}):e._e()],1),s("span",{staticClass:"baby-name"},[e._v("宝宝： "+e._s(e.babyInfo.name))])],1):e._e(),s("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"新生儿基本信息",name:"first"}},[s("newborn",{attrs:{isMyUser:e.isMyUser,isChatPage:e.isChatPage,newborn:e.newborn,"baby-info":e.babyInfo,"baby-id":!!e.babyId}})],1),s("el-tab-pane",{attrs:{label:"母亲孕期情况",name:"second"}},[s("pregnancy-situation",{attrs:{isMyUser:e.isMyUser,pregnancy:e.pregnancy,"baby-id":!!e.babyId}})],1),s("el-tab-pane",{attrs:{label:"家庭个人资料",name:"third"}},[s("personal-information",{attrs:{isMyUser:e.isMyUser,person:e.person,"baby-id":!!e.babyId}})],1)],1)],1)},n=[],r=(s("96cf"),s("3b8d")),i=s("db72"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"newbornForm",staticClass:"demo-newbornForm newborn-form",attrs:{model:e.newbornForm,rules:e.rules,"label-width":"110px"}},[e.babyId?e._e():s("el-form-item",{attrs:{label:"宝宝乳名：",prop:"name"}},[s("el-input",{attrs:{maxlength:"5","show-word-limit":"",placeholder:"请输入"},model:{value:e.newbornForm.name,callback:function(t){e.$set(e.newbornForm,"name",t)},expression:"newbornForm.name"}})],1),s("el-form-item",{attrs:{label:"宝宝性别：",prop:"gender"}},[s("el-radio-group",{model:{value:e.newbornForm.gender,callback:function(t){e.$set(e.newbornForm,"gender",t)},expression:"newbornForm.gender"}},[s("el-radio",{attrs:{label:"1"}},[e._v("男")]),s("el-radio",{attrs:{label:"2"}},[e._v("女")])],1)],1),s("el-form-item",{attrs:{label:"民族：",prop:"famous"}},[s("el-input",{attrs:{maxlength:"10","show-word-limit":"",placeholder:"请输入"},model:{value:e.newbornForm.famous,callback:function(t){e.$set(e.newbornForm,"famous",t)},expression:"newbornForm.famous"}})],1),s("el-form-item",{attrs:{label:"出生日期：",prop:"birthday"}},[s("el-input",{attrs:{disabled:""},model:{value:e.newbornForm.birthday,callback:function(t){e.$set(e.newbornForm,"birthday",t)},expression:"newbornForm.birthday"}})],1),s("el-form-item",{attrs:{label:"宝宝月龄：",prop:"monthAge"}},[s("el-input",{attrs:{disabled:""},model:{value:e.newbornForm.monthAge,callback:function(t){e.$set(e.newbornForm,"monthAge",t)},expression:"newbornForm.monthAge"}})],1),s("el-form-item",{attrs:{label:"预产期：",prop:"pregnancy_ended_at"}},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:e.getAgeMonth},model:{value:e.newbornForm.pregnancy_ended_at,callback:function(t){e.$set(e.newbornForm,"pregnancy_ended_at",t)},expression:"newbornForm.pregnancy_ended_at"}})],1),s("el-form-item",{attrs:{label:"出生孕周：",prop:"csyz"}},[s("el-input",{attrs:{placeholder:"请输入0-42的整数"},on:{input:function(t){return e.getNewNum(t,"gestational_weeks")},keyup:function(e){return e.replace(/^(0+)|[^\d]+/g,"")}},model:{value:e.newbornForm.gestational_weeks,callback:function(t){e.$set(e.newbornForm,"gestational_weeks",t)},expression:"newbornForm.gestational_weeks"}}),e._v("   周   \n    "),s("el-input",{attrs:{placeholder:"请输入0-6的整数"},on:{input:function(t){return e.getNewNum(t,"gestational_days")},keyup:function(e){return e.replace(/^(0+)|[^\d]+/g,"")}},model:{value:e.newbornForm.gestational_days,callback:function(t){e.$set(e.newbornForm,"gestational_days",t)},expression:"newbornForm.gestational_days"}}),e._v("   天\n  ")],1),s("el-form-item",{attrs:{label:"是否早产：",prop:"sfzc"}},[s("el-radio-group",{model:{value:e.newbornForm.sfzc,callback:function(t){e.$set(e.newbornForm,"sfzc",t)},expression:"newbornForm.sfzc"}},[s("el-radio",{attrs:{label:"否"}}),s("el-radio",{attrs:{label:"是"}})],1),"是"===e.newbornForm.sfzc?s("el-form",{staticClass:"demo-newbornForm",staticStyle:{"margin-top":"20px"},attrs:{model:e.newbornForm,rules:e.rules,"label-width":"180px"}},[s("el-form-item",{staticClass:"m-b-20",attrs:{label:"矫正月龄：",prop:"jzyl"}},[s("el-input",{attrs:{disabled:""},model:{value:e.newbornForm.jzyl,callback:function(t){e.$set(e.newbornForm,"jzyl",t)},expression:"newbornForm.jzyl"}})],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"住院天数：",prop:"zyts"}},[s("el-input",{attrs:{placeholder:"请输入自然数"},on:{input:function(t){return e.getNewNum(t,"zyts")},keyup:function(e){return e.replace(/^(0+)|[^\d]+/g,"")}},model:{value:e.newbornForm.zyts,callback:function(t){e.$set(e.newbornForm,"zyts",t)},expression:"newbornForm.zyts"}})],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"住院时是否静脉营养：",prop:"sfjmyy"}},[s("el-radio-group",{model:{value:e.newbornForm.sfjmyy,callback:function(t){e.$set(e.newbornForm,"sfjmyy",t)},expression:"newbornForm.sfjmyy"}},[s("el-radio",{attrs:{label:"否"}}),s("el-radio",{attrs:{label:"是"}})],1),"是"===e.newbornForm.sfjmyy?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"sfjmyyDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.sfjmyyDescription,callback:function(t){e.$set(e.newbornForm,"sfjmyyDescription",t)},expression:"newbornForm.sfjmyyDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"是否使用呼吸机：",prop:"sfsyhxj"}},[s("el-radio-group",{model:{value:e.newbornForm.sfsyhxj,callback:function(t){e.$set(e.newbornForm,"sfsyhxj",t)},expression:"newbornForm.sfsyhxj"}},[s("el-radio",{attrs:{label:"否"}}),s("el-radio",{attrs:{label:"是"}})],1),"是"===e.newbornForm.sfsyhxj?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"sfsyhxjDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.sfsyhxjDescription,callback:function(t){e.$set(e.newbornForm,"sfsyhxjDescription",t)},expression:"newbornForm.sfsyhxjDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",staticStyle:{"max-width":"980px"},attrs:{label:"眼底筛查结果：",prop:"ydscjg"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.ydscjg,callback:function(t){e.$set(e.newbornForm,"ydscjg",t)},expression:"newbornForm.ydscjg"}}),s("div",{staticClass:"upload-image"},[e.newbornForm.imageUrl?s("div",{staticClass:"img"},[s("img",{attrs:{width:"100%",height:"100%",src:e.newbornForm.imageUrl,alt:"筛查结果"}}),s("i",{staticClass:"el-icon-error",on:{click:function(t){e.newbornForm.imageUrl=""}}})]):s("div",{staticClass:"img-box"},[s("i",{staticClass:"el-icon-circle-plus-outline"}),s("p",[e._v("上传图片")])])]),s("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.uploadFunc,"before-upload":e.beforeAvatarUpload,"show-file-list":!1}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")])],1)],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"晶状体后纤维增生性眼病：",prop:"jzthxwzsxyb"}},[s("el-radio-group",{model:{value:e.newbornForm.jzthxwzsxyb,callback:function(t){e.$set(e.newbornForm,"jzthxwzsxyb",t)},expression:"newbornForm.jzthxwzsxyb"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1)],1),s("el-form-item",{staticStyle:{"margin-top":"20px","max-width":"980px"},attrs:{label:"其它：",prop:"sfzcOther"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.sfzcOther,callback:function(t){e.$set(e.newbornForm,"sfzcOther",t)},expression:"newbornForm.sfzcOther"}})],1)],1):e._e()],1),s("el-form-item",{attrs:{label:"宝宝胎数：",prop:"bbts"}},[s("el-radio-group",{model:{value:e.newbornForm.bbts,callback:function(t){e.$set(e.newbornForm,"bbts",t)},expression:"newbornForm.bbts"}},[s("el-radio",{attrs:{label:"一胎"}}),s("el-radio",{attrs:{label:"二胎"}}),s("el-radio",{attrs:{label:"多胎"}})],1)],1),s("el-form-item",{attrs:{label:"出生体重：",prop:"cstz"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,"tz")},blur:function(t){return e.toFixedNum(t,"tz")},change:function(t){return e.toFixedNum(t,"tz")}},model:{value:e.newbornForm.cstz,callback:function(t){e.$set(e.newbornForm,"cstz",t)},expression:"newbornForm.cstz"}}),e._v("   kg\n  ")],1),s("el-form-item",{attrs:{label:"出生身长：",prop:"cssc"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,"sc")},blur:function(t){return e.toFixedNum(t,"tz")},change:function(t){return e.toFixedNum(t,"sc")}},model:{value:e.newbornForm.cssc,callback:function(t){e.$set(e.newbornForm,"cssc",t)},expression:"newbornForm.cssc"}}),e._v("   cm\n  ")],1),s("el-form-item",{attrs:{label:"出身头围：",prop:"cstw"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,"tw")},blur:function(t){return e.toFixedNum(t,"tz")},change:function(t){return e.toFixedNum(t,"tw")}},model:{value:e.newbornForm.cstw,callback:function(t){e.$set(e.newbornForm,"cstw",t)},expression:"newbornForm.cstw"}}),e._v("   cm\n  ")],1),s("el-form-item",{attrs:{label:"出生有无异常：",prop:"csywyc"}},[s("el-radio-group",{model:{value:e.newbornForm.csywyc,callback:function(t){e.$set(e.newbornForm,"csywyc",t)},expression:"newbornForm.csywyc"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.csywyc?s("el-form",{staticClass:"demo-newbornForm",staticStyle:{"margin-top":"20px"},attrs:{model:e.newbornForm,rules:e.rules,"label-width":"170px"}},[s("el-form-item",{staticClass:"m-b-20",attrs:{label:"Apgar评分：",prop:"apgar"}},[s("p",{staticClass:"minute"},[e._v("\n          1分钟   "),s("el-input",{attrs:{placeholder:"请输入正整数"},on:{input:function(t){return e.getInteger(t,"one")},keyup:function(e){return e.replace(/^(0+)|[^\d]+/g,"")}},model:{value:e.newbornForm.apgar.one,callback:function(t){e.$set(e.newbornForm.apgar,"one",t)},expression:"newbornForm.apgar.one"}})],1),s("p",{staticClass:"minute"},[e._v("\n          5分钟   "),s("el-input",{attrs:{placeholder:"请输入正整数"},on:{input:function(t){return e.getInteger(t,"five")},keyup:function(e){return e.replace(/^(0+)|[^\d]+/g,"")}},model:{value:e.newbornForm.apgar.five,callback:function(t){e.$set(e.newbornForm.apgar,"five",t)},expression:"newbornForm.apgar.five"}})],1),s("p",{staticClass:"minute"},[e._v("\n          10分钟   "),s("el-input",{attrs:{placeholder:"请输入正整数"},on:{input:function(t){return e.getInteger(t,"ten")},keyup:function(e){return e.replace(/^(0+)|[^\d]+/g,"")}},model:{value:e.newbornForm.apgar.ten,callback:function(t){e.$set(e.newbornForm.apgar,"ten",t)},expression:"newbornForm.apgar.ten"}})],1)]),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"生后窒息：",prop:"shzx"}},[s("el-radio-group",{model:{value:e.newbornForm.shzx,callback:function(t){e.$set(e.newbornForm,"shzx",t)},expression:"newbornForm.shzx"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.shzx?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"程度：",prop:"shzxcd"}},[s("el-radio-group",{model:{value:e.newbornForm.shzxcd,callback:function(t){e.$set(e.newbornForm,"shzxcd",t)},expression:"newbornForm.shzxcd"}},[s("el-radio",{attrs:{label:"轻"}}),s("el-radio",{attrs:{label:"中"}}),s("el-radio",{attrs:{label:"重度"}})],1)],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"颅内出血：",prop:"lncx"}},[s("el-radio-group",{model:{value:e.newbornForm.lncx,callback:function(t){e.$set(e.newbornForm,"lncx",t)},expression:"newbornForm.lncx"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.lncx?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"程度：",prop:"lncxcd"}},[s("el-radio-group",{model:{value:e.newbornForm.lncxcd,callback:function(t){e.$set(e.newbornForm,"lncxcd",t)},expression:"newbornForm.lncxcd"}},[s("el-radio",{attrs:{label:"轻"}}),s("el-radio",{attrs:{label:"中"}}),s("el-radio",{attrs:{label:"重度"}})],1)],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"宫内窘迫：",prop:"gnjp"}},[s("el-radio-group",{model:{value:e.newbornForm.gnjp,callback:function(t){e.$set(e.newbornForm,"gnjp",t)},expression:"newbornForm.gnjp"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1)],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"新生儿黄疸：",prop:"xsehd"}},[s("el-radio-group",{model:{value:e.newbornForm.xsehd,callback:function(t){e.$set(e.newbornForm,"xsehd",t)},expression:"newbornForm.xsehd"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.xsehd?[s("el-form-item",{staticClass:"description-way",staticStyle:{"margin-top":"20px","max-width":"980px"},attrs:{label:"诊断方法：",prop:"hdzdff"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.hdzdff,callback:function(t){e.$set(e.newbornForm,"hdzdff",t)},expression:"newbornForm.hdzdff"}})],1),s("el-form-item",{staticClass:"description-way",staticStyle:{"margin-top":"20px","max-width":"980px"},attrs:{label:"治疗方法：",prop:"hdzlff"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.hdzlff,callback:function(t){e.$set(e.newbornForm,"hdzlff",t)},expression:"newbornForm.hdzlff"}})],1)]:e._e()],2),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"呼吸窘迫综合征(RDS)：",prop:"RDS"}},[s("el-radio-group",{model:{value:e.newbornForm.RDS,callback:function(t){e.$set(e.newbornForm,"RDS",t)},expression:"newbornForm.RDS"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1)],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"贫血：",prop:"anemia"}},[s("el-radio-group",{model:{value:e.newbornForm.anemia,callback:function(t){e.$set(e.newbornForm,"anemia",t)},expression:"newbornForm.anemia"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.anemia?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"anemiaDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.anemiaDescription,callback:function(t){e.$set(e.newbornForm,"anemiaDescription",t)},expression:"newbornForm.anemiaDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"惊厥：",prop:"horror"}},[s("el-radio-group",{model:{value:e.newbornForm.horror,callback:function(t){e.$set(e.newbornForm,"horror",t)},expression:"newbornForm.horror"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.horror?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"horrorDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.horrorDescription,callback:function(t){e.$set(e.newbornForm,"horrorDescription",t)},expression:"newbornForm.horrorDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"感染：",prop:"infection"}},[s("el-radio-group",{model:{value:e.newbornForm.infection,callback:function(t){e.$set(e.newbornForm,"infection",t)},expression:"newbornForm.infection"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.infection?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"infectionDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.infectionDescription,callback:function(t){e.$set(e.newbornForm,"infectionDescription",t)},expression:"newbornForm.infectionDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"出生缺陷：",prop:"csqx"}},[s("el-radio-group",{model:{value:e.newbornForm.csqx,callback:function(t){e.$set(e.newbornForm,"csqx",t)},expression:"newbornForm.csqx"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.newbornForm.csqx?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"csqxDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.csqxDescription,callback:function(t){e.$set(e.newbornForm,"csqxDescription",t)},expression:"newbornForm.csqxDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"听力筛查：",prop:"tlsc"}},[s("el-radio-group",{model:{value:e.newbornForm.tlsc,callback:function(t){e.$set(e.newbornForm,"tlsc",t)},expression:"newbornForm.tlsc"}},[s("el-radio",{attrs:{label:"正常"}}),s("el-radio",{attrs:{label:"异常"}})],1),"异常"===e.newbornForm.tlsc?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"tlscDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.tlscDescription,callback:function(t){e.$set(e.newbornForm,"tlscDescription",t)},expression:"newbornForm.tlscDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"新生儿筛查(足跟血)：",prop:"zgx"}},[s("el-radio-group",{model:{value:e.newbornForm.zgx,callback:function(t){e.$set(e.newbornForm,"zgx",t)},expression:"newbornForm.zgx"}},[s("el-radio",{attrs:{label:"正常"}}),s("el-radio",{attrs:{label:"异常"}})],1),"异常"===e.newbornForm.zgx?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"zgxDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.zgxDescription,callback:function(t){e.$set(e.newbornForm,"zgxDescription",t)},expression:"newbornForm.zgxDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",staticStyle:{"margin-top":"20px","max-width":"970px"},attrs:{label:"其它：",prop:"cswycOther"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.cswycOther,callback:function(t){e.$set(e.newbornForm,"cswycOther",t)},expression:"newbornForm.cswycOther"}})],1)],1):e._e()],1),s("el-form-item",{attrs:{label:"喂养方式：",prop:"wyfs"}},[s("el-checkbox-group",{model:{value:e.newbornForm.wyfs,callback:function(t){e.$set(e.newbornForm,"wyfs",t)},expression:"newbornForm.wyfs"}},[s("el-checkbox",{attrs:{label:"母乳",name:"mr"}}),s("el-checkbox",{attrs:{label:"母乳+强化剂",name:"mrqhj"}}),s("el-checkbox",{attrs:{label:"配方奶粉",name:"pfnf"}}),s("el-checkbox",{attrs:{label:"混合喂养",name:"hhwy"}}),s("el-checkbox",{attrs:{label:"辅食",name:"fs"}})],1),s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"wyfsDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.wyfsDescription,callback:function(t){e.$set(e.newbornForm,"wyfsDescription",t)},expression:"newbornForm.wyfsDescription"}})],1)],1),s("el-form-item",{attrs:{label:"疫苗接种：",prop:"ymjz"}},[s("el-radio-group",{model:{value:e.newbornForm.ymjz,callback:function(t){e.$set(e.newbornForm,"ymjz",t)},expression:"newbornForm.ymjz"}},[s("el-radio",{attrs:{label:"按时"}}),s("el-radio",{attrs:{label:"未按时"}})],1),s("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"请上传疫苗本：",prop:"uploadVaccine"}},[s("div",{staticClass:"upload-image-list"},[e._l(e.newbornForm.imageUrlList,(function(t,a){return s("div",{key:a,staticClass:"img"},[s("img",{attrs:{width:"100%",height:"100%",src:t,alt:"疫苗本"}}),s("i",{staticClass:"el-icon-error",on:{click:function(t){return e.removeImg(a)}}})])})),s("div",{staticClass:"img-box"},[s("i",{staticClass:"el-icon-circle-plus-outline"}),s("p",[e._v("最多10张")])])],2),s("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.uploadListFunc,"before-upload":e.beforeAvatarUpload,"show-file-list":!1}},[s("el-button",{attrs:{size:"small",type:"primary",disabled:e.newbornForm.imageUrlList.length>=10}},[e._v("上传图片")])],1),"未按时"===e.newbornForm.ymjz?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"ymjzDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.newbornForm.ymjzDescription,callback:function(t){e.$set(e.newbornForm,"ymjzDescription",t)},expression:"newbornForm.ymjzDescription"}})],1):e._e()],1)],1),!e.babyId||e.isMyUser?s("el-form-item",{staticClass:"confirm"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("newbornForm")}}},[e._v("修改并保存")])],1):e._e()],1)},l=[],c=(s("c5f6"),s("7f7f"),s("91b6")),u=s("7b1f"),d={props:{newborn:{type:[Object,String],default:""},babyInfo:{type:[Object,String],default:""},babyId:{type:Boolean,default:!1},isMyUser:{type:Boolean,default:!1},isChatPage:{type:Boolean,default:!1}},data:function(){return{newbornForm:{name:"",gender:"",famous:"",birthday:"",monthAge:"",pregnancy_ended_at:"",gestational_weeks:"",gestational_days:"",sfzc:"",jzyl:"",zyts:"",sfjmyy:"",sfjmyyDescription:"",sfsyhxj:"",sfsyhxjDescription:"",ydscjg:"",jzthxwzsxyb:"",sfzcOther:"",bbts:"",cstz:"",cssc:"",cstw:"",csywyc:"",apgar:{one:"",five:"",ten:""},shzx:"",shzxcd:"",lncx:"",lncxcd:"",gnjp:"",xsehd:"",hdzdff:"",hdzlff:"",RDS:"",anemia:"",anemiaDescription:"",horror:"",horrorDescription:"",infection:"",infectionDescription:"",csqx:"",csqxDescription:"",tlsc:"",tlscDescription:"",zgx:"",zgxDescription:"",cswycOther:"",wyfs:[],wyfsDescription:"",ymjz:"",ymjzDescription:"",imageUrl:"",imageUrlList:[]},rules:{name:[{required:!0,message:"请输入宝宝姓名",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}]}}},watch:{newborn:function(){this.newborn&&(this.newbornForm={name:this.newborn.name||"",gender:this.newborn.gender||"",famous:this.newborn.famous||"",birthday:this.newborn.birthday||"",monthAge:this.newborn.monthAge||"",pregnancy_ended_at:this.newborn.pregnancy_ended_at||"",gestational_weeks:this.babyInfo.gestational_weeks||this.newborn.gestational_weeks,gestational_days:this.babyInfo.gestational_days||this.newborn.gestational_days,sfzc:this.newborn.sfzc||"",jzyl:this.newborn.jzyl||"",zyts:this.newborn.zyts||"",sfjmyy:this.newborn.sfjmyy||"",sfjmyyDescription:this.newborn.sfjmyyDescription||"",sfsyhxj:this.newborn.sfsyhxj||"",sfsyhxjDescription:this.newborn.sfsyhxjDescription||"",ydscjg:this.newborn.ydscjg||"",jzthxwzsxyb:this.newborn.jzthxwzsxyb||"",sfzcOther:this.newborn.sfzcOther||"",bbts:this.newborn.bbts||"",cstz:this.newborn.cstz||"",cssc:this.newborn.cssc||"",cstw:this.newborn.cstw||"",csywyc:this.newborn.csywyc||"",apgar:{one:this.newborn.apgar?this.newborn.apgar.one:"",five:this.newborn.apgar?this.newborn.apgar.five:"",ten:this.newborn.apgar?this.newborn.apgar.ten:""},shzx:this.newborn.shzx||"",shzxcd:this.newborn.shzxcd||"",lncx:this.newborn.lncx||"",lncxcd:this.newborn.lncxcd||"",gnjp:this.newborn.gnjp||"",xsehd:this.newborn.xsehd||"",hdzdff:this.newborn.hdzdff||"",hdzlff:this.newborn.hdzlff||"",RDS:this.newborn.RDS||"",anemia:this.newborn.anemia||"",anemiaDescription:this.newborn.anemiaDescription||"",horror:this.newborn.horror||"",horrorDescription:this.newborn.horrorDescription||"",infection:this.newborn.infection||"",infectionDescription:this.newborn.infectionDescription||"",csqx:this.newborn.csqx||"",csqxDescription:this.newborn.csqxDescription||"",tlsc:this.newborn.tlsc||"",tlscDescription:this.newborn.tlscDescription||"",zgx:this.newborn.zgx||"",zgxDescription:this.newborn.zgxDescription||"",cswycOther:this.newborn.cswycOther||"",wyfs:this.newborn.wyfs||[],wyfsDescription:this.newborn.wyfsDescription||"",ymjz:this.newborn.ymjz||"",ymjzDescription:this.newborn.ymjzDescription||"",imageUrl:this.newborn.imageUrl||"",imageUrlList:this.newborn.imageUrlList||[]}),this.newbornForm.pregnancy_ended_at&&this.getAgeMonth({day:this.newbornForm.pregnancy_ended_at})},babyInfo:function(){this.babyInfo&&(this.newbornForm.birthday=this.babyInfo.birthday?this.formatTime(this.babyInfo.birthday,"{y}-{m}-{d}"):"",this.newbornForm.monthAge=this.babyInfo.age_of_month,this.newbornForm.name=this.babyInfo.name,this.newbornForm.gender=this.babyInfo.gender+"")}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(s){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s){e.next=22;break}return"否"===t.newbornForm.sfzc&&(t.newbornForm.jzyl="",t.newbornForm.zyts="",t.newbornForm.sfjmyy="",t.newbornForm.sfjmyyDescription="",t.newbornForm.sfsyhxj="",t.newbornForm.sfsyhxjDescription="",t.newbornForm.ydscjg="",t.newbornForm.jzthxwzsxyb="",t.newbornForm.sfzcOther="",t.newbornForm.imageUrl=""),"否"===t.newbornForm.sfjmyy&&(t.newbornForm.sfjmyyDescription=""),"否"===t.newbornForm.sfsyhxj&&(t.newbornForm.sfsyhxjDescription=""),"无"===t.newbornForm.csywyc&&(t.newbornForm.apgar={one:"",five:"",ten:""},t.newbornForm.shzx="",t.newbornForm.shzxcd="",t.newbornForm.lncx="",t.newbornForm.lncxcd="",t.newbornForm.gnjp="",t.newbornForm.xsehd="",t.newbornForm.hdzdff="",t.newbornForm.hdzlff="",t.newbornForm.RDS="",t.newbornForm.anemia="",t.newbornForm.anemiaDescription="",t.newbornForm.horror="",t.newbornForm.horrorDescription="",t.newbornForm.infection="",t.newbornForm.infectionDescription="",t.newbornForm.csqx="",t.newbornForm.csqxDescription="",t.newbornForm.tlsc="",t.newbornForm.tlscDescription="",t.newbornForm.zgx="",t.newbornForm.zgxDescription="",t.newbornForm.cswycOther=""),"无"===t.newbornForm.shzx&&(t.newbornForm.shzxcd=""),"无"===t.newbornForm.lncx&&(t.newbornForm.lncxcd=""),"无"===t.newbornForm.xsehd&&(t.newbornForm.hdzdff="",t.newbornForm.hdzlff=""),"无"===t.newbornForm.anemia&&(t.newbornForm.anemiaDescription=""),"无"===t.newbornForm.horror&&(t.newbornForm.horrorDescription=""),"无"===t.newbornForm.infection&&(t.newbornForm.infectionDescription=""),"无"===t.newbornForm.csqx&&(t.newbornForm.csqxDescription=""),"异常"===t.newbornForm.tlsc&&(t.newbornForm.tlscDescription=""),"未按时"===t.newbornForm.ymjz&&(t.newbornForm.ymjzDescription=""),e.next=16,Object(u["y"])({baby_id:t.$route.params.id||t.$store.state.chat.activedBabyId,baby_detail_info:t.newbornForm});case 16:a=e.sent,n=a.data,r=a.code,2e4===r?n.result&&t.$message({type:"success",message:"保存成功"}):t.$message({message:n.message,type:"error"}),e.next=23;break;case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},setNumber:function(e,t){"tz"===t&&(Number(e)||(this.newbornForm.cstz="")),"sc"===t&&(Number(e)||(this.newbornForm.cssc="")),"tw"===t&&(Number(e)||(this.newbornForm.cstw=""))},toFixedNum:function(e,t){e&&("tz"===t&&Number(e)&&(this.newbornForm.cstz=Number(e).toFixed(1)),"sc"===t&&Number(e)&&(this.newbornForm.cssc=Number(e).toFixed(1)),"tw"===t&&Number(e)&&(this.newbornForm.cstw=Number(e).toFixed(1)))},uploadFunc:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.newbornForm.imageUrlList.length>=10||!this.isMyUser&&this.isChatPage)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(c["c"])(t.file,(function(e){}));case 4:s=e.sent,this.newbornForm.imageUrl=s.url;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),uploadListFunc:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(10!==this.newbornForm.imageUrlList.length&&(this.isMyUser||!this.isChatPage)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(c["c"])(t.file,(function(e){}));case 4:s=e.sent,this.newbornForm.imageUrlList.push(s.url);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),beforeAvatarUpload:function(e){if(this.isMyUser&&this.isChatPage&&this.newbornForm.imageUrlList.length<10||!this.isChatPage&&this.newbornForm.imageUrlList.length<10){var t=["image/jpeg","image/jpg","image/png"].indexOf(e.type)>=0,s=e.size/1024/1024<5;return t||this.$message.error("上传图片只能是 JPG或PNG 格式!"),s||this.$message.error("上传图片大小不能超过 5MB!"),t&&s}},removeImg:function(e){this.newbornForm.imageUrlList.splice(e,1)},getNewNum:function(e,t){parseInt(e)||0===parseInt(e)?"gestational_weeks"===t&&parseInt(e)>42?this.newbornForm[t]=42:"gestational_days"===t&&parseInt(e)>6?this.newbornForm[t]=6:this.newbornForm[t]=parseInt(e):this.newbornForm[t]=""},getInteger:function(e,t){"zyts"!==t||!parseInt(e)&&0!==parseInt(e)?parseInt(e)||0===parseInt(e)?this.newbornForm.apgar[t]=parseInt(e):this.newbornForm.apgar[t]="":this.newbornForm.zyts=parseInt(e)},getAgeMonth:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["j"])({day:this.newbornForm.pregnancy_ended_at});case 2:t=e.sent,s=t.code,a=t.data,2e4===s&&(this.newbornForm.jzyl=a.age_of_month_str);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},m=d,h=(s("33b7"),s("2877")),p=Object(h["a"])(m,o,l,!1,null,"777d4380",null),f=p.exports,g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"personal-information"},[s("el-form",{ref:"personForm",staticClass:"demo-personForm person-form",attrs:{model:e.personForm,rules:e.rules,"label-width":"130px"}},[e._l(e.personForm,(function(t,a){return[s("div",{key:a},[s("h2",{staticClass:"mother"},[e._v(e._s("mother"===a?"母亲":"父亲"))]),e.babyId?e._e():s("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[s("el-input",{attrs:{maxlength:"5","show-word-limit":"",placeholder:"请输入"},model:{value:t.name,callback:function(s){e.$set(t,"name",s)},expression:"item.name"}})],1),s("el-form-item",{attrs:{label:"出生日期：",prop:"birthday"}},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.birthday,callback:function(s){e.$set(t,"birthday",s)},expression:"item.birthday"}})],1),s("el-form-item",{attrs:{label:"民族：",prop:"famous"}},[s("el-input",{attrs:{maxlength:"10","show-word-limit":"",placeholder:"请输入"},model:{value:t.famous,callback:function(s){e.$set(t,"famous",s)},expression:"item.famous"}})],1),s("el-form-item",{attrs:{label:"身高：",prop:"height"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,a,"height")},change:function(t){return e.toFixedNum(t,a,"height")}},model:{value:t.height,callback:function(s){e.$set(t,"height",s)},expression:"item.height"}}),e._v("   kg\n        ")],1),s("el-form-item",{attrs:{label:"体重：",prop:"bodyWeight"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,a,"bodyWeight")},change:function(t){return e.toFixedNum(t,a,"bodyWeight")}},model:{value:t.bodyWeight,callback:function(s){e.$set(t,"bodyWeight",s)},expression:"item.bodyWeight"}}),e._v("   kg\n        ")],1),s("el-form-item",{attrs:{label:"血型：",prop:"bloodGroup"}},[s("el-input",{attrs:{placeholder:"请输入"},model:{value:t.bloodGroup,callback:function(s){e.$set(t,"bloodGroup",s)},expression:"item.bloodGroup"}}),e._v("   型\n        ")],1),s("el-form-item",{attrs:{label:"现居住地：",prop:"address"}},[s("el-cascader",{attrs:{size:"large",options:e.options},on:{change:e.handleChange},model:{value:t.address,callback:function(s){e.$set(t,"address",s)},expression:"item.address"}})],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"家族遗传史：",prop:"jzycs"}},[s("el-radio-group",{model:{value:t.jzycs,callback:function(s){e.$set(t,"jzycs",s)},expression:"item.jzycs"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===t.jzycs?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"jzycsDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:t.jzycsDescription,callback:function(s){e.$set(t,"jzycsDescription",s)},expression:"item.jzycsDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"既往史：",prop:"jws"}},[s("el-radio-group",{model:{value:t.jws,callback:function(s){e.$set(t,"jws",s)},expression:"item.jws"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===t.jws?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"jwsDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:t.jwsDescription,callback:function(s){e.$set(t,"jwsDescription",s)},expression:"item.jwsDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"烟酒嗜好：",prop:"yjsh"}},[s("el-radio-group",{model:{value:t.yjsh,callback:function(s){e.$set(t,"yjsh",s)},expression:"item.yjsh"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===t.yjsh?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"yjshDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:t.yjshDescription,callback:function(s){e.$set(t,"yjshDescription",s)},expression:"item.yjshDescription"}})],1):e._e()],1)],1)]})),!e.babyId||e.isMyUser?s("el-form-item",{staticClass:"confirm"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("personForm")}}},[e._v("修改并保存")])],1):e._e()],2)],1)},b=[],y=s("ef6c"),_={props:{person:{type:[Object,String],default:""},babyId:{type:Boolean,default:!1},isMyUser:{type:Boolean,default:!1}},data:function(){return{personForm:{mother:{title:"母亲",name:"",birthday:"",famous:"",height:"",bodyWeight:"",bloodGroup:"",address:[],jzycs:"",jzycsDescription:"",jws:"",jwsDescription:"",yjsh:"",yjshDescription:""},father:{title:"父亲",name:"",birthday:"",famous:"",height:"",bodyWeight:"",bloodGroup:"",address:[],jzycs:"",jzycsDescription:"",jws:"",jwsDescription:"",yjsh:"",yjshDescription:""}},rules:{},options:[{label:"国外",value:"国外"},{label:"国内",value:"国内",children:y["regionData"]}]}},watch:{person:function(){this.person.mother&&(this.personForm.mother=this.person.mother,this.personForm.father=this.person.father)}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(s){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s){e.next=15;break}return"无"===t.personForm.mother.jzycs&&(t.personForm.mother.jzycsDescription=""),"无"===t.personForm.mother.jws&&(t.personForm.mother.jwsDescription=""),"无"===t.personForm.mother.yjsh&&(t.personForm.mother.yjshDescription=""),"无"===t.personForm.father.jzycs&&(t.personForm.father.jzycsDescription=""),"无"===t.personForm.father.jws&&(t.personForm.father.jwsDescription=""),"无"===t.personForm.father.yjsh&&(t.personForm.father.yjshDescription=""),e.next=9,Object(u["y"])({baby_id:t.$route.params.id||t.$store.state.chat.activedBabyId,family_info:t.personForm});case 9:a=e.sent,n=a.data,r=a.code,2e4===r?n.result&&t.$message({type:"success",message:"保存成功"}):t.$message({message:n.message,type:"error"}),e.next=16;break;case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleChange:function(e){},setNumber:function(e,t,s){Number(e)||(this.personForm[t][s]="")},toFixedNum:function(e,t,s){e&&Number(e)&&(this.personForm[t][s]=Number(e).toFixed(1))}}},v=_,w=(s("5ae7"),Object(h["a"])(v,g,b,!1,null,"15a1c98a",null)),k=w.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"pregnancyForm",staticClass:"demo-pregnancyForm pregnancy-form",attrs:{model:e.pregnancyForm,rules:e.rules,"label-width":"110px"}},[s("el-form-item",{attrs:{label:"分娩方式：",prop:"fmfs"}},[s("el-radio-group",{model:{value:e.pregnancyForm.fmfs,callback:function(t){e.$set(e.pregnancyForm,"fmfs",t)},expression:"pregnancyForm.fmfs"}},[s("el-radio",{attrs:{label:"自然分娩"}}),s("el-radio",{attrs:{label:"剖宫产"}})],1),s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"fmfsDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.pregnancyForm.fmfsDescription,callback:function(t){e.$set(e.pregnancyForm,"fmfsDescription",t)},expression:"pregnancyForm.fmfsDescription"}})],1)],1),s("el-form-item",{attrs:{label:"羊水情况：",prop:"ysqk"}},[s("el-radio-group",{model:{value:e.pregnancyForm.ysqk,callback:function(t){e.$set(e.pregnancyForm,"ysqk",t)},expression:"pregnancyForm.ysqk"}},[s("el-radio",{attrs:{label:"清亮"}}),s("el-radio",{attrs:{label:"浑浊"}})],1)],1),s("el-form-item",{attrs:{label:"孕前体重：",prop:"yqtz"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,"yqtz")},change:function(t){return e.toFixedNum(t,"yqtz")}},model:{value:e.pregnancyForm.yqtz,callback:function(t){e.$set(e.pregnancyForm,"yqtz",t)},expression:"pregnancyForm.yqtz"}}),e._v("   kg\n  ")],1),s("el-form-item",{attrs:{label:"分娩时体重：",prop:"fmstz"}},[s("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.setNumber(t,"fmstz")},change:function(t){return e.toFixedNum(t,"fmstz")}},model:{value:e.pregnancyForm.fmstz,callback:function(t){e.$set(e.pregnancyForm,"fmstz",t)},expression:"pregnancyForm.fmstz"}}),e._v("   kg\n  ")],1),s("el-form-item",{attrs:{label:"孕期有无异常：",prop:"yqywyc"}},[s("el-radio-group",{model:{value:e.pregnancyForm.yqywyc,callback:function(t){e.$set(e.pregnancyForm,"yqywyc",t)},expression:"pregnancyForm.yqywyc"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.pregnancyForm.yqywyc?s("el-form",{staticClass:"demo-pregnancyForm pregnancy-form",attrs:{model:e.pregnancyForm,rules:e.rules,"label-width":"90px"}},[s("el-form-item",{staticClass:"m-b-20",attrs:{label:"孕期产检：",prop:"yqcj"}},[s("el-radio-group",{model:{value:e.pregnancyForm.yqcj,callback:function(t){e.$set(e.pregnancyForm,"yqcj",t)},expression:"pregnancyForm.yqcj"}},[s("el-radio",{attrs:{label:"正常"}}),s("el-radio",{attrs:{label:"异常"}})],1),"异常"===e.pregnancyForm.yqcj?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"yqcjDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.pregnancyForm.yqcjDescription,callback:function(t){e.$set(e.pregnancyForm,"yqcjDescription",t)},expression:"pregnancyForm.yqcjDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"贫血：",prop:"anemia"}},[s("el-radio-group",{model:{value:e.pregnancyForm.anemia,callback:function(t){e.$set(e.pregnancyForm,"anemia",t)},expression:"pregnancyForm.anemia"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.pregnancyForm.anemia?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"anemiaDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.pregnancyForm.anemiaDescription,callback:function(t){e.$set(e.pregnancyForm,"anemiaDescription",t)},expression:"pregnancyForm.anemiaDescription"}})],1):e._e()],1),s("el-form-item",{attrs:{label:"并发症：",prop:"bfz"}},[s("el-checkbox-group",{model:{value:e.pregnancyForm.bfz,callback:function(t){e.$set(e.pregnancyForm,"bfz",t)},expression:"pregnancyForm.bfz"}},[s("el-checkbox",{attrs:{label:"妊娠期糖尿病",name:"rmqtnb"}}),s("el-checkbox",{attrs:{label:"妊娠期高血压",name:"rmqgxy"}}),s("el-checkbox",{attrs:{label:"甲状腺功能亢进症",name:"jzxgnkjz"}}),s("el-checkbox",{attrs:{label:"甲状腺功能减退症",name:"jzxgnjtz"}}),s("el-checkbox",{attrs:{label:"妊娠期合并胆汁淤积症",name:"dzyjz"}}),s("el-checkbox",{attrs:{name:"other"}},[e._v("\n            其它\n            "),s("el-input",{model:{value:e.pregnancyForm.bfzOther,callback:function(t){e.$set(e.pregnancyForm,"bfzOther",t)},expression:"pregnancyForm.bfzOther"}})],1)],1)],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"药物干预：",prop:"ywgy"}},[s("el-radio-group",{model:{value:e.pregnancyForm.ywgy,callback:function(t){e.$set(e.pregnancyForm,"ywgy",t)},expression:"pregnancyForm.ywgy"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.pregnancyForm.ywgy?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"ywgyDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.pregnancyForm.ywgyDescription,callback:function(t){e.$set(e.pregnancyForm,"ywgyDescription",t)},expression:"pregnancyForm.ywgyDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",attrs:{label:"接触有害物质：",prop:"jcyhwz"}},[s("el-radio-group",{model:{value:e.pregnancyForm.jcyhwz,callback:function(t){e.$set(e.pregnancyForm,"jcyhwz",t)},expression:"pregnancyForm.jcyhwz"}},[s("el-radio",{attrs:{label:"无"}}),s("el-radio",{attrs:{label:"有"}})],1),"有"===e.pregnancyForm.jcyhwz?s("el-form-item",{staticClass:"description",staticStyle:{"margin-top":"20px"},attrs:{label:"说明：",prop:"jcyhwzDescription"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.pregnancyForm.jcyhwzDescription,callback:function(t){e.$set(e.pregnancyForm,"jcyhwzDescription",t)},expression:"pregnancyForm.jcyhwzDescription"}})],1):e._e()],1),s("el-form-item",{staticClass:"m-b-20",staticStyle:{"margin-top":"20px","max-width":"970px"},attrs:{label:"其它：",prop:"yqywycOther"}},[s("el-input",{staticClass:"des-input",attrs:{placeholder:"请输入",type:"textarea",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.pregnancyForm.yqywycOther,callback:function(t){e.$set(e.pregnancyForm,"yqywycOther",t)},expression:"pregnancyForm.yqywycOther"}})],1)],1):e._e()],1),!e.babyId||e.isMyUser?s("el-form-item",{staticClass:"confirm"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("pregnancyForm")}}},[e._v("修改并保存")])],1):e._e()],1)},C=[],F={props:{pregnancy:{type:[Object,String],default:""},babyId:{type:Boolean,default:!1},isMyUser:{type:Boolean,default:!1}},data:function(){return{pregnancyForm:{fmfs:"",fmfsDescription:"",ysqk:"",yqtz:"",fmstz:"",yqywyc:"",yqcj:"",yqcjDescription:"",anemia:"",anemiaDescription:"",bfz:[],bfzOther:"",ywgy:"",ywgyDescription:"",jcyhwz:"",jcyhwzDescription:"",yqywycOther:""},rules:{}}},watch:{pregnancy:function(){this.pregnancy&&(this.pregnancyForm={fmfs:this.pregnancy.fmfs||"",fmfsDescription:this.pregnancy.fmfsDescription||"",ysqk:this.pregnancy.ysqk||"",yqtz:this.pregnancy.yqtz||"",fmstz:this.pregnancy.fmstz||"",yqywyc:this.pregnancy.yqywyc||"",yqcj:this.pregnancy.yqcj||"",yqcjDescription:this.pregnancy.yqcjDescription||"",anemia:this.pregnancy.anemia||"",anemiaDescription:this.pregnancy.anemiaDescription||"",bfz:this.pregnancy.bfz||[],bfzOther:this.pregnancy.bfzOther||"",ywgy:this.pregnancy.ywgy||"",ywgyDescription:this.pregnancy.ywgyDescription||"",jcyhwz:this.pregnancy.jcyhwz||"",jcyhwzDescription:this.pregnancy.jcyhwzDescription||"",yqywycOther:this.pregnancy.yqywycOther||""})}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(s){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s){e.next=14;break}return"无"===t.pregnancyForm.yqywyc&&(t.pregnancyForm.yqcj="",t.pregnancyForm.yqcjDescription="",t.pregnancyForm.anemia="",t.pregnancyForm.anemiaDescription="",t.pregnancyForm.bfz=[],t.pregnancyForm.bfzOther="",t.pregnancyForm.ywgy="",t.pregnancyForm.ywgyDescription="",t.pregnancyForm.jcyhwz="",t.pregnancyForm.jcyhwzDescription="",t.pregnancyForm.yqywycOther=""),"正常"===t.pregnancyForm.yqcj&&(t.pregnancyForm.yqcjDescription=""),"无"===t.pregnancyForm.anemia&&(t.pregnancyForm.anemiaDescription=""),"无"===t.pregnancyForm.ywgy&&(t.pregnancyForm.ywgyDescription=""),"无"===t.pregnancyForm.jcyhwz&&(t.pregnancyForm.jcyhwzDescription=""),e.next=8,Object(u["y"])({baby_id:t.$route.params.id||t.$store.state.chat.activedBabyId,mather_pregnancy_info:t.pregnancyForm});case 8:a=e.sent,n=a.data,r=a.code,2e4===r?n.result&&t.$message({type:"success",message:"保存成功"}):t.$message({message:n.message,type:"error"}),e.next=15;break;case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},setNumber:function(e,t){Number(e)||(this.pregnancyForm[t]="")},toFixedNum:function(e,t){e&&Number(e)&&(this.pregnancyForm[t]=Number(e).toFixed(1))}}},T=F,I=(s("9ca1"),Object(h["a"])(T,x,C,!1,null,"3e649434",null)),S=I.exports,D=s("2f62"),j={components:{Newborn:f,PersonalInformation:k,PregnancySituation:S},computed:Object(i["a"])({},Object(D["c"])(["activedBabyId","isMyUser"])),props:{babyId:{type:String,default:""},isChatPage:{type:Boolean,default:!1},getInfo:{type:Boolean,default:!0}},data:function(){return{activeName:"first",replace:!1,newborn:{},pregnancy:{},person:{},babyInfo:{user:{}}}},watch:{babyId:function(){this.getHealthFile()}},created:function(){this.getHealthFile()},methods:{getHealthFile:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.getInfo||this.babyId){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(u["n"])({baby:this.babyId||this.$route.params.id||this.activedBabyId});case 4:t=e.sent,s=t.data,a=t.code,2e4===a&&(this.newborn=s.baby_detail_info,this.pregnancy=s.mather_pregnancy_info,this.person=s.family_info,this.babyInfo=s.family_member,this.replace=s.is_replace);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},O=j,$=(s("fc3c"),Object(h["a"])(O,a,n,!1,null,"6fc12d1c",null));t["default"]=$.exports},"5a04":function(e,t,s){},"5ae7":function(e,t,s){"use strict";var a=s("d48b"),n=s.n(a);n.a},6017:function(e,t,s){(function(e,t){(function(e,s){"use strict";if(!e.setImmediate){var a,n=1,r={},i=!1,o=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?h():p()?f():e.MessageChannel?g():o&&"onreadystatechange"in o.createElement("script")?b():y(),l.setImmediate=c,l.clearImmediate=u}function c(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),s=0;s<t.length;s++)t[s]=arguments[s+1];var i={callback:e,args:t};return r[n]=i,a(n),n++}function u(e){delete r[e]}function d(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(s,a);break}}function m(e){if(i)setTimeout(m,0,e);else{var t=r[e];if(t){i=!0;try{d(t)}finally{u(e),i=!1}}}}function h(){a=function(e){t.nextTick((function(){m(e)}))}}function p(){if(e.postMessage&&!e.importScripts){var t=!0,s=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=s,t}}function f(){var t="setImmediate$"+Math.random()+"$",s=function(s){s.source===e&&"string"===typeof s.data&&0===s.data.indexOf(t)&&m(+s.data.slice(t.length))};e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),a=function(s){e.postMessage(t+s,"*")}}function g(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;m(t)},a=function(t){e.port2.postMessage(t)}}function b(){var e=o.documentElement;a=function(t){var s=o.createElement("script");s.onreadystatechange=function(){m(t),s.onreadystatechange=null,e.removeChild(s),s=null},e.appendChild(s)}}function y(){a=function(e){setTimeout(m,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,s("24aa"),s("4362"))},"602b":function(e,t,s){"use strict";var a=s("542e"),n=s.n(a);n.a},6056:function(e,t,s){"use strict";var a=s("d496"),n=s.n(a);n.a},6068:function(e,t,s){"use strict";var a=s("c2c8"),n=s.n(a);n.a},"61ae":function(e,t,s){},6384:function(e,t,s){},"63d9":function(e,t,s){},"642a":function(e,t,s){},"649b":function(e,t,s){},"64e6":function(e,t,s){},"65d1":function(e,t,s){"use strict";var a=s("f615"),n=s.n(a);n.a},"67f3":function(e,t,s){},"69e7":function(e,t,s){"use strict";var a=s("1e85"),n=s.n(a);n.a},"6a5c":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.msgOptions.type===e.MSG_ELEMENT_TYPE.TEXT?s("TextContent",{attrs:{text:e.msgOptions.text||e.msgOptions.content}}):e._e(),e.msgOptions.type===e.MSG_ELEMENT_TYPE.ROBOT_CARD||"round_msg"===e.msgOptions.type?s("div",["re_ask"===e.msgOptions.content[0].ask_type||"new_ask"===e.msgOptions.content[0].ask_type?s("p",{staticClass:"confirm_text"},[e._v("\n      请确认本次咨询主要诉求\n    ")]):e._e(),e._l(e.msgOptions.content,(function(t,a){return s("div",{key:t.ask_type?t.ask_type+a:a},[s("BoutCard",{attrs:{title:e.msgOptions.title,boutCard:e.boutCardData(t,e.item.accountType,a,e.msgOptions),msgTime:e.item.msgTime},on:{showDetail:e.showDetail}}),a<e.msgOptions.content.length-1&&"re_ask"!==e.msgOptions.content[0].ask_type?s("p",{class:e.item.isSelfSend?"chat_divider":"chat_divider_left"}):e._e()],1)}))],2):e._e(),e.msgOptions.type===e.MSG_ELEMENT_TYPE.IMAGE||"image"===e.msgOptions.type?s("div",{staticClass:"image_box"},[s("ImageContent",{attrs:{"images-options":e.msgOptions},on:{thumbClick:e.thumbClick}})],1):e._e(),e.msgOptions.type===e.MSG_ELEMENT_TYPE.VIDEO?s("div",{staticClass:"image_box"},[s("div",{staticClass:"msg_VideoContent"},[s("img",{staticStyle:{"max-width":"540px"},attrs:{height:"200",src:e.msgOptions.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg","data-src":e.msgOptions.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg",alt:""}}),s("i",{staticClass:"el-icon-video-play",on:{click:function(t){return e.thumbClick("video",e.msgOptions.url)}}})])]):e._e(),e.msgOptions.type===e.MSG_ELEMENT_TYPE.CARD?s("CardContent",{attrs:{"images-options":e.msgOptions,baby:e.msgOptions.content.family_member,symptom:e.msgOptions.content.ask_question_desc,"has-interven":e.msgOptions.content.has_interven,"interven-desc":e.msgOptions.content.interven_desc,"data-arr":e.msgOptions.content.ask_question_report},on:{showDetail:e.showDetail}}):e._e(),e.msgOptions.type===e.MSG_ELEMENT_TYPE.VOICE?s("my-audio",{attrs:{msgtime:e.item.msgTime,src:e.msgOptions.url,vduration:e.msgOptions.duration}}):e._e(),e.msgOptions.show&&("voice_card"===e.msgOptions.type||e.msgOptions.is_card)?s("p",[s("voice-card",{attrs:{msgtime:e.item.msgTime,src:e.msgOptions.url,vduration:e.msgOptions.duration}})],1):e._e(),e.msgOptions.type===e.MSG_ELEMENT_TYPE.LINK?s("LinkContent",{attrs:{"link-options":e.msgOptions}}):e._e(),"comment"===e.msgOptions.type?s("p",{staticClass:"align-left comment_content"},[e._v("\n    用户评价："+e._s(e.msgOptions&&e.msgOptions.content||"无")+"\n  ")]):e._e(),"suggestion"===e.msgOptions.type?s("p",{staticClass:"align-left comment_content"},[e._v("\n    "+e._s(e.msgOptions.bus_role_name)+"建议："+e._s(e.msgOptions&&e.msgOptions.suggestion||"无")+"\n  ")]):e._e()],1)},n=[],r=s("f41a"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"TextContent",domProps:{innerHTML:e._s(e.text)}})},o=[],l={name:"TextContent",props:{text:{type:String,default:""}}},c=l,u=(s("d8a3"),s("2877")),d=Object(u["a"])(c,i,o,!1,null,"d77f5c3a",null),m=d.exports,h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("img",{staticStyle:{"max-width":"540px"},attrs:{height:"300",alt:"",src:e.imagesOptions.images?e.imagesOptions.images.oriImage:e.imagesOptions.url},on:{click:e.thumbClickFun}})},p=[],f={name:"ImageContent",props:{imagesOptions:{type:Object,default:function(){return{}}}},created:function(){},methods:{thumbClickFun:function(){this.imagesOptions.images?this.$emit("thumbClick","image",this.imagesOptions.images.oriImage):this.$emit("thumbClick","image",this.imagesOptions.url)}}},g=f,b=Object(u["a"])(g,h,p,!1,null,null,null),y=b.exports,_=s("d679"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"linkContent"},[s("p",{staticClass:"link",domProps:{innerHTML:e._s(e.replaceURLWithHTMLLinks(e.linkOptions.content))},on:{click:function(t){return e.toURL(e.linkOptions.url)}}})])},w=[],k=s("ed08"),x={name:"ImageContent",props:{linkOptions:{type:Object,default:function(){return{}}}},created:function(){},methods:{replaceURLWithHTMLLinks:k["n"],toURL:function(e){e&&window.open(e)}}},C=x,F=(s("65d1"),Object(u["a"])(C,v,w,!1,null,"1e5c354a",null)),T=F.exports,I=s("c1a0"),S=s("92f3"),D=s("8975"),j={props:{msgOptions:{type:Object,default:function(){}},item:{type:Object,default:function(){}}},components:{TextContent:m,ImageContent:y,CardContent:_["a"],LinkContent:T,voiceCard:I["a"],BoutCard:S["a"]},data:function(){return{curUploadList:[],MSG_ELEMENT_TYPE:r["a"].MSG_ELEMENT_TYPE}},methods:{boutCardData:D["boutCardData"],showDetail:function(e){this.thumbClick(e.mediaType,e.meidiaUrl,e.list)},thumbClick:function(e,t,s){this.$parent.thumbClickFun?this.$parent.thumbClickFun(e,t,s):this.$emit("thumbClickFun",{type:e,url:t,list:s})}}},O=j,$=(s("1d24"),Object(u["a"])(O,a,n,!1,null,"e2dd5b8c",null));t["a"]=$.exports},"6ad2":function(e,t,s){},"6bcd":function(e,t,s){e.exports=s.p+"static/img/default.512e7ea4.png"},"6c2c":function(e,t,s){"use strict";var a=s("0945"),n=s.n(a);n.a},"6c4c":function(e,t,s){"use strict";var a=s("0692"),n=s.n(a);n.a},"6dcb":function(e,t,s){"use strict";var a=s("7e74"),n=s.n(a);n.a},7160:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"SystemContent"},[s("el-row",[s("p",{directives:[{name:"show",rawName:"v-show",value:"systemInfo"==e.msgType,expression:"msgType == 'systemInfo'"}],staticClass:"color-yellow"},[s("i",{staticClass:"el-icon-info"}),s("span",[e._v(e._s(e.content))])]),s("p",{directives:[{name:"show",rawName:"v-show",value:"systemWarnning"==e.msgType,expression:"msgType == 'systemWarnning'"}],staticClass:"systemWarnning"},[e._v("\n      "+e._s(e.content)+"\n    ")])])],1)},n=[],r={name:"SystemContent",props:{content:{type:String,default:"超过十分钟"},msgType:{type:String,default:"systemInfo"}}},i=r,o=(s("4dce"),s("2877")),l=Object(o["a"])(i,a,n,!1,null,"20a3d24a",null);t["a"]=l.exports},7182:function(e,t,s){},"7a26":function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"d",(function(){return l})),s.d(t,"c",(function(){return c})),s.d(t,"b",(function(){return u}));var a=s("2ef0"),n=s.n(a),r=s("4360"),i=s("8975");function o(){return{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-6048e5),e.$emit("pick",[s,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-2592e6),e.$emit("pick",[s,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-7776e6),e.$emit("pick",[s,t])}}],disabledDate:function(e){var t=(new Date).getTime();return e>t}}}function l(e){var t=e.event,s=e.bus_role;switch(e.type){case"over_time_send_suggestion":return{bgColor:"#FFFFFF",iconType:"icon-fsdz",color:"#0085FF",border:"1px solid #0085FF"};case"round_append":return{bgColor:"#FFFFFF",iconType:"icon-round_append",color:"#67CA39",border:"1px solid #67CA39"};case"admin_end":return{bgColor:"#FFFFFF",iconType:"icon-admin_end",color:"#ED3645",border:"1px solid #ED3645"};case"text_answer":return{bgColor:"#FFFFFF",iconType:"iconhushi",color:"#FF8181",border:"1px solid #FF8181"};case"system":return"error"===t?{bgColor:"#ED3645",iconType:"icon-setting-fill",border:"1px solid #ED3645"}:"warning"===t?{bgColor:"#FFB718",iconType:"icon-setting-fill",border:"1px solid #FFB718"}:"end"===t?{bgColor:"#979797",iconType:"icon-setting-fill",border:"1px solid #979797"}:"transfer_auto_accept"===t?{bgColor:"#67CA39",iconType:"icon-setting-fill",border:"1px solid #67CA39"}:{};case"system-info":return"error"===t?{bgColor:"#ED3645",iconType:"icon-setting-fill",borderColor:"#FFFFFF"}:"warning"===t?{bgColor:"#FFB718",iconType:"icon-setting-fill",borderColor:"#FFFFFF"}:"end"===t?{bgColor:"#979797",iconType:"icon-setting-fill",borderColor:"#FFFFFF"}:{};case"user_ask":return{bgColor:"#FFFFFF",iconType:"icon-signal-fill",color:"#0085FF",border:"1px solid #0085FF"};case"round_apply_transfer":return{bgColor:"#FFFFFF",iconType:"icon-signal-fill",color:"#0085FF",border:"1px solid #0085FF"};case"user_end":return{bgColor:"#FFFFFF",iconType:"el-icon-user-solid",color:"#979797",border:"1px solid #979797"};case"voice_transfer_answer":return{bgColor:"#FFFFFF",iconType:"icon-yisheng",color:"#67CA39",border:"1px solid #67CA39"};case"text_transfer_answer":return"doctor"===s?{bgColor:"#FFFFFF",iconType:"icon-yisheng",color:"#67CA39",border:"1px solid #67CA39"}:"dietician"===s?{bgColor:"#fff",iconType:"icon-yingyangshi1",color:"#FFB718",border:"1px solid #FFB718"}:{};case"transfer_apply":return{bgColor:"#FFFFFF",iconType:"iconhushi",color:"#FF8181",border:"1px solid #FF8181"};case"transfer_start":return{bgColor:"#FFFFFF",iconType:"iconhushi",color:"#FF8181",border:"1px solid #FF8181"};case"transfer_accept":return"doctor"===s?{bgColor:"#FFFFFF",iconType:"icon-yisheng",color:"#67CA39",border:"1px solid #67CA39"}:"dietician"===s?{bgColor:"#fff",iconType:"icon-yingyangshi1",color:"#FFB718",border:"1px solid #FFB718"}:{};case"transfer_reject":return"doctor"===s?{bgColor:"#FFFFFF",iconType:"icon-yisheng",color:"#67CA39",border:"1px solid #67CA39"}:"dietician"===s?{bgColor:"#fff",iconType:"icon-yingyangshi1",color:"#FFB718",border:"1px solid #FFB718"}:{};case"voice_transfer_end":return{bgColor:"#FFFFFF",iconType:"icon-yisheng",color:"#999",border:"1px solid #999"};case"user_transfer":return{bgColor:"#FFFFFF",iconType:"icon-signal-fill",color:"#0085FF",border:"1px solid #0085FF"};case"iconicon-ysdaiban":return{bgColor:"#FFFFFF",iconType:"iconicon-ysdaiban",color:"#0085FF",border:"1px solid #0085FF"};default:return{}}}function c(e){if(r["a"].state.chat.serviceItem){var t=r["a"].state.chat.serviceItem;if("transfer"===e&&t.length){for(var s=!1,a=0;a<t.length;a++)if(-1!==t[a].indexOf(e))return s=!0,s;return s}var i=n.a.indexOf(t,e);return i=-1!==i,i}}function u(e,t,s,a,n){var r="y-m-d",o=[{show:!0,label:"当前阶段：",value:Object(i["curStageTxt"])(e)},{show:!0,label:"月经史（月经是否规律）：",value:Object(i["booleanToTxt"])(t.is_schedule)},{show:!t.is_schedule&&t.measure_desc,label:"",html:'<span class="color-999">'+t.measure_desc+"</span>",value:""},{show:t.is_schedule,label:"月经周期：",value:t&&t.period_start?t.period_start+"天 至 "+t.period_end+"天":"-"},{show:t.is_schedule,label:"每次持续：",value:t&&t.duration_start?t.duration_start+"天 至 "+t.duration_end+"天":"-"},{show:t.is_schedule,label:"月经量：",value:t&&t.measure?this.measureToTxt(t.measure):"-"},{show:"byz"===e,label:"备孕开始日期：",value:n?this.formatTime(t.started_at,r):t.started_at},{show:"byz"===e,label:"备孕时长：",value:t.bysc},{show:"byz"===e,label:"是否做过孕前检查：",value:Object(i["booleanToTxt"])(t.is_checked)},{show:"byz"===e&&t.is_checked,label:"检查是否有异常：",value:Object(i["booleanToTxt"])(t.has_unusual_status)},{show:"byz"===e&&t.is_checked&&t.has_unusual_status,label:"",html:'<span class="color-999">'+t.unusual_desc+"</span>",value:""},{show:"hyz"===e,label:"末次月经日期：",value:n?this.formatTime(t.last_yuejing_at,r):t.last_yuejing_at},{show:"hyz"===e,label:"预产期：",value:n?this.formatTime(t.yuchan_at,r):t.yuchan_at},{show:"hyz"===e,label:"孕周：",value:t.gestational_weeks?t.gestational_weeks+"周"+t.gestational_days+"天":""},{show:"hyz"===e,label:"是否孕育过有缺陷的宝宝：",value:Object(i["booleanToTxt"])(t.has_unusual_baby)},{show:"hyz"===e&&t.has_unusual_baby,label:"",html:'<span class="color-999">'+t.unusual_baby_desc+"</span>",value:""},{show:"hyz"===e,label:"既往妊娠综合症：",value:Object(i["booleanToTxt"])(t.has_renshen_history,"has")},{show:"hyz"===e&&t.has_renshen_history,label:"",html:'<span class="color-999">'+t.renshen_desc+"</span>",value:""},{show:"crq"===e,label:"分娩日期：",value:n?this.formatTime(t.fenmian_at,r):t.fenmian_at},{show:"crq"===e,label:"分娩方式：",value:Object(i["fenmianModeTxt"])(t.fenmian_mode)},{show:"crq"===e&&"ydfm"===t.fenmian_mode,label:"是否侧切：",value:Object(i["booleanToTxt"])(t.is_ceqie)},{show:"crq"===e,label:"本次产后喂养方式：",value:Object(i["feedModeTxt"])(t.feed_mode)},{show:!!a,label:s?"":"症状描述：",value:"",html:a?a.msg_content.content:""}];return o}},"7b32":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"drawer"},[s("div",{class:e.maskClass,on:{click:e.closeByMask}}),s("div",{staticClass:"main",class:e.mainClass,style:e.mainStyle},[s("div",{staticClass:"drawer-head"},[s("span",{directives:[{name:"show",rawName:"v-show",value:!e.closable,expression:"!closable"}],staticClass:"close-btn-right",on:{click:e.closeByButton}},[s("i",{staticClass:"el-icon-arrow-left"})]),s("span",[e._v(e._s(e.title)+"\n        "),e.title?s("span",{staticStyle:{color:"#2d8cf0"}},[e._v("\n          "+e._s("咨询中的用户"===e.title?e.askingCustomerList.length:"转诊中的用户"===e.title?e.transferCustomerList.length:e.waitingCustomerList.length)+"\n        ")]):e._e()]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.closable,expression:"closable"}],staticClass:"close-btn",on:{click:e.closeByButton}},[s("i",{staticClass:"el-icon-close"})])]),s("div",{staticClass:"drawer-body"},[e._t("default")],2)])])},n=[],r=s("db72"),i=s("2f62"),o={props:{direction:{type:String,default:"right"},display:{type:Boolean},title:{type:String,default:"标题"},closable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},width:{type:String,default:"400px"},inner:{type:Boolean,default:!0}},computed:Object(r["a"])({},Object(i["c"])(["waitingCustomerList","askingCustomerList","transferCustomerList"]),{maskClass:function(){return{"mask-show":this.mask&&this.display,"mask-hide":!(this.mask&&this.display),inner:this.inner}},mainClass:function(){return{"main-show":this.display,"main-hide":!this.display,inner:this.inner}},mainStyle:function(){return{width:this.width,right:this.display?"0":"".concat("right"===this.direction?"+":"-").concat(this.width)}}}),mounted:function(){if(this.inner){var e=this.$el.parentNode;e.style.position="relative"}},methods:{closeByMask:function(){this.maskClosable&&this.$emit("update:display",!1)},closeByButton:function(){this.$emit("update:display",!1),this.$emit("closeDrawer")}}},l=o,c=(s("3bc1"),s("2877")),u=Object(c["a"])(l,a,n,!1,null,"72c21063",null);t["a"]=u.exports},"7e74":function(e,t,s){},8124:function(e,t,s){},"824d":function(e,t,s){"use strict";var a=s("649b"),n=s.n(a);n.a},"85a6":function(e,t,s){"use strict";var a=s("eb11"),n=s.n(a);n.a},8615:function(e,t,s){var a=s("5ca1"),n=s("504c")(!1);a(a.S,"Object",{values:function(e){return n(e)}})},8680:function(e,t,s){"use strict";var a=s("642a"),n=s.n(a);n.a},8703:function(e,t,s){},8722:function(e){e.exports={healthFileTableSearch:{item:[{type:"text",name:"baby_name",value:"",placeholder:"请输入患者姓名",width:"100%",label:"患者姓名：",show:!0,colSpan:6,rules:[]},{type:"text",name:"baby_id",value:"",placeholder:"请输入患者ID",width:"100%",label:"患者ID：",colSpan:6,show:!0,rules:[]},{type:"select",value:"",placeholder:"请选择",show:!0,label:"患者当前阶段：",options:[{label:"备孕中",value:"byz"},{label:"怀孕中",value:"hyz"},{label:"产褥期",value:"crq"}],name:"cur_stage"},{type:"text",name:"user_name",value:"",placeholder:"请输入用户昵称或备注名",width:"100%",label:"用户：",show:!0,colSpan:6,rules:[]},{type:"text",name:"user_id",value:"",placeholder:"请输入用户ID",width:"100%",label:"用户ID：",colSpan:6,show:!0,rules:[]},{type:"servicePackage",value:"",show:!0,label:"当前服务套餐：",placeholder:"请选择",colSpan:7,name:"fd_service_type"},{type:"btn",colSpan:5,show:!0}],data:{baby_name:"",baby_id:"",cur_stage:"",user_name:"",user_id:"",fd_service_type:""}},byzForm:{item:[{type:"date",name:"started_at",value:"",placeholder:"选择日期",width:"100%",label:"备孕开始日期：",show:!0,showBefore:!1,rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"tipRow",label:"备孕时长：",name:"bysc",show:!0,value:""},{type:"radio",name:"is_checked",value:"",width:"100%",label:"是否做过孕前检查：",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择是否做过孕前检查",trigger:"blur"}]},{type:"radio",name:"has_unusual_status",cascaderItem:["is_checked"],cascaderValue:!0,value:"",width:"100%",label:"检查是否有异常：",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择检查是否有异常",trigger:"blur"}]},{type:"textarea",name:"unusual_desc",cascaderItem:["has_unusual_status"],cascaderValue:!0,value:"",width:"100%",label:"说明：",placeholder:"请输入",minlength:"0",maxlength:"100",showLimit:!0,show:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{show:!0,type:"slot",slotName:"updateInfo"}],data:{started_at:"",bysc:"",is_checked:"",has_unusual_status:!1,unusual_desc:"",update_at:"",update_user:""}},hyzForm:{item:[{type:"date",name:"last_yuejing_at",value:"",placeholder:"选择日期",width:"100%",label:"末次月经日期：",show:!0,showBefore:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{type:"date",name:"yuchan_at",value:"",placeholder:"选择日期",width:"100%",label:"预产期：",show:!0,showAfter:!1,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{type:"inputnumber",name:"gestational_weeks",value:"",colSpan:12,width:"100%",label:"孕周：",unit:"周",min:0,max:42,show:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{type:"inputnumber",name:"gestational_days",value:"",min:1,max:6,colSpan:12,width:"100%",label:"",unit:"天",show:!0},{type:"radio",name:"has_unusual_baby",value:"",width:"100%",label:"是否孕育过有出生缺陷的宝宝：",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"textarea",name:"unusual_baby_desc",cascaderItem:["has_unusual_baby"],cascaderValue:!0,value:"",width:"100%",label:"说明：",placeholder:"请输入",minlength:"0",maxlength:"100",showLimit:!0,show:!0,rules:[{required:!0,message:"填写",trigger:"blur"}]},{type:"radio",name:"has_renshen_history",value:"",width:"100%",label:"既往有妊娠合并症：",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"textarea",name:"renshen_desc",cascaderItem:["has_renshen_history"],cascaderValue:!0,value:"",width:"100%",label:"说明：",placeholder:"请输入",minlength:"0",maxlength:"100",showLimit:!0,show:!0,rules:[{required:!0,message:"请选择检查是否有异常",trigger:"blur"}]},{show:!0,type:"slot",slotName:"updateInfo"}],data:{last_yuejing_at:"",yuchan_at:"",gestational_weeks:"",gestational_days:"",has_unusual_baby:"",unusual_baby_desc:"",has_renshen_history:"",renshen_desc:"",update_at:"",update_user:""}},crqForm:{item:[{type:"date",name:"fenmian_at",value:"",placeholder:"选择日期",width:"100%",label:"本次生产分娩日期：",show:!0,showBefore:!0,rules:[]},{type:"select",label:"分娩方式：",name:"fenmian_mode",value:"",width:"100%",show:!0,placeholder:"请选择分娩方式",options:[{label:"阴道分娩",value:"ydfm"},{label:"剖宫产",value:"pgc"}],rules:[{required:!0,message:"请填写分娩情况",trigger:"blur"}]},{type:"radio",name:"is_ceqie",cascaderItem:["fenmian_mode"],cascaderValue:"ydfm",value:"",width:"100%",label:"是否侧切：",show:!0,options:[{value:!0,label:"是"},{value:!1,label:"否"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{type:"radio",name:"feed_mode",value:"",width:"100%",label:"本次产后喂养方式：",show:!0,options:[{value:"muru",label:"母乳喂养"},{value:"rengong",label:"人工喂养"},{value:"mix",label:"混合喂养"}],rules:[{required:!0,message:"请选择",trigger:"blur"}]},{show:!0,type:"slot",slotName:"updateInfo"}],data:{fenmian_at:"",fenmian_mode:"",is_ceqie:"",feed_mode:"",update_at:"",update_user:""}}}},"875a":function(e,t,s){"use strict";s.d(t,"e",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"k",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return l})),s.d(t,"f",(function(){return c})),s.d(t,"h",(function(){return u})),s.d(t,"g",(function(){return d})),s.d(t,"i",(function(){return m})),s.d(t,"j",(function(){return h})),s.d(t,"a",(function(){return p}));var a=s("b775");function n(e){return Object(a["a"])({url:"/growth_info/list",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/growth_info",method:"post",data:e})}function i(e,t){return Object(a["a"])({url:"/growth_info/"+e,method:"put",data:t})}function o(e){return Object(a["a"])({url:"/growth_info",method:"delete",data:e})}function l(e){return Object(a["a"])({url:"/growth_info/"+e,method:"get"})}function c(e){return Object(a["a"])({url:"/growth_info/"+e+"/status",method:"put"})}function u(e){return Object(a["a"])({url:"/family_member/in_server_list",method:"get",params:e})}function d(e){return Object(a["a"])({url:"baby_growth_info/growth",method:"get",params:e})}function m(e){return Object(a["a"])({url:"baby_growth_info/detail/"+e,method:"get"})}function h(e){return Object(a["a"])({url:"baby_growth_info/send/"+e,method:"get"})}function p(e){return Object(a["a"])({url:"baby_growth_info/content",method:"post",data:e})}},8824:function(e,t,s){},"88ae":function(e,t,s){e.exports=s.p+"static/img/pause.06cf94c2.png"},8981:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"extend_wrap"},[s("el-tabs",{attrs:{stretch:!0},model:{value:e.activeInfo,callback:function(t){e.activeInfo=t},expression:"activeInfo"}},["chat"!==e.pageType?s("el-tab-pane",{attrs:{label:"基本信息",name:"basicInfo"}},[s("basic-info",{staticStyle:{padding:"0 10px"},attrs:{"baby-id":e.babyId}})],1):e._e(),"erke"===e.department?s("el-tab-pane",{attrs:{label:"内部共享备注",name:"sharingNotes"}},[s("sharing-notes",{attrs:{"baby-id":e.babyId}})],1):e._e(),"erke"===e.department&&e.ifHasServer("baby_growth")?s("el-tab-pane",{attrs:{name:"growsList"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("el-badge",{staticClass:"grow-dot",attrs:{"is-dot":e.count}},[e._v("\n          发育量表\n        ")])],1),"growsList"===e.activeInfo?s("scroll-box",{attrs:{"box-height":810}},[s("see-detail",{directives:[{name:"show",rawName:"v-show",value:!e.isSee,expression:"!isSee"}],attrs:{member:e.babyId,"page-type":"chat"},on:{setLookStatus:e.setLookStatus}}),e.isSee?s("status-detail",{attrs:{showBtn:e.isSee},on:{return:function(t){return e.setLookStatus(!1)}}}):e._e()],1):e._e()],1):e._e(),s("el-tab-pane",{attrs:{label:"健康档案",name:"healthHistory"}},["healthHistory"===e.activeInfo?s("scroll-box",{attrs:{"box-height":810}},["erke"===e.department?s("file-detail",{staticStyle:{padding:"0 10px"},attrs:{"baby-id":e.babyId,isChatPage:!0}}):e._e(),"chanke"===e.department?s("healthfileDetail",{attrs:{pageType:"chat",department:e.department,memberId:e.babyId}}):e._e()],1):e._e()],1),s("el-tab-pane",{attrs:{label:"咨询历史",name:"consultHistory"}},["consultHistory"===e.activeInfo?s("case-history",{attrs:{department:e.department,"baby-id":e.babyId,lastAskId:e.lastAskId}}):e._e()],1)],1)],1)},n=[],r=(s("96cf"),s("3b8d")),i=s("db72"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"extend_basic_info"},[s("userInfo",{attrs:{pageType:"health",user:e.userInfo},on:{updateInfo:e.getBasicInfoById}}),s("p",{staticClass:"margin-top-20 margin-bottom-6",staticStyle:{color:"#576277"}},[e._v("\n    "+e._s(e.title)+"信息\n    "),e.data.family_member.is_replace?s("svg-icon",{attrs:{"icon-class":"replace"}}):e._e()],1),s("babyInfo",{attrs:{isShow:!0,babyDetail:e.data,department:e.department}})],1)},l=[],c=s("3f52"),u=s("2edf"),d=s("802d"),m={name:"basicInfo",components:{userInfo:c["a"],babyInfo:u["a"]},props:{babyId:{type:String,default:""}},data:function(){return{userInfo:{},healthRecord:{},contractInfo:{},data:{family_member:{}},department:"",title:""}},watch:{babyId:function(){this.getBasicInfoById()}},created:function(){this.getBasicInfoById()},methods:{getBasicInfoById:function(){var e=this;this.babyId&&Object(d["d"])(this.babyId).then((function(t){t&&t.data&&(e.userInfo=t.data.user_info,e.userInfo.is_replace=t.data.family_member_info.is_replace,e.contractInfo=t.data.contract_info,e.healthRecord=t.data.health_record,e.department=t.data.family_member_info.type,t.data.family_member=t.data.family_member_info,t.data.chanke={cur_stage:t.data.family_member_info.cur_stage},t.data.remark=t.data.family_member_info.remark,t.data._id=t.data.family_member_info._id,e.title="chanke"===e.department?"产科患者":"儿科","erke"===e.department&&(t.data.health_record={baby_detail_info:{wyfs:""}}),t.data.family_member_info.family_member||(t.data.family_member_info.family_member=t.data.family_member_info),t.data.fd_contract_info=t.data.contract_info,t.data.fd_product=t.data.contract_info.fd_product_info,e.data=t.data)}))}}},h=m,p=(s("ab54"),s("2877")),f=Object(p["a"])(h,o,l,!1,null,"857dbce2",null),g=f.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"history-container"},[s("el-tabs",{attrs:{type:"card",stretch:!0},on:{"tab-click":e.setType},model:{value:e.consultType,callback:function(t){e.consultType=t},expression:"consultType"}},[e._l(e.consultTypeArr,(function(e,t){return s("el-tab-pane",{key:t,attrs:{size:"mini",label:e.label,name:e.name}})})),"disease"===e.consultType?s("div",[s("el-tabs",{attrs:{type:"card",stretch:!0},on:{"tab-click":e.resetDrawerShow},model:{value:e.historyType,callback:function(t){e.historyType=t},expression:"historyType"}},[s("el-tab-pane",{attrs:{label:"近三段（初诊 + 复诊）",name:"recent"}},[s("case-history-recent",{attrs:{department:e.department,"recent-history":e.recentHistory}})],1),s("el-tab-pane",{attrs:{label:"所有",name:"all"}},[s("case-history-all",{ref:"caseHistoryAll",attrs:{"baby-id":e.babyId,department:e.department,questionType:"disease",sessionLastAsk:e.lastAskId}})],1)],1)],1):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:"disease"!==e.consultType,expression:"consultType !== 'disease'"}]},[s("case-history-all",{ref:e.consultType,attrs:{"baby-id":e.babyId,department:e.department,questionType:e.consultType,sessionLastAsk:e.lastAskId}})],1)],2)],1)},y=[],_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{overflow:"auto"},style:{height:e.extendRecentHistoryHeight}},[s("chat-history",{attrs:{title:"",display:e.displayChat,inner:!0,width:e.drawerWidth,mask:!1,direction:"left"},on:{"update:display":function(t){e.displayChat=t}}},[s("div",[s("msg-card",{attrs:{"msg-list":e.messageList}})],1)]),e._l(e.recentHistory,(function(t){return s("div",{key:t._id,staticClass:"recent-history-card"},[s("div",{staticClass:"time-range"},[e._v("\n      "+e._s(e._f("formatTime")(new Date(t.start_at)))+"\n       到 \n      "+e._s(e._f("formatTime")(new Date(t.end_at)))+"\n    ")]),e._l(t.list,(function(t){return s("div",{key:t._id,staticClass:"talk-container"},[s("div",{staticStyle:{cursor:"pointer"},on:{click:function(s){return e.openDetail(t)}}},[s("div",{staticClass:"talk-title"},[s("div",{staticClass:"text"},[s("div",[e._v("\n              "+e._s(e._f("formatTime")(new Date(t.created_at),"y-m-d"))+"\n            ")]),"disease"==t.question_type?s("div",{staticClass:"align-right margin-right-10"},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v("疾病护理类")]),e._v("\n              "+e._s(t.ask_type)+"\n            ")]):s("div",{staticClass:"align-right margin-right-10"},[e._v("\n              "+e._s("chanke"===e.department?"其他问题":"其他育儿类")+"\n            ")])]),s("div",{staticClass:"icon"},[s("i",{staticClass:"el-icon-arrow-right",class:{"detail-open":t.open}})])]),s("div",{staticClass:"talk-content"},[t.hm?s("div",[e._v("\n            "+e._s(e.systemRole("hm","",e.department))+"："+e._s(t.hm.name||"")+"\n          ")]):e._e(),t.doctor?s("div",[e._v("医生："+e._s(t.doctor.name||""))]):e._e(),t.dietician?s("div",[e._v("\n            营养师："+e._s(t.dietician.name||"")+"\n          ")]):e._e(),s("div",[e._v("状态： "+e._s(e.resolveStatus(t.status,"")))]),s("div",[e._v("\n            "+e._s(t.suggestion_type?e.suggestType(t.suggestion_type):"叮嘱")+"\n            ： "+e._s(t.suggestion)+"\n          ")])])]),t.open?s("div",{staticClass:"history-detail"},[s("history-detail",{attrs:{"time-line-info":e.currentDetail,"fd-ask":t._id},on:{gotoMessages:e.gotoMessages}})],1):e._e()])}))],2)}))],2)},v=[],w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"detail-container"},[s("monitor",{ref:"monitor",attrs:{"monitor-info":e.monitorInfo,"current-image-url-arr":e.curUrlList}}),e._l(e.timeLineInfo,(function(t){return s("div",{key:t.id,staticClass:"detail-card"},["text_answer"===t.type?s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v(e._s(t.user.name))]),s("div",[e._v("图文接待")])]),s("div",{staticClass:"card-nurse-show"},[s("div",[e._v("状态："+e._s(e.resolveStatus(t.status,"")))]),s("div",[e._v("主诉："+e._s(t.main_ask))]),s("div",[e._v("\n            "+e._s(t.suggestion_type?e.suggestType(t.suggestion_type):"叮嘱")+"\n            ： "+e._s(t.suggestion)+"\n          ")])]),s("div",{staticClass:"card-time"},[e._v("\n          "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n        ")])]):"user_end"===t.type?s("div",[e._m(0,!0),s("div",{staticClass:"card-time"},[e._v("\n          "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n        ")])]):"system"===t.type?s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v("系统")]),s("div",[e._v(e._s(t.title))])]),s("div",{staticClass:"card-time"},[e._v("\n          "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n        ")])]):"user_ask"===t.type?s("div",[e._m(1,!0),s("div",{staticClass:"customer-info"},[s("div",[e._v("症状："+e._s(t.ask_question_desc))]),s("div",[e._v("\n            干预史："+e._s(t.interven_desc?t.interven_desc:"无")+"\n          ")]),s("div",[e._v("\n            资料照片及视频："),0===t.ask_question_report.length?s("span",[e._v("无")]):e._e()]),t.ask_question_report.length>0?s("el-row",{staticStyle:{"margin-top":"20px"}},e._l(t.ask_question_report,(function(a,n){return s("el-col",{key:"meida"+n,attrs:{span:6}},[s("media-display-item",{attrs:{url:a.url,"media-type":a.type,"url-list":t.ask_question_report,"show-media-detail":e.showMediaDetail}})],1)})),1):e._e()],1),s("div",{staticClass:"card-time"},[e._v("\n          "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n        ")]),s("el-button",{staticClass:"review-chat",attrs:{type:"text"},on:{click:function(t){return e.gotoMessages(e.fdAsk)}}},[e._v("\n          查看聊天记录\n        ")])],1):e._e()])}))],2)])},k=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card-title"},[s("div",[e._v("用户")]),s("div",[e._v("选择结束咨询")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card-title"},[s("div",[e._v("用户")]),s("div",[e._v("健康咨询")])])}],x=s("afce"),C=s("7962"),F=s("0680"),T={name:"HistoryDetail",components:{MediaDisplayItem:x["a"],Monitor:C["a"]},props:{timeLineInfo:{type:Array,default:function(){return[]}},fdAsk:{type:String,default:""}},data:function(){return{monitorInfo:{},curUrlList:[]}},methods:{resolveStatus:F["c"],suggestType:F["g"],gotoMessages:function(e){this.$emit("gotoMessages",e)},showMediaDetail:function(e,t,s){this.curUrlList=e.filter((function(e){return"image"===e.type})).map((function(e){var t=e.url;return t})),this.monitorInfo={type:t,meta:{url:s}},this.$refs.monitor.show()}}},I=T,S=(s("85a6"),Object(p["a"])(I,w,k,!1,null,"70050d34",null)),D=S.exports,j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"drawer"},[s("div",{class:e.maskClass,on:{click:e.closeByMask}}),s("div",{staticClass:"main",class:e.mainClass,style:e.mainStyle},[s("div",{staticClass:"drawer-head"},[s("span",[e._v("   聊天记录")]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.closable,expression:"closable"}],staticClass:"close-btn el-icon-close",on:{click:e.closeByButton}})]),s("div",{staticClass:"drawer-body"},[e._t("default")],2)])])},O=[],$={props:{display:{type:Boolean},title:{type:String,default:"标题"},closable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},width:{type:String,default:"400px"},inner:{type:Boolean,default:!0}},computed:{maskClass:function(){return{"mask-show":this.mask&&this.display,"mask-hide":!(this.mask&&this.display),inner:this.inner}},mainClass:function(){return{"main-show":this.display,"main-hide":!this.display,inner:this.inner}},mainStyle:function(){return{width:this.width,right:this.display?"0":"+".concat(this.width),borderLeft:this.mask?"none":"1px solid #eee"}}},mounted:function(){},methods:{closeByMask:function(){this.maskClosable&&this.$emit("update:display",!1)},closeByButton:function(){this.$emit("update:display",!1)}}},A=$,z=(s("6dcb"),Object(p["a"])(A,j,O,!1,null,"84c34768",null)),B=z.exports,M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"refmsgCard",staticClass:"msg-card"},[e.msgList&&e.msgList.length>0?s("div",{staticClass:"infinite-list-wrapper"},[s("div",e._l(e.msgList,(function(t,a){return s("div",{key:a,staticStyle:{"line-height":"30px"}},[s("el-row",{staticClass:"all",attrs:{gutter:24}},[s("el-col",{class:e.searchType+"-right",attrs:{span:24}},[s("p",{staticClass:"color-999 align-left"},[s("span",[e._v(e._s(t.account.name))]),s("span",{staticClass:"fontsize-10 margin-left-20"},[e._v(e._s(e._f("formatTime")(new Date(t.created_at))))])]),"text"===t.message_body.type?s("p",{staticClass:"align-left content"},[e._v("\n              "+e._s(t.message_body&&t.message_body.content)+"\n            ")]):e._e(),t.message_body&&"link"===t.message_body.type?s("div",{staticClass:"align-left content"},[s("p",{staticClass:"link",on:{click:function(s){return e.toURL(t.message_body&&t.message_body.content)}}})]):e._e(),"robot_card"===t.message_body.type||"round_msg"===t.message_body.type?s("div",e._l(t.message_body.content,(function(a,n){return s("div",{key:a.ask_type?a.ask_type+n:n},[s("BoutCard",{attrs:{title:t.message_body.title,reAsk:"re_ask"===t.message_body.content[0].ask_type,boutCard:e.boutCardData(a,t.accountType,n,t.msgOptions),msgTime:t.msgTime},on:{showDetail:e.showDetail}}),n<t.message_body.content.length-1&&"re_ask"!==t.message_body.content[0].ask_type?s("p",{class:t.isSelfSend?"chat_divider":"chat_divider_left"}):e._e()],1)})),0):e._e(),t.message_body&&"voicecard"===t.message_body.type?s("div",{staticStyle:{"padding-bottom":"10px"}},[s("open-card",{attrs:{title:"点击查看通话录音"}},[s("voice-card",{attrs:{msgtime:t.message_body.msgTime,src:t.message_body.url,vduration:t.message_body.duration}})],1)],1):e._e(),t.message_body&&"image"===t.message_body.type?s("div",{staticClass:"image-box",on:{click:function(s){return e.thumbClickFun("image",t.message_body.url)}}},[s("img",{attrs:{src:t.message_body&&t.message_body.url,alt:""}})]):e._e(),t.message_body&&"voice"===t.message_body.type?s("div",{staticClass:"image-box"},[s("open-card",{attrs:{title:"点击查看语音"}},[s("audio",{attrs:{src:t.message_body.url,controls:""}})])],1):e._e(),t.message_body&&"video"===t.message_body.type?s("div",{staticClass:"image-box"},[s("div",{staticClass:"VideoContent",on:{click:function(s){return e.thumbClickFun("video",t.message_body.url)}}},[s("img",{attrs:{src:t.message_body&&t.message_body.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg","data-src":t.message_body&&t.message_body.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg",alt:""}}),s("i",{staticClass:"el-icon-video-play"})])]):e._e(),t.message_body&&"notice"===t.message_body.type?s("div",{staticClass:"align-left"},[s("SystemContent",{staticStyle:{"font-size":"12px","text-align":"left"},attrs:{content:t.message_body&&t.message_body.content}})],1):e._e(),t.message_body&&"card"===t.message_body.type?s("div",[s("open-card",{attrs:{title:"点击查看卡片"}},[s("CardContent",{attrs:{"images-options":t.message_body,baby:t.message_body.content.family_member,symptom:t.message_body.content.ask_question_desc,"has-interven":t.message_body.content.has_interven,"interven-desc":t.message_body.content.interven_desc,"data-arr":t.message_body.content.ask_question_report},on:{showDetail:e.showDetail}})],1)],1):e._e()])],1)],1)})),0)]):s("div",{staticStyle:{"text-align":"center",color:"#5a5e66"}},[e._v("\n    咨询记录\n  ")]),s("monitor",{ref:"monitor",attrs:{"monitor-info":e.monitorInfo,"current-image-url-arr":e.curUploadUrlList}})],1)},L=[],E=s("8975"),N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[!1===e.showCard?s("div",{staticStyle:{"font-size":"12px",color:"#576277",cursor:"pointer"},on:{click:function(t){e.showCard=!0}}},[e._v("\n    "+e._s(e.title)+"\n  ")]):s("div",{staticStyle:{"font-size":"12px",color:"#576277",cursor:"pointer"},on:{click:function(t){e.showCard=!1}}},[e._v("\n    关闭查看\n  ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showCard,expression:"showCard"}]},[e._t("default")],2)])},R=[],q={name:"OpenCard",props:{title:{type:String,default:""}},data:function(){return{showCard:!1}}},P=q,V=Object(p["a"])(P,N,R,!1,null,null,null),U=V.exports,H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"SystemContent"},[s("p",{staticStyle:{"margin-bottom":"8px"}},[e._v(e._s(e.createdAt))]),s("el-row",[s("p",{directives:[{name:"show",rawName:"v-show",value:"systemInfo"==e.msgType,expression:"msgType == 'systemInfo'"}]},[s("span",[e._v(e._s(e.content))])]),s("p",{directives:[{name:"show",rawName:"v-show",value:"systemWarnning"==e.msgType,expression:"msgType == 'systemWarnning'"}],staticClass:"systemWarnning"},[e._v("\n      "+e._s(e.content)+"\n    ")])])],1)},W=[],G={name:"SystemContent",props:{content:{type:String,default:"超过十分钟"},createdAt:{type:String,default:""},msgType:{type:String,default:"systemInfo"}}},Y=G,K=(s("4ed2"),Object(p["a"])(Y,H,W,!1,null,"5a23442a",null)),Q=K.exports,J=s("92f3"),X=s("d679"),Z=s("c1a0"),ee={components:{SystemContent:Q,CardContent:X["a"],Monitor:C["a"],VoiceCard:Z["a"],OpenCard:U,BoutCard:J["a"]},props:{searchType:{type:String,default:"all"},msgList:{type:Array,default:function(){return[]}}},watch:{msgList:function(){console.log("msgList==",this.msgList)}},data:function(){return{monitorInfo:{},curUploadUrlList:[],imageArr:[]}},created:function(){},methods:{boutCardData:E["boutCardData"],showDetail:function(e){this.thumbClickFun(e.mediaType,e.meidiaUrl)},thumbClickFun:function(e,t){this.monitorInfo={type:e,meta:{url:t}},this.curUploadUrlList.push(t),this.$refs.monitor.show()},toURL:function(e){e&&window.open(e)}}},te=ee,se=(s("208d"),Object(p["a"])(te,M,L,!1,null,"ea4d6944",null)),ae=se.exports,ne=s("2f62"),re=s("d800"),ie=s("c443"),oe={name:"CaseHistoryRecent",components:{HistoryDetail:D,ChatHistory:B,MsgCard:ae},props:{recentHistory:{type:Array,default:function(){return[]}},department:{type:String,default:""}},data:function(){return{currentDetail:[],displayChat:!1,messageList:[],drawerWidth:"100%"}},computed:{extendRecentHistoryHeight:function(){return"chat"===this.$store.state.babyExtend.pageType?"710px":"650px"}},methods:Object(i["a"])({systemRole:F["h"],resolveStatus:F["c"],suggestType:F["g"],gotoMessages:function(e){var t=this;"chat"===this.$store.state.babyExtend.pageType?this.goFdAsk(e):(this.messageList=[],this.displayChat=!0,Object(ie["d"])(e).then((function(e){t.messageList=e.data.list})))},openDetail:function(e){var t=this;!1===e.open?Object(re["e"])(e._id).then((function(s){2e4===s.code&&(t.currentDetail=s.data.paths,e.open=!0)})):e.open=!1}},Object(ne["b"])({goFdAsk:"goFdAsk"}))},le=oe,ce=(s("a9c7"),Object(p["a"])(le,_,v,!1,null,"03ab5049",null)),ue=ce.exports,de=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("drawer",{attrs:{title:"",display:e.display,inner:!0,width:e.drawerWidth,mask:!1,direction:"left",closable:!1},on:{"update:display":function(t){e.display=t}}},[s("scroll-box",{attrs:{"box-height":670}},[s("range-history",{attrs:{"range-history":e.relatedHistory,department:e.department},on:{openMessageList:e.openMessageList}})],1)],1),s("chat-history",{attrs:{title:"",display:e.displayChat,inner:!0,width:e.drawerWidth,mask:!1,direction:"left"},on:{"update:display":function(t){e.displayChat=t}}},[s("div",[s("msg-card",{attrs:{"msg-list":e.messageList}})],1)]),s("div",{staticClass:"history-search-container"},[s("div",{staticClass:"history-search-item"},[s("div",{staticClass:"history-search-label"},[e._v("建议叮嘱搜索")]),s("el-input",{staticClass:"history-search-value",attrs:{clearable:"",size:"mini",placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},on:{input:e.search},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),s("div",{staticClass:"history-search-label"},[e._v("咨询开始时间")]),s("div",{staticClass:"history-search-item"},[s("el-date-picker",{staticClass:"history-search-value",attrs:{format:" yyyy/MM/dd hh:mm:ss","picker-options":e.pickerOptions,size:"mini",type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},on:{change:e.search},model:{value:e.searchDateRange,callback:function(t){e.searchDateRange=t},expression:"searchDateRange"}})],1)]),e.searchText||e.searchDateRange?e.searchText&&e.allHistory.length>0?s("div",{staticClass:"search-result"},[e._v("\n    "+e._s(e.historyTotalCount)+"条与"),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.searchText))]),e._v("相关内容\n  ")]):0===e.allHistory.length&&e.resultPanelShow?s("div",{staticClass:"search-result"},[e._v("\n    没有找到相关记录\n  ")]):e._e():s("div",{staticClass:"search-result"},[e._v("\n    请输入搜索内容\n  ")]),s("div",{staticClass:"all-history-card"},[s("scroll-box",{attrs:{"box-height":e.extendAllHistoryHeight}},[s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMoreData,expression:"loadMoreData"}],attrs:{"infinite-scroll-immediate":"false"}},e._l(e.allHistory,(function(t,a){return s("div",{key:a},[s("div",{staticClass:"talk-title"},[s("div",{staticClass:"text"},[s("div",[e._v("\n                "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n              ")]),"disease"==t.question_type?s("div",{staticClass:"align-right margin-right-10"},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v("疾病护理类")]),e._v("\n                "+e._s(t.ask_type)+"\n              ")]):s("div",{staticClass:"align-right margin-right-10"},[e._v("\n                "+e._s("chanke"===e.department?"其他问题":"其他育儿类")+"\n              ")])]),s("div",{staticClass:"icon",on:{click:function(s){return e.showDrawerHistory(t)}}},[s("i",{staticClass:"el-icon-arrow-right"})])]),s("div",{staticClass:"talk-content"},[t.hm?s("div",[e._v("\n              "+e._s(e.systemRole("hm","",e.department))+"："+e._s(t.hm.name||"")+"\n            ")]):e._e(),t.dietician?s("div",[e._v("\n              营养师："+e._s(t.dietician.name||"")+"\n            ")]):e._e(),t.doctor?s("div",[e._v("医生："+e._s(t.doctor.name||""))]):e._e(),s("div",[e._v("状态： "+e._s(e.resolveStatus(t.status,"")))]),s("div",[e._v("\n              "+e._s(t.suggestion_type?e.suggestType(t.suggestion_type):"叮嘱")+"\n              ：\n              "),s("span",{domProps:{innerHTML:e._s(e.searchText?e.searchHighlight(t.suggestion,e.searchText):t.suggestion)}})]),s("el-button",{staticClass:"review-chat",attrs:{type:"text"},on:{click:function(s){return e.showDrawerHistory(t)}}},[e._v("\n              查看该段咨询\n            ")])],1)])})),0)])],1)],1)},me=[],he=(s("a481"),s("3b2b"),s("7b32")),pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._l(e.rangeHistory,(function(t){return s("div",{key:t._id,staticClass:"case-drawer"},[s("div",{staticClass:"time-range"},[e._v("\n      "+e._s(e._f("formatTime")(new Date(t.start_at)))+"\n      到\n      "+e._s(e._f("formatTime")(new Date(t.end_at)))+"\n    ")]),e._l(t.list,(function(t){return s("div",{key:t._id},[s("div",{staticStyle:{cursor:"pointer"},on:{click:function(s){return e.openDetail(t)}}},[s("div",{staticClass:"talk-title"},[s("div",{staticClass:"text"},[s("div",[e._v("\n              "+e._s(e._f("formatTime")(new Date(t.created_at),"y-m-d"))+"\n            ")]),"disease"==t.question_type?s("div",{staticClass:"align-right margin-right-10"},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v("疾病护理类")]),e._v("\n              "+e._s(t.ask_type)+"\n            ")]):s("div",{staticClass:"align-right margin-right-10"},[e._v("\n              "+e._s("chanke"===e.department?"其他问题":"其他育儿类")+"\n            ")])]),s("div",{staticClass:"icon"},[s("i",{staticClass:"el-icon-arrow-right",class:{"detail-open":t.open}})])]),s("div",{staticClass:"talk-content"},[t.hm?s("div",[e._v("\n            "+e._s(e.systemRole("hm","",e.department))+"："+e._s(t.hm.name)+"\n          ")]):e._e(),t.doctor?s("div",[e._v("医生："+e._s(t.doctor.name))]):e._e(),t.dietician?s("div",[e._v("营养师： "+e._s(t.dietician.name))]):e._e(),s("div",[e._v("状态： "+e._s(e.resolveStatus(t.status,"")))]),s("div",[e._v("\n            "+e._s(t.suggestion_type?e.suggestType(t.suggestion_type):"叮嘱")+"\n            ： "+e._s(t.suggestion)+"\n          ")])])]),t.open?s("div",{staticClass:"history-detail"},[s("history-detail",{attrs:{"time-line-info":e.currentDetail,department:e.department,"fd-ask":t._id},on:{gotoMessages:e.gotoMessages}})],1):e._e()])}))],2)})),0)},fe=[],ge={name:"RangeHistory",components:{HistoryDetail:D},props:{rangeHistory:{type:Array,default:function(){return[]}},department:{type:String,default:""}},methods:Object(i["a"])({suggestType:F["g"],systemRole:F["h"],resolveStatus:F["c"]},Object(ne["b"])({goFdAsk:"goFdAsk"}),{openDetail:function(e){var t=this;!1===e.open?Object(re["e"])(e._id).then((function(s){2e4===s.code&&(t.currentDetail=s.data.paths,e.open=!0)})):e.open=!1},gotoMessages:function(e){"chat"===this.$store.state.babyExtend.pageType?this.goFdAsk(e):this.$emit("openMessageList",e)}})},be=ge,ye=(s("cd3c"),Object(p["a"])(be,pe,fe,!1,null,"6d046261",null)),_e=ye.exports,ve=s("7a26"),we=s("2c97"),ke=s("2ef0"),xe=s.n(ke),Ce={name:"CaseHistoryAll",components:{Drawer:he["a"],RangeHistory:_e,ChatHistory:B,ScrollBox:we["a"],MsgCard:ae},props:{babyId:{type:String,default:""},questionType:{type:String,default:""},sessionLastAsk:{type:String,default:""},department:{type:String,default:""}},data:function(){return{displayChat:!1,messageList:[],pickerOptions:Object(ve["a"])(),relatedHistory:[],historyTotalCount:null,allHistory:[],currentDetail:[],pageSize:10,resultPanelShow:!1,searchDateRange:null,searchText:"",display:!1,drawerWidth:"100%"}},computed:{extendAllHistoryHeight:function(){return"chat"===this.$store.state.babyExtend.pageType?570:550}},watch:{questionType:function(){this.resetAllHistory(),this.getHistory()},sessionLastAsk:function(e){this.resetAllHistory(),this.getHistory()}},created:function(){this.resetAllHistory(),this.getHistory()},methods:{systemRole:F["h"],resolveStatus:F["c"],suggestType:F["g"],openMessageList:function(e){var t=this;this.messageList=[],this.displayChat=!0,Object(ie["d"])(e).then((function(e){t.messageList=e.data.list}))},resetAllHistory:function(){this.searchText="",this.searchDateRange=null,this.allHistory=[],this.displayChat=!1,this.resultPanelShow=!1,this.display=!1},search:function(){this.resultPanelShow=!1,this.getRemoteData()},showDrawerHistory:function(e){var t=this,s={last_three:0,fd_ask:e._id};Object(re["d"])(s).then((function(e){if(2e4===e.code){var s=e.data.map((function(e){return e.list=e.list.map((function(e){return Object(i["a"])({},e,{open:!1})})),e}));t.relatedHistory=s,t.display=!0}}))},searchHighlight:function(e,t){if(e){var s=new RegExp(t,"g"),a='<span style="color: red">'+t+"</span>",n=e.replace(s,a);return n}},getHistory:function(){var e=this,t=this.sessionLastAsk||"";if(t){var s="all"==this.questionType?"":this.questionType,a={question_type:s,fd_ask:t,search_key:this.searchText,page_size:this.pageSize,current_page:1,start_at:this.searchDateRange?this.searchDateRange[0]:"",end_at:this.searchDateRange?this.searchDateRange[1]:""};Object(re["a"])(a).then((function(t){2e4===t.code&&(e.allHistory=t.data.list,e.historyTotalCount=t.data.count,e.resultPanelShow=!0)}))}else this.allHistory=[]},getRemoteData:xe.a.debounce((function(){this.historyTotalCount=0,this.pageSize=10,this.getHistory()}),300),loadMoreData:function(){this.pageSize+=1,this.pageSize<=this.historyTotalCount&&this.getHistory()}}},Fe=Ce,Te=(s("271d"),s("d2ab"),Object(p["a"])(Fe,de,me,!1,null,"7650121d",null)),Ie=Te.exports,Se={name:"CaseHistory",components:{CaseHistoryRecent:ue,CaseHistoryAll:Ie},props:{babyId:{type:String,default:""},department:{type:String,default:""},lastAskId:{type:String,default:""}},data:function(){return{consultType:"all",consultTypeArr:[{name:"all",label:"全部"},{name:"disease",label:"疾病护理类"},{name:"other",label:"其他问题"}],displayChat:!1,messageList:[],drawerWidth:"100%",historyType:"recent",recentHistory:[]}},computed:Object(i["a"])({},Object(ne["c"])(["babyExtendTab"]),{isRecentHistory:function(){if(this.babyExtendTab&&"consultHistory"===this.babyExtendTab&&"disease"===this.consultType){var e=this.lastAskId||"";return!!e}return!1}}),watch:{isRecentHistory:function(e){if(e){this.historyType="recent",this.recentHistory=[];var t={last_three:1,fd_ask:this.lastAskId};this.getRecentHistory(t)}else this.recentHistory=[]},department:function(){this.consultTypeArr[2].label="chanke"===this.department?"其他问题":"其他育儿类"}},methods:{setType:function(){console.log(this.consultType)},resetDrawerShow:function(){this.$refs.caseHistoryAll.display=!1},getRecentHistory:function(e){var t=this;Object(re["d"])(e).then((function(e){t.recentHistory=e.data;var s=t.recentHistory.map((function(e){return e.list=e.list.map((function(e){return e=Object(i["a"])({},e,{open:!1}),e})),e}));t.recentHistory=s})).catch((function(e){console.log("获取最近的三段咨询记录"+e)}))}}},De=Se,je=Object(p["a"])(De,b,y,!1,null,null,null),Oe=je.exports,$e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"share-notes"},[s("SharingForm",{ref:"sharingForm",attrs:{babyId:e.babyId},on:{showAddForm:e.addVisibleTrue,sharingFormChange:e.sharingFormChange}}),s("AddSharingNotes",{directives:[{name:"show",rawName:"v-show",value:e.addVisible,expression:"addVisible"}],ref:"addSharingNotes",attrs:{babyId:e.babyId},on:{submitNotesSuccess:e.submitNotesSuccess,cancalAdd:e.addVisibleFalse}},[s("template",{slot:"header"},[e._v("\n      "+e._s(e.title)+"\n    ")])],2),e.notesList&&e.notesList.length?s("el-row",[s("scroll-box",{attrs:{"box-height":e.addVisible?300:560}},[s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-immediate":"disabled"}},e._l(e.notesList,(function(t,a){return s("li",{key:a,staticStyle:{"line-height":"30px"}},[s("AddSharingNotes",{attrs:{babyId:e.babyId,showTextareaProps:e.showTextareaArr[a].show,notesContent:t.content,notesId:t._id,editIndex:a},on:{editNotesSuccess:e.editNotesSuccess,cancalAdd:e.addVisibleFalse}},[s("template",{slot:"header"},[e._v("\n              "+e._s(t.admin_user&&t.admin_user.name?t.admin_user.name:"")+"\n              "+e._s(e.formatTime(t.created_at))+"\n            ")]),t.admin_user&&t.admin_user._id&&t.admin_user._id===e.userInfo.id?s("template",{slot:"operator"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showEdit(a)}}},[e._v("\n                修改\n              ")]),s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.showDelNotes(t)}}},[e._v("删除")])],1):e._e()],2)],1)})),0)])],1):e._e(),e.notesList&&0!==e.notesList.length?e._e():s("el-row",{staticClass:"no-data"},[e._v("\n    暂无数据\n  ")]),s("el-dialog",{attrs:{title:"删除提示",visible:e.delNotesDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.delNotesDialogVisible=t}}},[s("span",[e._v("删除后该条数据将从共享备注列表中移除，请确认是否继续删除")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.delNotesFun}},[e._v("删除")])],1)])],1)},Ae=[],ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sharing_form"},[s("el-form",{ref:"sharingForm",attrs:{"label-position":"top",model:e.sharingForm}},[s("el-form-item",{attrs:{label:"关键字搜索"}},[s("el-input",{attrs:{size:"mini",clearable:""},on:{input:e.sharingFormChange},model:{value:e.sharingForm.content,callback:function(t){e.$set(e.sharingForm,"content",t)},expression:"sharingForm.content"}})],1),s("el-form-item",{attrs:{label:"人员搜索"}},[s("el-input",{attrs:{clearable:"",size:"mini"},on:{input:e.sharingFormChange},model:{value:e.sharingForm.name,callback:function(t){e.$set(e.sharingForm,"name",t)},expression:"sharingForm.name"}})],1),s("el-form-item",{attrs:{label:"备注时间"}},[s("el-date-picker",{attrs:{size:"mini",clearable:"",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{input:e.sharingFormChange},model:{value:e.sharingForm.createdAt,callback:function(t){e.$set(e.sharingForm,"createdAt",t)},expression:"sharingForm.createdAt"}})],1),s("el-radio-group",{attrs:{size:"mini"},on:{input:e.busRoleChange},model:{value:e.sharingForm.bus_role,callback:function(t){e.$set(e.sharingForm,"bus_role",t)},expression:"sharingForm.bus_role"}},[s("el-radio-button",{attrs:{label:"hm"}},[e._v("健康管理师")]),s("el-radio-button",{attrs:{label:"doctor"}},[e._v("医生")]),s("el-radio-button",{attrs:{label:"dietician"}},[e._v("营养师")]),s("el-radio-button",{attrs:{label:""}},[e._v("全部")])],1),s("el-button",{staticClass:"add_sharing_notes_btn",attrs:{type:"text",disabled:!e.isMyUser},on:{click:e.addSharingNotes}},[e._v("添加")])],1)],1)},Be=[],Me={data:function(){return{sharingForm:{content:"",name:"",createdAt:"",bus_role:"hm"}}},computed:Object(i["a"])({},Object(ne["c"])(["isMyUser"])),methods:{addSharingNotes:function(){this.$emit("showAddForm")},sharingFormChange:function(){this.sharingForm.bus_role="",this.$emit("sharingFormChange",this.sharingForm)},busRoleChange:function(){this.$emit("sharingFormChange",this.sharingForm)}}},Le=Me,Ee=(s("3056"),Object(p["a"])(Le,ze,Be,!1,null,"167abbf5",null)),Ne=Ee.exports,Re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add_notes_form"},[s("el-row",{staticClass:"header",attrs:{gutter:24}},[s("el-col",{staticClass:"title",attrs:{span:16}},[e._t("header")],2),s("el-col",{staticClass:"align-right",attrs:{span:7}},[e._t("operator")],2)],1),e.showTextareaProps?s("el-row",{staticClass:"textarea_row"},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注内容"},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),s("el-row",{staticClass:"align-center",staticStyle:{margin:"14px 0"}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submitNotes}},[e._v("\n        保存\n      ")]),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cancelAdd}},[e._v("\n        取消\n      ")])],1)],1):e._e(),e.showTextareaProps?e._e():s("div",{staticClass:"notes_content"},[e._v("\n    "+e._s(e.notesContent)+"\n  ")])],1)},qe=[],Pe=(s("c5f6"),s("b775"));function Ve(e,t){return delete t.created_at,delete t.count,Object(Pe["a"])({url:"/shared_remarks/list/".concat(e),method:"get",params:t})}function Ue(e,t){return Object(Pe["a"])({url:"/shared_remarks/create/".concat(e),method:"post",data:t})}function He(e,t){return Object(Pe["a"])({url:"/shared_remarks/edit/".concat(e),method:"put",data:t})}function We(e){return Object(Pe["a"])({url:"/shared_remarks/destroy/".concat(e),method:"DELETE"})}var Ge={props:{showTextareaProps:{type:Boolean,default:!0},notesContent:{type:String,default:""},babyId:{type:String,default:""},notesId:{type:String,default:""},editIndex:{type:Number,default:0}},data:function(){return{content:""}},watch:{showTextareaProps:function(e){e&&(this.content=this.notesContent)}},methods:{submitNotes:function(){var e=this;this.content?this.notesId?He(this.notesId,{content:this.content}).then((function(t){t.data.result&&(e.$message.success("更新成功"),e.content="",e.$emit("editNotesSuccess",e.editIndex))})):Ue(this.babyId,{content:this.content}).then((function(t){2e4===t.code&&(e.$message.success("保存成功"),e.content="",e.$emit("submitNotesSuccess"))})):this.$message({type:"warning",message:"备注不能为空"})},cancelAdd:function(){this.$emit("cancalAdd",this.editIndex)}}},Ye=Ge,Ke=(s("cbf7"),Object(p["a"])(Ye,Re,qe,!1,null,"0c4c7229",null)),Qe=Ke.exports,Je={computed:Object(i["a"])({},Object(ne["c"])(["bus_role","userInfo"]),{disabled:function(){return this.loading||this.noMore}}),components:{SharingForm:Ne,ScrollBox:we["a"],AddSharingNotes:Qe},props:{babyId:{type:String,default:""}},watch:{"defaultSearcheParams.count":function(){this.pageSizes=this.defaultSearcheParams.count%this.defaultSearcheParams.pageSize===0?this.defaultSearcheParams.count/this.defaultSearcheParams.pageSize:this.defaultSearcheParams.count/this.defaultSearcheParams.pageSize+1},babyId:function(){this.notesList=[],this.loadMoreFlag=!1,this.$refs.sharingForm.sharingForm={content:"",name:"",createdAt:"",bus_role:"hm"},this.$refs.addSharingNotes.content="",this.addVisible=!1,this.defaultSearcheParams={currentPage:1,pageSize:10,count:0},this.getNotesList()}},data:function(){return{notesId:"",delNotesDialogVisible:!1,addVisible:!1,notesList:[],title:"添加备注",defaultSearcheParams:{currentPage:1,pageSize:10,count:0},pageSizes:0,loadMoreFlag:!1,showTextareaArr:[],SearcheParams:{content:"",name:"",beginTime:"",endTime:"",bus_role:"hm"},loading:!1,noMore:""}},mounted:function(){this.getNotesList()},methods:{handleClose:function(){this.delNotesDialogVisible=!1},addVisibleTrue:function(){this.addVisible=!0},addVisibleFalse:function(e){this.addVisible=!1,(e||0===e)&&(this.$set(this.showTextareaArr[e],"show",!1),this.$forceUpdate())},showDelNotes:function(e){this.delNotesDialogVisible=!0,this.notesId=e._id},delNotesFun:function(){var e=this;We(this.notesId).then((function(t){t.data.result&&(e.handleClose(),e.notesId="",e.notesList=[],e.loadMoreFlag=!1,e.getNotesList()),e.$message({type:t.data.result?"success":"error",message:t.data.result?"删除成功":"删除失败"})}))},sharingFormChange:function(e){this.SearcheParams=e,this.submitNotesSuccess()},getNotesList:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.babyId){e.next=2;break}return e.abrupt("return");case 2:return this.SearcheParams=Object.assign(this.$refs.sharingForm.sharingForm,this.defaultSearcheParams),this.SearcheParams.beginTime=this.SearcheParams.createdAt&&this.SearcheParams.createdAt.length?this.SearcheParams.createdAt[0]:"",this.SearcheParams.endTime=this.SearcheParams.createdAt&&this.SearcheParams.createdAt.length?this.SearcheParams.createdAt[1]:"",e.next=7,Ve(this.babyId,this.SearcheParams).then((function(e){if(e.data.list){t.loadMoreFlag?t.notesList=t.notesList.concat(e.data.list):t.notesList=e.data.list;for(var s=0;s<t.notesList.length;s++)t.showTextareaArr[s]&&t.showTextareaArr[s].show?t.$set(t.showTextareaArr[s],"show",!1):t.showTextareaArr[s]={show:!1};t.defaultSearcheParams.count=e.data.count,t.defaultSearcheParams.currentPage=e.data.currentPage}}));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),showEdit:function(e){this.$set(this.showTextareaArr[e],"show",!0),this.$forceUpdate()},editNotesSuccess:function(e){this.submitNotesSuccess()},submitNotesSuccess:function(){this.notesList=[],this.loadMoreFlag=!1,this.defaultSearcheParams={currentPage:1,pageSize:10,count:0},this.getNotesList(),this.addVisible=!1},loadMore:function(){this.defaultSearcheParams.currentPage<=this.pageSizes&&(this.loading=!0,this.defaultSearcheParams.currentPage++,this.loadMoreFlag=!0,this.getNotesList(),this.loading=!1)}}},Xe=Je,Ze=(s("92cf"),Object(p["a"])(Xe,$e,Ae,!1,null,"836c5e2a",null)),et=Ze.exports,tt=s("57ee"),st=s("17e4"),at=s("dac4"),nt=s("df64"),rt=s("7b1f"),it={components:{basicInfo:g,CaseHistory:Oe,SeeDetail:at["default"],StatusDetail:nt["default"],FileDetail:tt["default"],healthfileDetail:st["default"],sharingNotes:et,ScrollBox:we["a"]},props:{babyId:{type:String,default:""},pageType:{type:String,default:"chat"}},data:function(){return{isSee:!1,count:!1,userId:"",babyInfo:{},lastAskId:"",activeInfo:"",department:""}},computed:Object(i["a"])({},Object(ne["c"])(["lastAsk","userInfo"])),watch:{babyId:function(e){this.getDetail()},activeInfo:function(e){this.$store.commit("babyExtend/SET_ACTIVEINFO",e)}},created:function(){this.getDetail()},methods:{ifHasServer:ve["c"],getDetail:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.department="",!this.babyId){e.next=5;break}return this.getSendCount(this.babyId),e.next=5,Object(d["c"])(this.babyId).then((function(e){s.babyInfo=e.data,e.data.length&&(s.department=s.babyInfo[0].type,s.lastAskId=e.data[0].last_ask?e.data[0].last_ask:s.lastAsk?s.lastAsk._id:"")}));case 5:t="chat"===this.pageType?"sharingNotes":"basicInfo","chanke"===this.department&&"chat"===this.pageType&&(t="healthHistory"),this.activeInfo=t,this.$store.commit("babyExtend/SET_PAGETYPE",this.pageType),this.$store.commit("babyExtend/SET_ACTIVEINFO",this.activeInfo);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getSendCount:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(rt["r"])({baby:t});case 2:s=e.sent,a=s.data,this.count=!!a.count;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setLookStatus:function(e){this.isSee=!1!==e||e}}},ot=it,lt=(s("0831"),Object(p["a"])(ot,a,n,!1,null,null,null));t["a"]=lt.exports},"8aa2":function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"i",(function(){return r})),s.d(t,"h",(function(){return i})),s.d(t,"g",(function(){return o})),s.d(t,"a",(function(){return l})),s.d(t,"e",(function(){return c})),s.d(t,"d",(function(){return u})),s.d(t,"c",(function(){return d})),s.d(t,"f",(function(){return m}));var a=s("b775");function n(e){return Object(a["a"])({url:"/task_manager/chanke/task",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/task_manager/chanke/task_message",method:"post",data:e})}function i(e,t){return Object(a["a"])({url:"/task_manager/chanke/task/".concat(e,"/save"),method:"put",data:t})}function o(e){return Object(a["a"])({url:"task_manager/chanke/task/".concat(e,"/send"),method:"put"})}function l(e,t){return Object(a["a"])({url:"/task_manager/chanke/task/".concat(e,"/close"),method:"put",data:t})}function c(e){return Object(a["a"])({url:"/task_manager/chanke/task/".concat(e,"/preview"),method:"get"})}function u(e){return Object(a["a"])({url:"/task_manager/chanke/task/".concat(e,"/detail"),method:"get"})}function d(e){return Object(a["a"])({url:"/task_manager/chanke/tasks",method:"get",params:e})}function m(e,t){return Object(a["a"])({url:"/task_manager/chanke/task/".concat(e,"/reply_msg"),method:"put",data:t})}},"8d1f":function(e,t,s){"use strict";var a=s("a482"),n=s.n(a);n.a},"8fa3":function(e,t,s){},"8fae":function(e,t,s){"use strict";var a=s("6384"),n=s.n(a);n.a},9055:function(e,t,s){"use strict";var a=s("5a04"),n=s.n(a);n.a},"91b6":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return l})),s.d(t,"c",(function(){return u}));s("7f7f"),s("386d"),s("28a5");var a=s("db72"),n=(s("96cf"),s("3b8d")),r=s("b775"),i=function(){return Object(r["a"])({url:"/oss/auth",method:"get"})},o=function(e){return Object(r["a"])({url:e+"?x-oss-process=image/info",method:"get"})},l=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var s,n,i,l,c,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.oss,n=t.key,i=t.file,l=t.onProgress,c=new FormData,c.append("OSSAccessKeyId",s.OSSAccessKeyId),c.append("success_action_status",200),c.append("policy",s.policy),c.append("Signature",s.Signature),c.append("key",n),c.append("file",i),u="https://pic1.baobaohehu.com/",e.next=11,Object(r["a"])({url:u,method:"post",headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l||null,data:c});case 11:if(u+=n,!(i.type.indexOf("image")>-1)){e.next=18;break}return e.next=15,o(u);case 15:d=e.sent,e.next=27;break;case 18:if(!(i.type.indexOf("video")>-1)){e.next=22;break}d=Object(a["a"])({},i.videoMeta,{size:i.size}),e.next=27;break;case 22:if(!(i.type.indexOf("audio")>-1)){e.next=26;break}d={size:i.size,type:i.type},e.next=27;break;case 26:throw new Error("当前上传的类型不是image或者video；当前上传的类型是"+i.type);case 27:return e.abrupt("return",{url:u,meta:d});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(e){if(!e||"string"!==typeof e)return!1;var t=e.split("").reverse().join(""),s=t.substring(0,t.search(/\./)).split("").reverse().join("");return s},u=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,s){var a,n,r,o,u,d,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return a=e.sent,n=a.data,r=Math.floor(99*Math.random())+1,o=(new Date).getTime(),u=c(t.name),o=o+r+"."+u,d="".concat(n.path,"/").concat(n.prefix,"/").concat(o),e.next=11,l({oss:n,key:d,file:t,onProgress:s});case 11:return m=e.sent,e.abrupt("return",m);case 13:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}()},9284:function(e,t,s){},"92cf":function(e,t,s){"use strict";var a=s("e7e2"),n=s.n(a);n.a},"92f3":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bout-card",on:{click:e.goMessageDetail}},[e.title?s("el-row",[s("h5",{staticClass:"card_title",staticStyle:{"min-width":"220px"}},[e._v(e._s(e.title))]),s("p",{staticClass:"divider"})]):e._e(),e._l(e.boutCard,(function(t,a){return s("el-row",{key:"boutItem"+a,attrs:{gutter:24}},[t.show?s("el-col",{attrs:{span:24}},["confirm_text"===t.type?s("div",[s("p",{staticClass:"confirm_text"},[e._v("\n          "+e._s(t.content)+"\n        ")])]):e._e(),"ask_type"===t.type?s("div",[s("p",{staticClass:"divider"}),s("p",{staticClass:"confirm_text"},[s("span",[e._v(" "+e._s(t.content))]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.showTime,expression:"boutItem.showTime"}],staticClass:"float-right create_time"},[e._v("\n            "+e._s(t.time)+"\n          ")])]),s("p",{staticClass:"divider"})]):e._e(),"text"===t.type?s("div",[s("h5",{staticClass:"card_title"},[e._v(e._s(t.title))]),s("div",{staticClass:"text-wrap"},[e._v(e._s(t.content))])]):e._e(),"btn"===t.type?s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-button",{staticClass:"notic_disabled_btn",attrs:{size:"mini",type:"info",disabled:!0}},[e._v("\n          已确认\n        ")])],1):e._e(),"voice"===t.type?s("div",[s("my-audio",{attrs:{msgtime:e.msgTime,src:t.voice.url,vduration:t.voice.duration}})],1):e._e(),t.dataArr&&t.dataArr.length>0?s("div",{staticClass:"data"},e._l(t.dataArr,(function(a,n){return s("div",{key:n,staticClass:"image-and-video"},["image"===a.type?s("img",{attrs:{src:a.url,alt:"",width:"50px"},on:{click:function(s){return e.showMediaDetail(a.url,a.type,t.dataArr)}}}):"video"===a.type?s("div",{staticClass:"video-container"},[s("div",{staticClass:"VideoContent"},[s("img",{attrs:{src:a.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg","data-src":a.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg",alt:""}}),s("i",{staticClass:"el-icon-video-play",on:{click:function(t){return e.showMediaDetail(a.url,"video",[])}}})])]):e._e()])})),0):e._e()],1):e._e()],1)}))],2)},n=[],r=s("2b0e"),i=r["default"].filter("gender"),o={name:"bout-card",components:{},props:{msgTime:{type:String,default:""},boutCard:{type:Array,default:function(){return[]}},hasInterven:{type:Boolean,default:!1},intervenDesc:{type:String,default:""},title:{type:String,default:""}},data:function(){return{currentMediaType:"",currentMediaUrl:"",dialogVisible:!1}},methods:{genderFilter:i,goMessageDetail:function(){this.$emit("goMsgDetail")},showMediaDetail:function(e,t,s){for(var a=[],n=0;n<s.length;n++){var r=s[n];"image"===r.type&&r.url&&a.push(r.url)}var i={mediaType:t,meidiaUrl:e,list:a};this.$emit("showDetail",i)},closeVideoDialog:function(){if("video"===this.currentMediaType){var e=document.getElementById("myVideo");e.pause()}}}},l=o,c=(s("8d1f"),s("2877")),u=Object(c["a"])(l,a,n,!1,null,"130bdd5e",null);t["a"]=u.exports},"92fc":function(e){e.exports={healthFileList:[{prop:"index",label:"序号",fixed:!1,widths:"50",sortable:!1,show:!0},{prop:"member",label:"患者",fixed:!1,widths:"190",type:"slot",sortable:!1,show:!0},{prop:"userInfo",label:"用户",width:"auto",fixed:!1,type:"slot",sortable:!1,show:!0},{prop:"userStage",label:"患者当前阶段",width:"auto",fixed:!1,type:"slot",sortable:!1,show:!0},{prop:"remark",label:"患者备注",width:"auto",fixed:!1,sortable:!1,slot:{header:!0,content:"接诊台患者资料处添加的备注",placement:"top"},show:!0},{prop:"userRemark",label:"用户备注",type:"slot",slot:{header:!0,content:"接诊台用户资料处添加的备注",placement:"top"},width:"auto",fixed:!1,sortable:!1,show:!0},{prop:"servicePackage",label:"当前服务套餐",type:"slot",widths:"170",fixed:!1,sortable:!1,show:!0},{prop:"serviceTime",label:"当前套餐服务时间",type:"slot",widths:"190",fixed:!1,sortable:!1,show:!0}]}},9635:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{click:e.replyBoxFlag}},[a("app-header"),a("div",{staticClass:"chat_wrap"},[a("div",[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"left-container"},[a("drawer",{attrs:{title:"waiting"===e.listType?"等待接入的用户":"hm"===e.role?"咨询中的用户":"转诊中的用户",display:e.quickList,inner:!0,width:e.drawerWidth,mask:!1},on:{"update:display":function(t){e.quickList=t},closeDrawer:e.closeDrawerFun}},[a("customer-in-drawer",{attrs:{"list-type":e.listType}})],1),a("el-tabs",{attrs:{stretch:!0},model:{value:e.activeList,callback:function(t){e.activeList=t},expression:"activeList"}},[a("el-tab-pane",{attrs:{label:"消息",name:"messageQueue"}},[a("message-queue")],1),a("el-tab-pane",{attrs:{label:"用户",name:"customer"}},[a("customer-list")],1)],1),a("div",{staticClass:"footer"},[a("div",{class:"waiting"===e.listType?"waiting_tab":"",on:{click:function(t){e.listType="waiting",e.quickList=!0}}},[e._v("\n              等待接入用户\n              "),a("span",{staticClass:"active"},[e._v("\n                "+e._s(e.waitingCustomerList.length)+"\n              ")])]),a("div",{class:"ongoing"===e.listType?"ongoing_tab":"",on:{click:function(t){e.listType="ongoing",e.quickList=!0}}},[a("span",[e._v(e._s("hm"===e.role?"咨询中":"转诊中"))]),"hm"===e.role?a("span",{staticClass:"active"},[e._v("\n                "+e._s(e.askingCustomerList.length)+"\n              ")]):e._e(),"hm"!==e.role?a("span",{staticClass:"active"},[e._v("\n                "+e._s(e.transferCustomerList.length)+"\n              ")]):e._e()])])],1)]),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.msgQueue&&e.msgQueue.length>0,expression:"msgQueue && msgQueue.length > 0"}],attrs:{span:3}},[a("userInfo")],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.msgQueue&&e.msgQueue.length>0,expression:"msgQueue && msgQueue.length > 0"}],attrs:{span:10}},[a("div",{staticClass:"chat-container"},[a("el-row",{staticClass:"chat-tab"},[a("el-col",{attrs:{span:18}},["IM"===e.askMode?a("transferStatus"):e._e(),"IM"!==e.askMode?a("askingStatus"):e._e()],1),a("el-col",{staticClass:"return",attrs:{span:6}},[a("span",{on:{click:e.gotoDashboard}},[e._v("返回工作台")])])],1),a("div",{staticClass:"chat-main"},[a("div",{staticClass:"chat-main-left"},[a("div",{staticClass:"chat-region",class:"IM"===e.askMode?"height-percent-70":"height-percent-55"},[a("div",{ref:"chatListWrapper",staticClass:"chat-list-wrapper",attrs:{id:"chatBox"}},[a("chatArea"),e.scrollBottomBtn?a("GoBottom",{on:{goBottom:e.scrollBottom}}):e._e()],1),"ROUND"===e.askMode?a("div",[a("transferStatus",{staticClass:"round_transfer_status_box"})],1):e._e()]),a("div",{staticClass:"chat-input-wrapper",class:"IM"===e.askMode?"height-percent-26":"height-percent-37"},[a("ChatInput")],1)])])],1)]),e.msgQueue&&e.msgQueue.length>0?a("el-col",{attrs:{span:3}},[a("case-timeline")],1):e._e(),e.msgQueue&&e.msgQueue.length>0?a("el-col",{attrs:{span:5}},[a("Extend",{attrs:{"baby-id":e.activedBabyId}})],1):e._e(),e.msgQueue&&0!==e.msgQueue.length?e._e():a("el-col",{staticClass:"default-box",attrs:{span:21,type:"flex",justify:"center"}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("div",[a("img",{attrs:{src:s("6bcd"),alt:""}}),a("p",[e._v("为母婴人群提供专业的医疗健康服务")])])])],1)],1)])],1)},n=[],r=s("db72"),i=s("2f62"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"userinfo-wrap"},[s("div",{staticClass:"user-box-title"},[e._v("用户信息")]),e.showUserInfo?s("div",{staticClass:"user-and-baby-card"},[s("scroll-box",{attrs:{"box-height":815}},[s("user",{staticClass:"user-box",attrs:{user:e.user}}),s("div",{staticClass:"baby-wrap"},[e.familyMermberList.length?s("div",{staticClass:"baby-box"},e._l(e.familyMermberList,(function(e){return s("baby",{key:e._id,attrs:{babyDetail:e}})})),1):e._e()])],1)],1):e._e()])},l=[],c=(s("7f7f"),s("2c97")),u=s("2edf"),d=s("3f52"),m={name:"UserInfo",data:function(){return{showUserInfo:!1,user:{},babyDetail:{},familyMermberList:[]}},components:{ScrollBox:c["a"],user:d["a"],baby:u["a"]},computed:Object(r["a"])({},Object(i["c"])(["currentCustomer"])),watch:{currentCustomer:{handler:function(e){this.userInfoFormat(e)},deep:!0}},created:function(){},methods:{userInfoFormat:function(e){var t=e.user;t?(this.user={_id:t._id,user_id:t.user_id,remark:t.remark,name:t.name,nickname:t.nick_name,avatar:t.avatar},this.familyMermberList=e.family_member_list,this.showUserInfo=!0):this.showUserInfo=!1}}},h=m,p=(s("ba59"),s("2877")),f=Object(p["a"])(h,o,l,!1,null,null,null),g=f.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("PageCommon",e._l(e.customerTree,(function(t,a){return s("div",{key:a,staticClass:"group-card"},[s("div",{staticClass:"group-card-title"},[t.is_mine?s("svg-icon",{staticClass:"icon-avatar",attrs:{"icon-class":"myteam"}}):s("div",{staticClass:"bg-blue"},[e._v(e._s(t.name[0]))]),e._v("\n      "+e._s(t.is_mine?"我的团队":t.name)+"\n      "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"代班中",placement:"top"}},[s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!("doctor"!==e.role||!t.is_replace),expression:"role === 'doctor' && group.is_replace ? true : false"}],staticClass:"group_replace_icon",attrs:{"icon-class":"yxdaiban1"}})],1)],1),e._l(t.hms,(function(t,a){return s("div",{key:"nurse"+a},[s("toggle-box",{attrs:{"child-sessions":t.sessions},scopedSlots:e._u([{key:"toggleTitle",fn:function(){return[s("div",{staticClass:"group-card-subtitle"},[s("div",{staticClass:"nurse-name"},[e._v("\n              "+e._s(t.name)+"("+e._s(t.server_num)+"/"+e._s(t.server_limit)+")\n              "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"代班中",placement:"top"}},[s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!("doctor"===e.role||!t.is_replace),expression:"\n                    role !== 'doctor' && nurse.is_replace ? true : false\n                  "}],staticClass:"replace_icon",attrs:{"icon-class":"yxdaiban1"}})],1)],1)])]},proxy:!0},{key:"toggleContent",fn:function(){return e._l(t.sessions,(function(t,a){return s("div",{key:a},[s("session-card",{attrs:{session:t,edit:!0,"update-remarkname":e.updateRemarkName}})],1)}))},proxy:!0}],null,!0)})],1)}))],2)})),0)},y=[],_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{overflow:"hidden","line-height":"35px"}},[s("div",{staticStyle:{padding:"10px 15px 0"}},[s("el-input",{attrs:{clearable:"",placeholder:"备注名、编号、昵称等"},on:{input:e.getCustomerTree},model:{value:e.cusSearchValue,callback:function(t){e.cusSearchValue=t},expression:"cusSearchValue"}},[s("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("scroll-box",{attrs:{"box-height":747}},[e._t("default")],2)],1)},v=[],w=s("2ef0"),k=s.n(w),x={name:"CustomerList",components:{ScrollBox:c["a"]},data:function(){return{searchText:""}},computed:Object(r["a"])({},Object(i["c"])(["customerTree"]),{cusSearchValue:{get:function(){return this.$store.state.chat.cusSearchValue},set:function(e){this.$store.commit("chat/SET_CUS_SEARCHVALUE",e)}}}),methods:{getCustomerTree:k.a.debounce((function(){this.$store.dispatch("chat/getCustomerTree")}),1e3)}},C=x,F=(s("a340"),Object(p["a"])(C,_,v,!1,null,"203bebea",null)),T=F.exports,I=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["session-container",{active:e.classIsActive(e.session)}],on:{click:function(t){return e.handleCustomer(e.session)}}},[s("el-row",{attrs:{gutter:24,type:"flex",justify:"space-between"}},[s("el-col",{attrs:{span:6}},[e.session.session_id===e.sessionId&&e.unReadCount?s("el-badge",{attrs:{value:e.unReadCount}},[s("el-avatar",{key:e.session.user._id,attrs:{size:"large",src:e.session.user.avatar}})],1):e.session.un_read_count>0?s("el-badge",{attrs:{value:e.session.un_read_count}},[s("el-avatar",{key:e.session.user._id,attrs:{size:"large",src:e.session.user.avatar}})],1):s("el-avatar",{attrs:{size:"large",src:e.session.user.avatar}})],1),s("el-col",{staticStyle:{"line-height":"18px","font-size":"10px",color:"#999"},attrs:{span:18}},[s("div",[e.remarkEditable?s("input",{directives:[{name:"model",rawName:"v-model",value:e.remarkName,expression:"remarkName"},{name:"myfocus",rawName:"v-myfocus"}],staticStyle:{width:"100px"},domProps:{value:e.remarkName},on:{blur:function(t){return e.onRemarkBlur(e.session,e.remarkName)},input:function(t){t.target.composing||(e.remarkName=t.target.value)}}}):s("div",{staticStyle:{display:"inline-block","font-size":"14px","text-align":"left",color:"#17233D"},attrs:{title:e.edit&&"hm"===e.role?"双击修改备注名":""},on:{dblclick:function(t){"hm"===e.role&&e.editRemark(e.session)}}},[e.session.user.name?s("span",[e._v(e._s(e._f("ellipsis")(e.session.user.name,8)))]):s("span",[e._v(e._s(e._f("ellipsis")(e.session.user.name,5)))])]),s("span",{staticClass:"float-right"},[e._v("\n            "+e._s(e.getTimeByStatus(e.session))+"\n        ")]),"messageQueue"===e.chatListType?s("div",{staticClass:"float-right"},[e.session.family_member?s("span",{staticClass:"baby-name"},[e._v("\n            "+e._s(e._f("ellipsis")(e.session.family_member.name,8))+"\n          ")]):e._e()]):e._e()]),s("div",{staticClass:"last_msg_and_icon",staticStyle:{display:"inline-block"}},[e.session.last_message?s("span",[e._v("\n          "+e._s(e._f("ellipsis")(e.session.last_message.content,5))+"\n        ")]):e._e(),e.session.last_ask&&"ask_end"!==e.session.last_ask.status&&e.session.last_ask.round.reply_status&&"stop_reply"!==e.session.last_ask.round.reply_status?s("span",[s("el-tooltip",{attrs:{effect:"dark",content:"本回合还未回复完毕",placement:"top"}},[s("svg-icon",{attrs:{"icon-class":"waitreply"}})],1)],1):e._e(),e.session.last_ask&&"ask_end"!==e.session.last_ask.status&&e.session.last_ask.has_transfer?s("span",[s("el-tooltip",{attrs:{effect:"dark",content:e.UserListTransferStatusIcon(e.session).content,placement:"top"}},[s("i",{staticClass:"iconfont",class:e.UserListTransferStatusIcon(e.session).iconType,staticStyle:{margin:"0 0 0 5px","font-size":"11px"},style:{"background-color":e.UserListTransferStatusIcon(e.session).dotColor,"border-color":e.UserListTransferStatusIcon(e.session).borderColor,color:e.UserListTransferStatusIcon(e.session).borderColor}})])],1):e._e(),s("el-tooltip",{attrs:{effect:"dark",content:"代班服务中",placement:"top"}},[s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.session.is_replace,expression:"session.is_replace"}],staticStyle:{"margin-left":"5px"},attrs:{"icon-class":"replace"}})],1),e.session.chat_timer&&e.session.chat_timer.show_timer?s("el-tooltip",{attrs:{content:e.waitStyle(e.session).text+e.formatWaitTime,placement:"top"}},[s("svg-icon",{staticStyle:{"margin-left":"5px"},attrs:{"icon-class":e.waitStyle(e.session).iconType},on:{mouseleave:e.mouseleaveTip,mouseenter:e.mouseenterTip}})],1):e._e()],1)])],1)],1)},S=[],D=s("8f09"),j=s("8975"),O=s("802d"),$={name:"SessionCard",props:{edit:{type:Boolean,default:!1},session:{type:Object,default:function(){}}},data:function(){return{remarkEditable:!1,remarkName:"",formatWaitTime:"00:00:00",waitTimer:null}},computed:Object(r["a"])({},Object(i["c"])(["unReadCount","sessionId","chatListType","role"])),methods:{UserListTransferStatusIcon:j["UserListTransferStatusIcon"],mouseleaveTip:function(){clearInterval(this.waitTimer)},mouseenterTip:function(){this.setTimer()},classIsActive:function(e){return e.session_id===this.sessionId},waitStyle:D["e"],handleCustomer:function(e){var t={session_id:e.session_id,userId:e.user._id,babyId:e.family_member?e.family_member._id:""};this.$store.dispatch("setCustomerInfo",t)},setTimer:function(){var e=this;this.session.chat_timer&&this.session.chat_timer.start_at&&(this.formatWaitTime=this.waitTime(this.session.chat_timer.start_at),this.waitTimer=setInterval((function(){e.formatWaitTime=e.waitTime(e.session.chat_timer.start_at)}),1e3))},updateRemarkNameFun:function(e,t){var s=this,a={remark:"",remark_name:t||""};Object(O["b"])(e.user._id,a).then((function(t){s.$message({type:t.data.result?"success":"error",message:t.data.message}),t.data.result&&(s.$store.dispatch("chat/getCustomerTree",{root:!0}),s.$store.dispatch("chat/getActivedUserInfo",{id:e.user._id},{root:!0}))}))},onRemarkBlur:function(e,t){this.remarkEditable=!1,this.updateRemarkNameFun(e,t)},editRemark:function(e){this.edit&&(this.remarkEditable=!0,this.remarkName=e.user.name)},getTimeByStatus:function(e){var t="";return e.last_message&&e.last_message.created_at?(t=this.timeByIsBefore(e.last_message.created_at,"m-d","h:m"),t):t},waitTime:D["f"]}},A=$,z=(s("6c4c"),Object(p["a"])(A,I,S,!1,null,"f697ec98",null)),B=z.exports,M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"title-container",on:{click:function(t){e.boxOpen=!e.boxOpen}}},[e._t("toggleTitle"),s("div",{staticStyle:{"padding-right":"20px"}},[e.showRedCircle?s("span",{staticClass:"red_circle"}):e._e(),s("i",{staticClass:"el-icon-arrow-right",class:[e.boxOpen?"open":"close"]})])],2),e.boxOpen?s("div",[e._t("toggleContent")],2):e._e()])},L=[],E=(s("ac6a"),s("456d"),s("7514"),{name:"ToggleBox",props:{childSessions:{type:Array,default:function(){return[]}}},data:function(){return{boxOpen:!0,showRedCircle:!1}},computed:Object(r["a"])({},Object(i["c"])(["role"])),watch:{childSessions:function(){this.hasUnreadObj()}},mounted:function(){this.hasUnreadObj(),"hm"===this.role?this.boxOpen=!0:this.boxOpen=!1},methods:{hasUnreadObj:function(){var e={};this.childSessions&&this.childSessions.length>0&&(e=k.a.find(this.childSessions,(function(e){return e.un_read_count>0}))),e&&Object.keys(e).length?this.showRedCircle=!0:this.showRedCircle=!1}}}),N=E,R=(s("daf6"),Object(p["a"])(N,M,L,!1,null,"6266fe0c",null)),q=R.exports,P=s("d800"),V={name:"CustomerList",components:{PageCommon:T,SessionCard:B,ToggleBox:q},data:function(){return{searchText:""}},computed:Object(r["a"])({},Object(i["c"])(["customerTree","role"]),{cusSearchValue:{get:function(){return this.$store.state.chat.cusSearchValue},set:function(e){this.$store.commit("chat/SET_CUS_SEARCHVALUE",e)}}}),methods:{updateRemarkName:function(e,t){var s=this;Object(P["updateRemarkName"])(e.session_id,t).then((function(e){2e4===e.code&&(s.$message.success(e.data.message),s.$store.dispatch("chat/getActivedUserInfo",{},{root:!0}))}))}}},U=V,H=(s("529f"),Object(p["a"])(U,b,y,!1,null,"0ecb0b92",null)),W=H.exports,G=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("scroll-box",{staticStyle:{"padding-top":"10px",background:"#fff"},attrs:{"box-height":797}},e._l(e.msgQueue,(function(e){return s("div",{key:e.session_id},[s("session-card",{attrs:{edit:!0,session:e}})],1)})),0)},Y=[],K={name:"CustomerInDrawer",components:{SessionCard:B,ScrollBox:c["a"]},props:{},computed:Object(r["a"])({},Object(i["c"])(["msgQueue","bus_role"])),created:function(){},methods:{}},Q=K,J=Object(p["a"])(Q,G,Y,!1,null,null,null),X=J.exports,Z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chatlist_draw"},[s("scroll-box",{staticStyle:{background:"#fff"},attrs:{"box-height":740}},e._l("waiting"===e.listType?e.waitingCustomerList:"hm"===e.role?e.askingCustomerList:e.transferCustomerList,(function(e,t){return s("div",{key:t},[s("session-card",{attrs:{session:e}})],1)})),0)],1)},ee=[],te={name:"CustomerInDrawer",components:{ScrollBox:c["a"],SessionCard:B},props:{listType:{type:String,require:!0,default:""}},computed:Object(r["a"])({},Object(i["c"])(["waitingCustomerList","askingCustomerList","role","transferCustomerList"])),methods:{}},se=te,ae=Object(p["a"])(se,Z,ee,!1,null,null,null),ne=ae.exports,re=s("7b32"),ie=s("8981"),oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"time-line-wrap"},[s("div",{staticClass:"case-timeline-title"},[e._v("当前咨询轨迹")]),s("scroll-box",{staticClass:"time-line-box",attrs:{"box-height":808}},e._l(e.timeLineInfo,(function(t,a){return s("div",{key:t.created_at+a,staticClass:"case-timeline-card"},[s("div",{staticClass:"time-line"},[s("div",[s("div",{staticClass:"dot",style:{"background-color":e.switchDotStyle(t).bgColor,border:e.switchDotStyle(t).border,color:e.switchDotStyle(t).color?e.switchDotStyle(t).color:"#fff"}},[s("i",{staticClass:"iconfont",class:e.switchDotStyle(t).iconType}),s("svg-icon",{directives:[{name:"show",rawName:"v-show",value:t.is_replace,expression:"timePot.is_replace"}],staticClass:"cover_icon",attrs:{"icon-class":"yxdaiban1"}})],1)]),s("div",{staticClass:"line"}),e.answerWay(t.type,"")?s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v(e._s(t.user.name))]),s("div",[e._v("\n              "+e._s(e.answerWay(t.type,""))+"\n            ")])]),e.cardEditable&&a===e.editIndex?e.cardEditable&&a===e.editIndex?s("div",{staticClass:"card-nurse-edit"},[s("div",[s("div",[e._v("状态")]),s("div",[s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.suggestionStatus,callback:function(t){e.suggestionStatus=t},expression:"suggestionStatus"}},e._l(e.statusOptions,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),s("div",[s("div",[e._v("主诉")]),s("div",[s("el-input",{attrs:{size:"mini",type:"textarea",rows:3,placeholder:"请输入内容",maxlength:"100","show-word-limit":""},model:{value:e.main_ask,callback:function(t){e.main_ask=t},expression:"main_ask"}})],1)]),s("div",[s("div",{staticStyle:{"margin-top":"10px",width:"85px"}},[s("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.suggestionType,callback:function(t){e.suggestionType=t},expression:"suggestionType"}},e._l(e.suggestOptions,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("div",[s("el-input",{attrs:{size:"mini",type:"textarea",rows:3,placeholder:"请输入"+e.suggestType(t.suggestion_type),maxlength:"100","show-word-limit":""},model:{value:e.suggestion_input,callback:function(t){e.suggestion_input=t},expression:"suggestion_input"}})],1),s("div",{staticClass:"clearfix"},[e.showSend?s("el-button",{staticClass:"save",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:e.getEditDisabled(t).editStatus,size:"mini"},on:{click:function(s){return e.handleSave(t,a,"send")}}},[e._v("发送")]):e._e(),s("el-button",{staticClass:"save",attrs:{type:"primary",disabled:e.getEditDisabled(t).editStatus,size:"mini"},on:{click:function(s){return e.handleSave(t,a,"save")}}},[e._v("保存")])],1)])]):e._e():s("div",{staticClass:"card-nurse-show"},[s("div",[e._v("状态："+e._s(e.resolveStatus(t.status,"")))]),s("collapse-box",{attrs:{"collapse-text":t.main_ask?t.main_ask:"",title:"主诉"}}),s("collapse-box",{attrs:{"collapse-text":t.suggestion,title:t.suggestion_type?e.suggestType(t.suggestion_type):"叮嘱"}}),s("div",{staticClass:"card-edit"},[s("el-button",{attrs:{type:"text",disabled:e.getEditDisabled(t).editStatus||e.getReplaceStatus.replace&&"replace_by_other"===e.getReplaceStatus.replace.status},on:{click:function(t){return e.showEdit(a)}}},[e._v("\n                编辑\n              ")])],1)],1),s("div",{staticClass:"card-time"},[e._v("\n            "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n          ")])]):"over_time_send_suggestion"===t.type?s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v("发送叮嘱/建议")])]),s("div",{staticClass:"card-nurse-show"},[s("collapse-box",{attrs:{"collapse-text":t.suggestion,title:t.suggestion_type?e.suggestType(t.suggestion_type):"叮嘱"}})],1),s("div",{staticClass:"card-time"},[e._v("\n            "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n          ")])]):"user_transfer"===t.type||"round_apply_transfer"===t.type?s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v("用户")]),s("div",[e._v(e._s(t.title))])]),t.user_desc?s("div",{staticClass:"customer-info"},[e._v("\n            留言内容："+e._s(t.user_desc)+"\n          ")]):e._e(),s("div",{staticClass:"card-time"},[e._v("\n            "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n          ")])]):"user_ask"===t.type?s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v("用户")]),s("div",[e._v("健康咨询")])]),s("div",{staticClass:"customer-info"},[s("div",[e._v("症状："+e._s(t.ask_question_desc))]),s("div",[e._v("\n              干预史："+e._s(t.interven_desc?t.interven_desc:"无")+"\n            ")]),s("div",[e._v("\n              资料照片及视频：\n              "),0===t.ask_question_report.length?s("span",[e._v("无")]):e._e()]),t.ask_question_report.length>0?s("el-row",{staticStyle:{"margin-top":"20px"}},e._l(t.ask_question_report,(function(a,n){return s("el-col",{key:"meida"+n,attrs:{span:8}},[s("media-display-item",{attrs:{url:a.url,"media-type":a.type,"url-list":t.ask_question_report,"show-media-detail":e.showMediaDetail}})],1)})),1):e._e()],1),s("div",{staticClass:"card-time"},[e._v("\n            "+e._s(e._f("formatTime")(new Date(t.created_at)))+"\n          ")])]):s("timeLineDom",{attrs:{timePot:t}})],1)])})),0),s("monitor",{ref:"monitor",attrs:{"monitor-info":e.monitorInfo,"current-image-url-arr":e.curUrlList}}),s("Dialog",{attrs:{title:e.noSuggest?"请填写建议或叮嘱":"确认发送给用户的内容",showCancelBtn:!0,cancelText:e.noSuggest?"返回填写":"取消",hasConfirmBtn:!e.noSuggest,btnText:"确认发送",width:"460px"},on:{btnHandle:e.confirmSend},scopedSlots:e._u([{key:"content",fn:function(){return[e.noSuggest?e._e():s("div",{staticClass:"suggest"},[s("p",[e._v("\n          "+e._s(e.suggestType(e.suggestionParams.suggestion_type))+"：\n          "),s("span",[e._v(e._s(e.suggestionParams.suggestion))])]),s("p",{staticStyle:{"line-height":"20px"}},[e._v("\n          建议部分的内容会反馈给用户，请谨慎填写，如需变更，请回到当前咨询轨迹区域进行编辑\n        ")])]),e.noSuggest?s("span",{staticStyle:{"line-height":"20px"}},[e._v(e._s(e.dialogContent))]):e._e()]},proxy:!0}]),model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}})],1)},le=[],ce=(s("20d6"),s("0680")),ue=s("afce"),de=s("7962"),me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{ref:"block",class:{collapse:1===e.collapsed}},[e._v("\n    "+e._s(e.title)+":\n    "),s("span",{staticClass:"collapse_text"},[e._v(e._s(e.collapseText))])]),0!==e.collapsed?s("div",{staticClass:"collapse-tag",on:{click:e.toggle}},[e._v("\n    "+e._s(e.collapsedTag)+"\n  ")]):e._e()])},he=[],pe=(s("c5f6"),{name:"CollapseBox",props:{collapseText:{type:String,default:""},textLength:{type:Number,default:42},title:{type:String,default:""}},data:function(){return{show:!1,collapsed:0}},computed:{collapsedTag:function(){switch(this.collapsed){case 1:return"展开";case 2:return"收起";default:return""}}},methods:{toggle:function(){1===this.collapsed?this.collapsed=2:2===this.collapsed&&(this.collapsed=1)}},mounted:function(){this.$refs.block.offsetHeight>60&&(this.collapsed=1)}}),fe=pe,ge=(s("03cb"),Object(p["a"])(fe,me,he,!1,null,"8dc8669e",null)),be=ge.exports,ye=s("9039"),_e=s("7a26"),ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"card-title"},[s("div",[e._v(e._s(e.getTimeLineDom(e.timePot).name))]),s("div",[e._v("\n      "+e._s(e.getTimeLineDom(e.timePot).title)+"\n    ")])]),s("div",{staticClass:"customer-info"},[e._v("\n    "+e._s(e.getTimeLineDom(e.timePot).value)+"\n  ")]),s("div",{staticClass:"card-time"},[e._v("\n    "+e._s(e._f("formatTime")(new Date(e.timePot.created_at)))+"\n  ")])])},we=[],ke={props:{timePot:{type:Object,default:function(){}}},data:function(){return{sas:""}},methods:{getTimeLineDom:function(e){var t={},s=e.type;switch(s){case"transfer_apply":t={name:e.user.name,title:"发起转诊请求",value:"原因："+e.reason};break;case"transfer_reject":t={name:e.user.name,title:"拒绝转诊请求",value:"原因："+e.transfer_reject_reason};break;case"transfer_start":case"transfer_accept":case"voice_transfer_end":case"admin_end":case"round_append":case"system":case"user_end":t={name:"user_end"===e.type?"用户":"system"===e.type?"系统":e.user.name,title:e.title,value:""};break;default:return t}return t}}},xe=ke,Ce=Object(p["a"])(xe,ve,we,!1,null,null,null),Fe=Ce.exports,Te={name:"CaseTimeline",components:{ScrollBox:c["a"],MediaDisplayItem:ue["a"],CollapseBox:be,Dialog:ye["a"],Monitor:de["a"],timeLineDom:Fe},data:function(){return{dialogVisible:!1,suggestionParams:{id:"",status:"",suggestion_type:"",suggestion:this.suggestion_input,main_ask:"",_id:"",save_type:"save"},suggestionStatus:"",suggestionType:"",main_ask:"",babyIdChange:!1,noSuggest:!0,dialogContent:"请在当前咨询轨迹区域填写建议或叮嘱，该建议将作为此次咨询的指导方案提交给用户，请谨慎填写！",test:!0,monitorInfo:{},curUrlList:[],myLastAsk:{has_transfer:!1},cardEditable:!1,editIndex:"",suggestOptions:this.suggestType("","arr"),suggestion_input:"",statusOptions:this.resolveStatus("","arr")}},computed:Object(r["a"])({},Object(i["c"])(["timeLineInfo","activedBabyId","activedBaby","current_fdAsk","userInfo","role","lastAsk","getReplaceStatus","showSend","endedType","manageAnswer","currentTransferTextAnswer"])),watch:{lastAsk:{handler:function(e,t){(!t||t._id&&e._id!==t._id)&&this.$store.dispatch("monitorFdAskChange",this.lastAsk._id),this.myLastAsk=e||"",this.babyIdChange=!0},deep:!0},activedBabyId:{handler:function(e,t){if(e!==t&&this.setActiveInfo("sharingNotes"),t){var s={babyId:t,sug:this.suggestion_input,mainAsk:this.main_ask,editIndex:this.editIndex,cardEditable:this.cardEditable,suggestionStatus:this.suggestionStatus,suggestionType:this.suggestionType};window.sessionStorage.setItem("localSug"+t,JSON.stringify(s))}var a=window.sessionStorage.getItem("localSug"+e),n=JSON.parse(a);n&&n.babyId===this.activedBabyId?(this.suggestion_input=n.sug,this.editIndex=n.editIndex,this.cardEditable=n.cardEditable,this.main_ask=n.mainAsk,this.suggestionStatus=n.suggestionStatus,this.suggestionType=n.suggestionType):(this.suggestion_input="",this.cardEditable=!1,this.editIndex="",this.main_ask="",this.suggestionStatus="resolved",this.suggestionType="suggest")}},current_fdAsk:{handler:function(e){if(e){this.getTimeLineInfo(e);var t=window.sessionStorage.getItem("localSug"+this.activedBabyId),s=JSON.parse(t);this.babyIdChange&&s?(this.cardEditable=s.cardEditable,this.babyIdChange=!1):this.cardEditable=!1}else this.setTimeLineInfo([])}}},created:function(){this.myLastAsk=Object.assign({has_transfer:!1},this.lastAsk)},methods:Object(r["a"])({answerWay:ce["a"],resolveStatus:ce["c"],suggestType:ce["g"],confirmSend:function(){this.saveSuggestionFun()},getEditDisabled:function(e){var t=e.type,s=!0;if("none"!==this.endedType&&this.showSend){if("voice_transfer_answer"===t&&"doctor"===this.role||"text_transfer_answer"===t&&this.role===this.currentTransferTextAnswer.bus_role)s=!1;else if("text_answer"===t&&"hm"===this.role){var a=k.a.findIndex(this.timeLineInfo,(function(e){return"voice_transfer_answer"==e.type||"text_transfer_answer"===e.type}));a<0&&(s=!1)}}else if("none"===this.endedType)if(this.myLastAsk.has_transfer||"hm"!==this.role){if(this.myLastAsk.has_transfer){var n=this.myLastAsk.transfer_status;switch(n){case"apply":case"accept":"text_answer"===t&&"hm"===this.role&&(s=!1);break;case"reject":case"failed":"hm"===this.role&&(s=!1);break;case"asking":"voice_transfer_answer"===t&&this.role===this.myLastAsk.transfer_role?s=!1:"text_transfer_answer"===t&&this.role===this.myLastAsk.transfer_role&&(s=!1);break;case"start":case"end":break}}}else s=!1;return{editStatus:s}}},Object(i["b"])({getTimeLineInfo:"chat/getTimeLineInfo"}),{},Object(i["d"])({setTimeLineInfo:"chat/SET_TIMELINEINFO",setActiveInfo:"babyExtend/SET_ACTIVEINFO"}),{showEdit:function(e){this.cardEditable=!0,this.suggestion_input=this.timeLineInfo[e].suggestion,this.main_ask=this.timeLineInfo[e].main_ask,this.suggestionStatus=this.timeLineInfo[e].status,this.suggestionType=this.timeLineInfo[e].suggestion_type,this.editIndex=e},showMediaDetail:function(e,t,s){this.curUrlList="image"===t?e.filter((function(e){return"image"===e.type})).map((function(e){var t=e.url;return t})):[],this.monitorInfo={type:t,meta:{url:s}},this.$refs.monitor.show()},handleSave:function(e,t,s){var a={id:this.myLastAsk._id,status:this.suggestionStatus,suggestion_type:this.suggestionType,suggestion:this.suggestion_input,main_ask:this.main_ask,_id:e._id,save_type:s};if(this.suggestionParams=a,"send"===s)return this.noSuggest=!this.suggestion_input,void(this.dialogVisible=!0);this.saveSuggestionFun()},saveSuggestionFun:function(){var e=this;Object(P["f"])(this.suggestionParams).then((function(t){!0===t.data.result&&(e.dialogVisible=!1,e.cardEditable=!1,e.editIndex="",e.suggestion_input="",e.$message.success("保存成功"),e.getTimeLineInfo(e.current_fdAsk))}))},switchDotStyle:function(e){return Object(_e["d"])(e)}})},Ie=Te,Se=(s("0520"),Object(p["a"])(Ie,oe,le,!1,null,"d25a6a1e",null)),De=Se.exports,je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",{ref:"UL",attrs:{id:"chat_list_wrapper"}},[e._l(e.currentIMInfoMessages,(function(t,a){return s("li",{key:a,staticClass:"clearfix",class:t.fdAsk,attrs:{id:t._id,isSelfSend:t.isSelfSend,msgStatus:t.msgStatus,fdAsk:t.fdAsk}},[t.msgType||!1===t.msgOptions.show?e._e():s("div",{class:t.isSelfSend?"textRight":"textLeft"},[t.isSelfSend?e._e():s("div",{staticClass:"headImage"},[s("span",{staticClass:"user-avatar",style:{backgroundImage:"url("+t.fromAccountImage+")"}}),s("span",{staticClass:"time"},[s("span",{staticClass:"name",staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.fromAccountNick))]),e._v("\n          "+e._s(e.formatTime(t.msgTime))+"\n        ")])]),s("div",{staticClass:"msg-box"},[s("div",{staticClass:"chat-wrapper",class:t.msgOptions.type===e.MSG_ELEMENT_TYPE.IMAGE||t.msgOptions.type===e.MSG_ELEMENT_TYPE.VIDEO||t.msgOptions.type===e.MSG_ELEMENT_TYPE.VOICE?"image_wrapper":"",style:t.isSelfSend?"margin-right: 50px;":"margin-left: 50px;"},[s("chatMsg",{attrs:{msgOptions:t.msgOptions,item:t}})],1),t.msgOptions.type!==e.MSG_ELEMENT_TYPE.VOICE?s("span",{staticClass:"msg-status",class:t.msgStatus?"read-msg-status":"unread-msg-status"},[e._v(e._s(t.msgStatus?"已读":"未读"))]):e._e()]),t.isSelfSend?s("div",{staticClass:"headImage"},[s("span",{staticClass:"time"},[e._v("\n          "+e._s(e.formatTime(t.msgTime))+"\n          "),s("span",{staticClass:"name",staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.fromAccountNick))])]),s("span",{staticClass:"user-avatar",style:{backgroundImage:"url("+t.fromAccountImage+")"}})]):e._e()]),t.msgType===e.MSG_ELEMENT_TYPE.NOTICE?s("div",[s("div",{staticClass:"system-time"},[s("span",{staticClass:"margin-right-10"},[e._v(e._s(e.noticeTypeName(t.msgOptions.noticeType)))]),e._v("\n        "+e._s(e.formatTime(t.msgTime))+"\n      ")]),s("noticeMsg",{attrs:{msgBody:t.msgOptions,item:t}})],1):e._e(),a<e.currentIMInfoMessages.length-1?s("div",{attrs:{type:"flex",justify:"center"}},[e.currentIMInfoMessages[a].fdAsk!=e.currentIMInfoMessages[a+1].fdAsk?s("el-row",{staticClass:"line",attrs:{type:"flex",justify:"center"}},[s("div",{staticClass:"bottom-line"})]):e._e()],1):e._e()])})),s("monitor",{ref:"monitor",attrs:{"monitor-info":e.monitorInfo,"current-image-url-arr":e.curUploadUrlList}})],2)},Oe=[],$e=s("f41a"),Ae=s("24d7"),ze=s("6a5c"),Be={name:"ChatAreaList",components:{Monitor:de["a"],noticeMsg:Ae["a"],chatMsg:ze["a"]},data:function(){return{dialogVisible:!1,currentMediaType:"",currentMediaUrl:"",monitorInfo:{},MSG_ELEMENT_TYPE:$e["a"].MSG_ELEMENT_TYPE,currentIMInfoMessages:[],msg:Object,curUploadUrlList:[]}},computed:Object(r["a"])({},Object(i["c"])(["getCurrentIMInfoMessages","userInfo"])),watch:{getCurrentIMInfoMessages:function(e){this.currentIMInfoMessagesFormat(this.getCurrentIMInfoMessages)}},methods:{noticeTypeName:function(e){var t;switch(e){case"transfer_apply":case"transfer_accept":case"transfer_reject":t="转诊申请";break;case"round_apply_transfer":t="用户转诊意向";break;default:t=""}return t},currentIMInfoMessagesFormat:function(e){if(this.curUploadUrlList.length=0,this.currentIMInfoMessages=e,0!==e.length)for(var t=0;t<this.currentIMInfoMessages.length;t++){var s=this.currentIMInfoMessages[t].msgOptions;"image"===s.type&&s.images.oriImage&&this.curUploadUrlList.push(s.images.oriImage)}},thumbClickFun:function(e,t,s){if(this.monitorInfo={type:e,meta:{url:t}},s&&(this.curUploadUrlList=s),this.curUploadUrlList&&this.curUploadUrlList.length&&"video"!==e){var a=k.a.findIndex(this.curUploadUrlList,(function(e){return e===t}));-1===a&&this.curUploadUrlList.push(t),this.curUploadUrlList=k.a.sortedUniq(this.curUploadUrlList)}else"video"!==e?this.curUploadUrlList.push(t):this.curUploadUrlList=[];this.$refs.monitor.show()}}},Me=Be,Le=(s("c75d"),Object(p["a"])(Me,je,Oe,!1,null,"3c1f58d3",null)),Ee=Le.exports,Ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ChatInput"},[s("div",{staticClass:"header"},[s("inputTab",["ROUND"!==e.askMode?s("SendImage",{staticClass:"float-left",attrs:{slot:"image","has-server":e.ifHasServer("fd_ask"),"submit-btn-status-disabled":e.submitBtnStatusDisabled},slot:"image"}):e._e(),"ROUND"!==e.askMode?s("SendVideo",{staticClass:"float-left",attrs:{slot:"video","has-server":e.ifHasServer("fd_ask"),"submit-btn-status-disabled":e.submitBtnStatusDisabled},slot:"video"}):e._e(),s("FastReply",{staticClass:"float-left",attrs:{slot:"fastReply"},on:{ClickFastReply:e.getFastReply},slot:"fastReply"})],1)],1),"ROUND"!==e.askMode||e.showVoice?e._e():s("Bout",{ref:"boutInput",attrs:{closeBtnStatus:e.closeConsultBtnStatus||e.getReplaceStatus.replace&&"replace_by_other"===e.getReplaceStatus.replace.status},on:{closeBoutConsult:e.closeConsult}}),s("div",{staticClass:"chat-input-box"},[e.showVoice?s("div",[s("PhoneInput",{staticClass:"chat-phone-main",attrs:{"show-voice":e.lastStatus,"last-ask-id":e.lastAsk._id,"time-cha":e.timeCha,hour:e.timeCha.hours,minute:e.timeCha.minutes,second:e.timeCha.seconds},on:{doctorStartTransfer:e.doctorStart,doctorCloseTransfer:e.doctorClose}})],1):e._e(),"IM"===e.askMode?s("div",{staticClass:"chat-input-main"},[s("div",{staticClass:"body"},[s("div",{staticClass:"input-wrapper"},["enter"===e.submitCommond?s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.currentMessage,expression:"currentMessage"}],staticClass:"border-none",attrs:{id:"messgae_input",type:"textarea",autofocus:"",rows:"7",readonly:e.loading,placeholder:"请输入内容，内容不能为空"},domProps:{value:e.currentMessage},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyEnter(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.lineFeed(t):null}],input:function(t){t.target.composing||(e.currentMessage=t.target.value)}}}):e._e(),"ctrl"===e.submitCommond?s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.currentMessage,expression:"currentMessage"}],staticClass:"border-none",attrs:{id:"messgae_input",type:"textarea",autofocus:"",rows:"7",readonly:e.loading,placeholder:"请输入内容，内容不能为空"},domProps:{value:e.currentMessage},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:e.keyCtrlEnter(t):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.lineFeed(t,"enter")}],input:function(t){t.target.composing||(e.currentMessage=t.target.value)}}}):e._e()])]),s("div",{staticClass:"footer"},[s("div",{staticClass:"btn-wrapper"},[s("el-button",{staticClass:"btn",attrs:{size:"mini",plain:"",type:"primary",disabled:e.closeConsultBtnStatus||e.getReplaceStatus.replace&&"replace_by_other"===e.getReplaceStatus.replace.status},on:{click:e.closeConsult}},[e._v("结束会话")]),s("el-dropdown",{staticClass:"drop-down",staticStyle:{border:"1px solid #409EFF","border-radius":"4px"},attrs:{"split-button":"",type:"primary",size:"mini"},on:{command:e.submitCommondFun}},[e.submitBtnDisabled?s("span",{staticClass:"submitBtnDisabledTrue",on:{click:e.submitDisabled}},[e._v("发送")]):e._e(),e.submitBtnDisabled?e._e():s("span",{class:e.haveMessage?"submitBtnDisabledFalse":"submitBtnDisabledTrue",attrs:{id:"sendBtn"},on:{click:e.submitNewMsg}},[e._v("发送")]),s("el-dropdown-menu",{attrs:{slot:"dropdown",size:"mini"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"ctrl"}},[s("i",{directives:[{name:"show",rawName:"v-show",value:"ctrl"===e.submitCommond,expression:"submitCommond === 'ctrl'"}],staticClass:"el-icon-check"}),s("span",{class:"ctrl"!=e.submitCommond?"marginleft16":""},[e._v("Ctrl+Enter发送\n                ")])]),s("el-dropdown-item",{attrs:{actived:"",command:"enter"}},[s("i",{directives:[{name:"show",rawName:"v-show",value:"enter"===e.submitCommond,expression:"submitCommond === 'enter'"}],staticClass:"el-icon-check"}),s("span",{class:"enter"!=e.submitCommond?"marginleft18":""},[e._v("Enter发送\n                ")])])],1)],1)],1)])]):e._e()]),s("el-dialog",{attrs:{title:e.noSuggest?"请填写建议或叮嘱":"即将结束本次"+e.chatType,visible:e.consultDialog.dialogVisible,width:"23%",center:"","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.consultDialog,"dialogVisible",t)}}},[e.noSuggest?e._e():s("div",[s("div",{staticClass:"suggest"},[s("p",[e._v("\n          状态："),s("span",[e._v(e._s(e.suggestStatus))])]),s("p",[e._v("\n          "+e._s(e.suggestType(e.suggestion_type))+"："),s("span",[e._v(e._s(e.suggestContent))])])]),s("div",{staticClass:"tip"},[s("i",{staticClass:"el-icon-info"}),e._v("\n        建议（或叮嘱）部分的内容会反馈给用户，请谨慎填写，如需变更，请回到当前咨询轨迹区域进行编辑\n      ")])]),e.noSuggest?s("div",{staticClass:"suggest-info"},[e._v("\n      请在当前咨询轨迹区域填写建议，该建议（或叮嘱）将作为此次咨询的指导方案提交给用户，请谨慎填写！\n    ")]):e._e(),"转诊"!==e.chatType||e.noSuggest?e._e():s("div",{staticClass:"transfer-tip"},[e._v("\n      另外，请确认本次转诊是否有效？"),s("br"),e._v("\n      如确认无联系不上、意外断线等异常情况，请选择有效转诊，该用户转诊次数将自动-1；"),s("br"),e._v("\n      如有异常，请选择无效转诊按钮，将不会减少用户电话转诊次数\n    ")]),"咨询"===e.chatType?s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.noSuggest?e._e():s("el-button",{on:{click:e.handleClose}},[e._v("  取消  \n      ")]),s("el-button",{attrs:{type:"primary"},on:{click:e.confirmCloseConsulte}},[e._v(e._s(e.noSuggest?"返回填写":"确认结束"))])],1):e._e(),"转诊"===e.chatType?s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.noSuggest?e._e():s("el-button",{on:{click:function(t){return e.confirmCloseConsulte(!1)}}},[e._v("无效转诊")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmCloseConsulte(!0)}}},[e._v(e._s(e.noSuggest?"返回填写":"有效转诊"))])],1):e._e()])],1)},Re=[],qe=(s("a481"),s("96cf"),s("3b8d")),Pe=s("c443"),Ve=s("f44d"),Ue=s("51a5"),He=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"send-image"},[s("el-tooltip",{attrs:{placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e.hasServer?s("div",[e.uploading?s("p",{attrs:{loading:e.uploading}},[s("i",{staticClass:"el-icon-loading"}),e._v(" 上传中\n        ")]):s("p",[e._v("图片")])]):s("p",[e._v("该用户套餐不包含此服务")])]),s("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:!e.hasServer||e.submitBtnStatusDisabled||e.uploading,loading:e.uploading,action:"","on-error":e.handleError,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"http-request":e.uploadFunc,accept:"image/gif, image/*","before-upload":e.beforeAvatarUpload}},[s("svg-icon",{staticClass:"color-black",class:e.hasServer?"":"notAllow",attrs:{"icon-class":"photo"}})],1)],1)],1)},We=[],Ge=s("91b6"),Ye={name:"SendCustom",props:{hasServer:{type:Boolean,default:!1},submitBtnStatusDisabled:{type:Boolean,default:!0}},data:function(){return{uploading:!1}},computed:Object(r["a"])({},Object(i["c"])(["lastAsk"])),methods:{beforeAvatarUpload:function(e){var t=["image/png","image/jpeg","image/jpg","image/gif"].indexOf(e.type)>=0,s=e.size/1024/1024<3;return t||this.$message.error("图片格式不正确!"),s||this.$message.error("上传图片大小不能超过 3MB!"),t&&s},uploadFunc:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.uploading=!0,e.next=3,Object(Ge["c"])(t.file,(function(e){}));case 3:s=e.sent,s.url&&this.sendImageMsg(s);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleAvatarSuccess:function(e,t){this.uploading=!1},handleError:function(e,t){this.uploading=!1},sendImageMsg:function(e){var t=this,s=e.meta;if(this.lastAsk._id){var a={fd_ask:this.lastAsk._id,message_body:{type:"image",url:e.url,width:s.ImageWidth.value,height:s.ImageHeight.value}};Object(Pe["f"])(a).then((function(e){e.data.result?(t.$store.dispatch("pushCurrentIMInfoMessages",e.data.message),t.$store.dispatch("setBottomBtn",!1,{root:!0})):t.$message.error(e.data.message)})).catch((function(e){console.error("发送图片：",e)}))}}}},Ke=Ye,Qe=(s("f06c"),Object(p["a"])(Ke,He,We,!1,null,"6b58d210",null)),Je=Qe.exports,Xe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"send-video"},[s("el-tooltip",{attrs:{placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e.hasServer?s("div",[e.uploading?s("p",{attrs:{loading:e.uploading}},[s("i",{staticClass:"el-icon-loading"}),e._v(" 上传中\n        ")]):s("p",[e._v("发送视频")])]):s("p",[e._v("该用户套餐不包含此服务")])]),s("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:!e.hasServer||e.submitBtnStatusDisabled||e.uploading,loading:e.uploading,action:"","show-file-list":!1,"on-error":e.handleError,"on-success":e.handleAvatarSuccess,accept:"video/*","http-request":e.uploadFunc,"before-upload":e.beforeAvatarUpload}},[s("svg-icon",{staticClass:"video_icon",class:e.hasServer?"":"notAllow",attrs:{"icon-class":"scshipin"}})],1)],1)],1)},Ze=[],et={name:"SendVideo",props:{submitBtnStatusDisabled:{type:Boolean,default:!0},hasServer:{type:Boolean,default:!1}},data:function(){return{uploading:!1}},computed:Object(r["a"])({},Object(i["c"])(["lastAsk"])),methods:{beforeAvatarUpload:function(e){var t=["video/mp4","video/avi","video/flv","video/wmv","video/mkv","video/mov"].indexOf(e.type)>=0;return t||this.$message.error("支持avi、flv、mp4、wmv、mkv、mov、等视频格式"),t},uploadFunc:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(t){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.uploading=!0,this.lastAsk._id){e.next=3;break}return e.abrupt("return");case 3:return s=this.lastAsk._id,window.sessionStorage.setItem("currentFdAsk",s),e.next=7,Object(Ge["c"])(t.file,(function(e){}));case 7:a=e.sent,a.url&&this.sendVideoMsg(a);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleAvatarSuccess:function(e,t){this.uploading=!1},handleError:function(e,t){this.uploading=!1},sendVideoMsg:function(e){var t=this,s={fd_ask:sessionStorage.getItem("currentFdAsk"),message_body:{type:"video",url:e.url,cover:""}};Object(Pe["f"])(s).then((function(e){e.data.result?(t.$store.dispatch("pushCurrentIMInfoMessages",e.data.message),t.$store.dispatch("setBottomBtn",!1,{root:!0})):t.$message.error(e.data.message),window.sessionStorage.removeItem("currentFdAsk")})).catch((function(e){window.sessionStorage.removeItem("currentFdAsk"),console.error("发送视频：",e)}))}}},tt=et,st=(s("c0ab"),Object(p["a"])(tt,Xe,Ze,!1,null,"84dee09e",null)),at=st.exports,nt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fast_reply"},[s("el-tooltip",{attrs:{content:"快捷回复",placement:"top"}},[s("svg-icon",{class:e.replyBoxFlag?"color-blue":"color-black",attrs:{"icon-class":"kjhuifu"},on:{click:function(t){return t.stopPropagation(),e.showReplyBox(t)}}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.replyBoxFlag,expression:"replyBoxFlag"}],staticClass:"reply_box clearfix",on:{click:function(t){return t.stopPropagation(),e.showReplyBox(t)}}},[s("div",{staticClass:"reply_box_warp"},[s("scroll-box",{attrs:{"box-height":126}},[s("div",{staticClass:"reply_list"},e._l(e.replyList,(function(t){return s("div",{key:t._id,staticClass:"reply_list_item"},[s("span",{staticClass:"reply_value",on:{click:function(s){return s.stopPropagation(),e.ClickFastReply(t.content)}}},[e._v("\n              "+e._s(t.content)+"\n            ")]),s("span",[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"top"}},[s("svg-icon",{staticClass:"color-blue edit_btn showBtn",attrs:{"icon-class":"bj"},on:{click:function(s){return s.stopPropagation(),e.editReplyContent(t)}}})],1),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[s("svg-icon",{staticClass:"color-blue del_btn showBtn",attrs:{"icon-class":"sc"},on:{click:function(s){return s.stopPropagation(),e.delReplyContent(t)}}})],1)],1)])})),0)])],1),s("div",{staticClass:"border-bottom"}),s("div",{staticClass:"reply_input"},[s("el-row",{attrs:{gutter:24}},[s("el-col",{attrs:{span:17}},[s("el-input",{staticClass:"not_set_padding",attrs:{type:"textarea",autosize:{minRows:1,maxRows:1},size:"mini",placeholder:"请输入快捷回复内容"},model:{value:e.fastReplyContent,callback:function(t){e.fastReplyContent=t},expression:"fastReplyContent"}})],1),s("el-col",{staticClass:"col-btn",attrs:{span:6}},[s("el-button",{attrs:{type:e.fastReplyContent?"primary":"info",size:"mini",disabled:!e.fastReplyContent},on:{click:function(t){return t.stopPropagation(),e.addFastReply(t)}}},[e._v("设为回复内容")])],1)],1)],1)])],1)},rt=[],it={components:{ScrollBox:c["a"]},data:function(){return{editId:"",replyList:[],fastReplyContent:""}},computed:Object(r["a"])({},Object(i["c"])(["replyBoxFlag","userInfo"])),watch:{replyBoxFlag:function(e){}},created:function(){this.getFastReply()},methods:{getFastReply:function(){var e=this;Object(Ue["k"])().then((function(t){e.replyList=t.data}))},showReplyBox:function(){this.$store.dispatch("setReplyBoxFlag",!0)},ClickFastReply:function(e){this.$emit("ClickFastReply",e)},addFastReply:function(){var e=this,t={content:this.fastReplyContent};this.editId?Object(Ue["i"])(this.editId,t).then((function(t){if(t){e.getFastReply(),e.fastReplyContent="",e.editId="";var s="设为回复内容";e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"成功":s+"失败"})}})):Object(Ue["b"])(t).then((function(t){if(t){e.getFastReply(),e.editId="",e.fastReplyContent="";var s="设为回复内容";e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"成功":s+"失败"})}}))},editReplyContent:function(e){this.fastReplyContent=e.content,this.editId=e._id},delReplyContent:function(e){var t=this;Object(Ue["f"])(e._id).then((function(e){if(e){t.getFastReply();var s="删除";t.$message({type:e.data.result?"success":"error",message:e.data.result?s+"成功":s+"失败"})}}))}}},ot=it,lt=(s("8680"),Object(p["a"])(ot,nt,rt,!1,null,"a91429bc",null)),ct=lt.exports,ut=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"clearfix"},[s("div",{staticClass:"float-left"},[e._t("image"),e._t("video"),e._t("fastReply"),"hm"===e.role?s("transfer-diagnose",{staticClass:"float-left",attrs:{"has-server":e.ifHasServer("transfer")}}):e._e()],2),s("div",{staticClass:"float-right"},[s("MsgHistory",{staticClass:"float-right"}),"hm"===e.bus_role&&"erke"===e.department?s("health-manage",{staticClass:"float-right",attrs:{"has-server":e.ifHasServer("health_manager")}}):e._e(),"chanke"===e.department&&"doctor"===e.bus_role&&"obstetrics"===e.userInfo.fd_info.department?s("health-Follow",{staticClass:"float-right",attrs:{"has-server":e.ifHasServer("health_follow")}}):e._e(),"erke"===e.department&&"dietician"===e.bus_role?s("recipes",{staticClass:"float-right",attrs:{"has-server":e.ifHasServer("recipe_service")}}):e._e(),"erke"===e.department?s("growth-data",{staticClass:"float-right",attrs:{"baby-id":e.activedBabyId}}):e._e()],1)])},dt=[],mt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"transfer"},[s("span",[s("el-tooltip",{attrs:{content:e.hasServer?e.tipContent:"该用户套餐不包含此服务",placement:"top"}},["apply"===e.iconType?s("svg-icon",{staticClass:"transferApplyBtn",class:e.hasServer&&e.transferBtn?"":"notAllow",attrs:{"icon-class":"transfer-apply"},on:{click:e.applyTransfer}}):"accept"===e.iconType?s("svg-icon",{staticClass:"transferAcceptBtn",attrs:{"icon-class":"transfer"},on:{click:e.startTransfer}}):"success"===e.iconType?s("svg-icon",{staticClass:"transferSuccessBtn",attrs:{"icon-class":"transfer"},on:{click:e.startTransferNot}}):e._e()],1)],1),s("el-dialog",{staticClass:"transfer_dialog",attrs:{title:e.noSuggest?"请填写用户情况":"转诊请求",visible:e.diagnoseVisible,width:e.noSuggest?"20%":"30%",center:"","before-close":e.handleClose},on:{"update:visible":function(t){e.diagnoseVisible=t}}},[e.noSuggest?e._e():s("div",[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px","label-position":"top"}},[s("el-form-item",{attrs:{label:"请选择向谁发起转诊请求",prop:"user"}},[s("el-radio-group",{staticStyle:{width:"100%"},model:{value:e.ruleForm.user,callback:function(t){e.$set(e.ruleForm,"user",t)},expression:"ruleForm.user"}},e._l(e.radioChoice,(function(t,a){return s("el-radio-button",{key:t._id+a,attrs:{label:t,disabled:!e.itemDisabled(t.bus_role)||"online"!==t.online_status,border:""}},[s("div",{staticClass:"user_icon_name_status"},[s("img",{staticClass:"status_icon",attrs:{src:e.getStatusImg(t.online_status)}}),s("span",{staticClass:"user_name_status"},[e._v("\n                    "+e._s(t.name)+"   ")]),s("el-tooltip",{attrs:{disabled:e.itemDisabled(t.bus_role),content:e.itemDisabled(t.bus_role)?"":"该用户套餐不包含此服务",placement:"top"}},[s("span",{staticClass:"user_status"},[e._v(e._s(e.userStatus(t.online_status)))])])],1),"hang_up"===t.online_status?s("p",{staticClass:"hang_up_reason align-left"},[e._v("\n                "+e._s(t.hang_up_reason)+"\n              ")]):e._e(),"hang_up"===t.online_status?s("p",{staticClass:"predict_online_at align-left"},[e._v("\n                预计上线时间："+e._s(t.predict_online_at?e.formatTime(t.predict_online_at):"")+"\n              ")]):e._e()])})),1)],1),s("el-form-item",{attrs:{label:"转诊原因",prop:"reason"}},[s("el-input",{attrs:{placeholder:"请输入转诊原因",type:"textarea",maxlength:"100",rows:3,"show-word-limit":""},model:{value:e.ruleForm.reason,callback:function(t){e.$set(e.ruleForm,"reason",t)},expression:"ruleForm.reason"}})],1)],1)],1),e.noSuggest?s("div",{staticClass:"suggest-info"},[e._v("\n      请在当前转诊轨迹区域填写主诉和建议（或叮嘱）后再发起转诊申请，方便转诊成员快速了解用户情况，做出是否同意转诊的判断\n    ")]):e._e(),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small",disabled:e.transfer_button_status||e.loading},on:{click:e.confirmTransfer}},[e._v(e._s(e.noSuggest?"返回填写":"确认转诊"))])],1)]),s("Dialog",{attrs:{title:"请回复用户转诊意向",btnText:"确 定",width:"450px"},on:{btnHandle:e.closeUserIntentDialog},model:{value:e.userIntentDialog,callback:function(t){e.userIntentDialog=t},expression:"userIntentDialog"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("p",{staticClass:"margin-bottom-10"},[e._v("\n        请先回复用户转诊意向后，再发起转诊申请，及时响应用户。\n      ")])])])],1)},ht=[],pt={name:"Transfer",props:{hasServer:{type:Boolean,default:!1}},components:{Dialog:ye["a"]},data:function(){return{userIntentDialog:!1,diagnoseVisible:!1,noSuggest:!0,suggestStatus:"",suggestContent:"",iconType:"apply",transfer_button_status:!0,loading:!1,ruleForm:{user:"",reason:""},radioChoice:[],tipContent:"申请转诊",rules:{user:[{required:!0,message:"请选择向谁发起转诊请求",trigger:"blur"}],reason:[{required:!0,message:"请输入转诊原因",trigger:"blur"}]},transferBtn:!1}},computed:Object(r["a"])({},Object(i["c"])(["userInfo","currentTextAnswer","lastAsk","askMode","sessionId","serviceItem","activedBaby","activedBabyId"])),watch:{currentTextAnswer:function(e){this.suggestStatus=e&&"resolved"===e.status?"已解决":"未解决",this.suggestContent=e&&e.suggestion?e.suggestion:"",this.suggestStatus&&this.suggestContent?this.noSuggest=!1:this.noSuggest=!0},lastAsk:{handler:function(e){e&&this.transferStatus()},deep:!0},activedBaby:function(e){e&&this.getTransferBtnStatus()},radioChoice:function(e){var t=k.a.filter(e,(function(e){return"online"===e.online_status}));t&&t.length>0?this.transfer_button_status=!1:this.transfer_button_status=!0}},methods:{userStatus:j["userStatus"],getStatusImg:j["getStatusImg"],closeUserIntentDialog:function(){this.userIntentDialog=!1},showUserIntentDialog:function(){this.userIntentDialog=!0},getUserIntent:function(){"ROUND"===this.askMode&&(this.lastAsk.round.is_apply_transfer&&this.lastAsk.round.apply_transfer_handled?this.transferBtn=!0:this.lastAsk.round.is_apply_transfer&&this.lastAsk.round.is_apply_transfer&&!this.lastAsk.round.apply_transfer_handled&&(this.transferBtn=!1,this.showUserIntentDialog()))},getTransferBtnStatus:function(){this.activedBaby.is_asking?this.transferBtn=!0:this.transferBtn=!1},startTransferNot:function(){this.$message({type:"warning",message:"正在转诊中，不能发起转诊"})},transferStatus:function(){"ask_end"!==this.lastAsk.status&&this.lastAsk.has_transfer?"accept"===this.lastAsk.transfer_status?(this.iconType="accept",this.tipContent="发起转诊"):"wait_user"===this.lastAsk.transfer_status||"asking"===this.lastAsk.transfer_status||"start"===this.lastAsk.transfer_status?(this.iconType="success",this.tipContent="发起转诊"):(this.iconType="apply",this.tipContent="申请转诊"):(this.iconType="apply",this.tipContent="申请转诊")},itemDisabled:function(e){for(var t=!1,s=0;s<this.serviceItem.length;s++){if(-1!==this.serviceItem[s].indexOf(e))return t=!0,t;if("common_text_transfer"===this.serviceItem[s]||"common_voice_transfer"===this.serviceItem[s])return t=!0,t}return t},getChoiceFun:function(){var e=this;Object(Ue["j"])(this.sessionId).then((function(t){t&&2e4===t.code&&(e.radioChoice=t.data)}))},applyTransfer:function(){this.hasServer&&this.transferBtn&&("apply"!==this.lastAsk.transfer_status?(this.noSuggest?this.transfer_button_status=!1:this.getChoiceFun(),this.diagnoseVisible=!0,this.ruleForm.reason=""):this.$message({type:"warning",message:"正在申请中"}))},confirmTransfer:function(){this.noSuggest?this.handleClose():this.confirmApi()},confirmApi:function(){var e=this,t=this.lastAsk._id,s={user_id:this.ruleForm.user._id,bus_role:this.ruleForm.user.bus_role,transfer_reason:this.ruleForm.reason};this.loading=!0,this.$refs["ruleForm"].validate((function(a){a?t&&Object(Ue["p"])(t,s).then((function(t){var s="申请转诊";e.loading=!1,e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"成功":s+"失败"}),e.handleClose()})).catch((function(t){console.log(t),e.loading=!1})):e.loading=!1}))},startTransfer:function(){var e=this;this.lastAsk._id&&(this.getUserIntent(),this.transferBtn&&Object(Ue["o"])(this.lastAsk._id).then((function(t){var s="发起转诊";e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"成功":s+"失败"})})))},handleClose:function(){this.diagnoseVisible=!1}}},ft=pt,gt=(s("69e7"),Object(p["a"])(ft,mt,ht,!1,null,"499fe4ea",null)),bt=gt.exports,yt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"SendImage"},[s("el-tooltip",{attrs:{content:e.hasServer?"新建健康管理任务":"该用户套餐不包含此服务",placement:"top"}},[s("svg-icon",{class:e.hasServer?"":"notAllow",attrs:{"icon-class":"xjjkrenwu"},on:{click:e.openDrawer}})],1),s("el-drawer",{attrs:{title:"新建健康管理任务",size:"25%",modal:!1,visible:e.drawer,direction:"ltr"},on:{"update:visible":function(t){e.drawer=t},opened:e.resetForm}},[s("div",{staticClass:"drawer-content"},[s("div",{staticClass:"drawer-item"},[s("div",{staticClass:"label"},[e._v("当前用户：")]),s("div",{staticClass:"name"},[e._v(e._s(e.customerName))])]),s("div",{staticClass:"drawer-item"},[s("div",{staticClass:"label"},[e._v("宝宝：")]),s("div",{staticClass:"name"},[e._v("\n          "+e._s(e.babyName)+"\n        ")])]),s("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"服务类型：",prop:"serviceType",rules:[{required:!0,message:"请选择服务类型",trigger:"blur"}]}},[s("el-select",{model:{value:e.ruleForm.serviceType,callback:function(t){e.$set(e.ruleForm,"serviceType",t)},expression:"ruleForm.serviceType"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",{attrs:{label:"标题：",prop:"title",rules:[{required:!0,message:"请填写标题",trigger:"blur"}]}},[s("div",[s("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1)]),s("el-form-item",{attrs:{label:"备注：",prop:"desc"}},[s("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",rows:"5"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),s("el-form-item",{attrs:{prop:"executeTime",rules:[{required:!0,message:"请选择任务执行日期",trigger:"blur"}]}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            任务执行日期\n          ")]),s("div",[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择任务执行日期","picker-options":e.pickerOptions},model:{value:e.ruleForm.executeTime,callback:function(t){e.$set(e.ruleForm,"executeTime",t)},expression:"ruleForm.executeTime"}})],1)]),s("el-form-item",[s("div",{staticClass:"button-container"},[s("el-button",{attrs:{type:"primary"},on:{click:e.createTask}},[e._v("确认创建")])],1)])],1)],1)])],1)},_t=[],vt=s("7b1f"),wt={name:"SendCustom",props:{hasServer:{type:Boolean,default:!1}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},options:[{value:1,label:"科普指导"},{value:2,label:"预防提醒"},{value:3,label:"健康随访"}],uploading:!1,drawer:!1,ruleForm:{title:"",desc:"",executeTime:"",serviceType:""}}},computed:Object(r["a"])({},Object(i["c"])(["activedBaby","activedBabyId","activedUserInfo"]),{babyName:function(){var e=this.activedBaby&&this.activedBaby.family_member?this.activedBaby.family_member.name:"";return e},customerName:function(){var e=this.activedUserInfo;return e.name}}),methods:{resetForm:function(){this.$refs.ruleForm.resetFields()},openDrawer:function(){this.hasServer&&(this.drawer=!0)},closeDrawer:function(){var e=this;setTimeout((function(){e.drawer=!1}),1e3)},createTask:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var s=e.activedBabyId,a=e.ruleForm,n=a.title,r=a.desc,i=a.executeTime,o={title:n,desc:r,executeTime:i};switch(e.ruleForm.serviceType){case 1:Object(vt["h"])(s,o).then((function(t){2e4===t.code&&(e.$message.success("创建成功"),e.closeDrawer())}));break;case 2:Object(vt["i"])(s,o).then((function(t){2e4===t.code&&(e.$message.success("创建成功"),e.closeDrawer())}));break;case 3:Object(vt["g"])(s,o).then((function(t){2e4===t.code&&(e.$message.success("创建成功"),e.closeDrawer())}))}}))}}},kt=wt,xt=(s("0195"),Object(p["a"])(kt,yt,_t,!1,null,"32b4868f",null)),Ct=xt.exports,Ft=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"SendImage"},[s("el-tooltip",{attrs:{content:e.hasServer?"新建健康随访任务":"该用户套餐不包含此服务",placement:"top"}},[s("svg-icon",{class:e.hasServer?"":"notAllow",attrs:{"icon-class":"health_follow"},on:{click:e.openDrawer}})],1),s("el-drawer",{attrs:{title:"新建健康随访任务",size:"25%",modal:!1,visible:e.drawer,direction:"ltr"},on:{"update:visible":function(t){e.drawer=t},opened:e.resetForm}},[s("div",{staticClass:"drawer-content"},[s("div",{staticClass:"drawer-item"},[s("div",{staticClass:"label"},[e._v("当前用户：")]),s("div",{staticClass:"name"},[e._v(e._s(e.customerName))])]),s("div",{staticClass:"drawer-item"},[s("div",{staticClass:"label"},[e._v("患者：")]),s("div",{staticClass:"name"},[e._v("\n          "+e._s(e.babyName)+"\n        ")])]),s("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"标题：",prop:"title",rules:[{required:!0,message:"请填写标题",trigger:"blur"}]}},[s("div",[s("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1)]),s("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[s("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",rows:"5"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1),s("el-form-item",{attrs:{prop:"executeTime",rules:[{required:!0,message:"请选择任务执行日期",trigger:"blur"}]}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            任务执行日期\n          ")]),s("div",[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择任务执行日期","picker-options":e.pickerOptions},model:{value:e.ruleForm.executeTime,callback:function(t){e.$set(e.ruleForm,"executeTime",t)},expression:"ruleForm.executeTime"}})],1)]),s("el-form-item",[s("div",{staticClass:"button-container"},[s("el-button",{attrs:{type:"primary"},on:{click:e.createTask}},[e._v("确认创建")])],1)])],1)],1)])],1)},Tt=[],It=s("8aa2"),St={name:"chankeHealthFollow",props:{hasServer:{type:Boolean,default:!1}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},uploading:!1,drawer:!1,ruleForm:{title:"",remark:"",executeTime:""}}},computed:Object(r["a"])({},Object(i["c"])(["activedBaby","activedBabyId","activedUserInfo"]),{babyName:function(){var e=this.activedBaby&&this.activedBaby.family_member?this.activedBaby.family_member.name:"";return e},customerName:function(){var e=this.activedUserInfo;return e.name}}),methods:{resetForm:function(){this.$refs.ruleForm.resetFields()},openDrawer:function(){this.hasServer&&(this.drawer=!0)},closeDrawer:function(){var e=this;setTimeout((function(){e.drawer=!1}),1e3)},createTask:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var s=e.ruleForm,a=s.title,n=s.remark,r=s.executeTime,i={family_member:e.activedBabyId,title:a,remark:n,task_type:"health_follow",task_message_type:"create_task",executed_at:r};Object(It["b"])(i).then((function(t){2e4===t.data.result&&e.closeDrawer(),e.$message.success("创建成功")}))}))}}},Dt=St,jt=(s("1201"),Object(p["a"])(Dt,Ft,Tt,!1,null,"960ccb30",null)),Ot=jt.exports,$t=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"MsgHistory"},[s("el-tooltip",{attrs:{content:"聊天记录",placement:"top"}},[s("svg-icon",{attrs:{"icon-class":"liaotianjilu"},on:{click:e.handleModle}})],1),s("el-dialog",{attrs:{title:e.dialogTitle+"的聊天记录",visible:e.dialogVisible,fullscreen:e.isfullscreen,"before-close":e.handleClose,width:"863px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("el-row",{attrs:{gutter:24}},[s("el-col",{staticClass:"title",attrs:{span:20}},[e._v(e._s(e.dialogTitle+"的聊天记录"))]),s("el-col",{attrs:{span:4}},[s("button",{staticClass:"dialog__headerbtn_shrink",attrs:{type:"button","aria-label":"Close"},on:{click:e.closeFull}},[s("i",{staticClass:"el-icon-minus"})]),s("button",{staticClass:"dialog__headerbtn_full",attrs:{type:"button","aria-label":"Close"},on:{click:e.changeFull}},[s("i",{staticClass:"el-icon-full-screen"})])])],1)],1),s("div",{staticClass:"body",class:!1===e.isfullscreen?"bodyheight":""},[s("div",{staticClass:"search-box"},[s("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[s("el-row",{attrs:{gutter:24}},[s("el-col",{attrs:{span:9}},[s("el-form-item",{attrs:{label:"关键词搜索"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入关键词搜"},on:{input:e.keywordChange},model:{value:e.formInline.keyword,callback:function(t){e.$set(e.formInline,"keyword",t)},expression:"formInline.keyword"}})],1)],1),s("el-col",{attrs:{span:15}},[s("el-form-item",{attrs:{label:"咨询开始时间"}},[s("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],size:"small",clearable:""},model:{value:e.formInline.consultationTime,callback:function(t){e.$set(e.formInline,"consultationTime",t)},expression:"formInline.consultationTime"}})],1)],1)],1)],1)],1),s("div",{staticClass:"tab-box"},[s("el-tabs",{on:{"tab-click":e.tabChange},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"全部",name:"all"}},[e.formInline.keyword||e.formInline.consultationTime&&0!==e.formInline.consultationTime.length||0!==e.msgList.length?e._e():s("p",{staticClass:"color-999"},[e._v("\n              请输入搜索内容\n            ")]),s("MsgCard",{attrs:{"msg-list":e.msgList,"form-inline":e.formInline,page:e.page,keyword:e.formInline.keyword,"page-total":e.pageTotal,"search-type":e.activeName},on:{page:e.getPage,toMessage:e.handleCloseDialog,getMsgListMore:e.getMsgListMore}})],1),s("el-tab-pane",{attrs:{label:"链接",name:"link"}},[e.formInline.keyword||e.formInline.consultationTime&&0!==e.formInline.consultationTime.length||0!==e.msgList.length?e._e():s("p",{staticClass:"color-999"},[e._v("\n              请输入搜索内容\n            ")]),s("MsgCard",{attrs:{"msg-list":e.msgList,"form-inline":e.formInline,page:e.page,keyword:e.formInline.keyword,"page-total":e.pageTotal,"search-type":e.activeName},on:{page:e.getPage,toMessage:e.handleCloseDialog,getMsgListMore:e.getMsgListMore}})],1),s("el-tab-pane",{attrs:{label:"图片与视频",name:"imgAndVideo"}},[e.formInline.keyword||e.formInline.consultationTime&&0!==e.formInline.consultationTime.length||0!==e.msgList.length?e._e():s("p",{staticClass:"color-999"},[e._v("\n              暂无数据\n            ")]),s("MsgCard",{attrs:{"msg-list":e.msgList,"form-inline":e.formInline,page:e.page,keyword:e.formInline.keyword,"page-total":e.pageTotal,"search-type":e.activeName},on:{page:e.getPage,toMessage:e.handleCloseDialog,getMsgListMore:e.getMsgListMore}})],1)],1)],1)])])],1)},At=[],zt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"refmsgCard",staticClass:"msg-card"},[s("p",{directives:[{name:"show",rawName:"v-show",value:"imgAndVideo"!==e.searchType&&0!==e.msgList.length,expression:"searchType !== 'imgAndVideo' && msgList.length !== 0"}],staticClass:"tip",domProps:{innerHTML:e._s(e.tip)}}),s("p",{directives:[{name:"show",rawName:"v-show",value:e.keyword&&0===e.msgList.length||e.formInline.consultationTime&&e.formInline.consultationTime.length>0&&0===e.msgList.length,expression:"\n      (keyword && msgList.length === 0) ||\n        (formInline.consultationTime &&\n          formInline.consultationTime.length > 0 &&\n          msgList.length === 0)\n    "}]},[e._v("\n    没有找到相关记录\n  ")]),e.msgList.length>0?s("div",{staticClass:"infinite-list-wrapper"},["imgAndVideo"!==e.searchType?s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"list",attrs:{"infinite-scroll-immediate":"disabled"}},e._l(e.msgList,(function(t,a){return s("li",{key:a},[s("el-row",{class:e.searchType,attrs:{gutter:24}},[s("el-col",{attrs:{span:2}},[s("img",{staticClass:"head-Img",attrs:{src:t.imgUrl,alt:""}})]),s("el-col",{class:e.searchType+"-right",attrs:{span:22}},[s("p",{staticClass:"color-999 align-left"},[s("span",[e._v(e._s(t.name))]),s("span",{staticClass:"fontsize-10 margin-left-20"},[e._v(e._s(t.time?e.formatTime(t.time):"-"))])]),s("msgType",{attrs:{item:t,keyword:e.keyword,msgType:t.content.type},on:{goMsg:e.goMessageDetail}})],1)],1)],1)})),0):e._e(),"imgAndVideo"===e.searchType&&e.imageArr.length>0?s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"list",attrs:{"infinite-scroll-immediate":"disabled"}},e._l(e.imageArr,(function(t,a){return s("li",{key:a,staticStyle:{margin:"0 10px"}},[s("div",{staticClass:"clearfix",class:e.searchType},[s("div",{class:e.searchType+"-right"},[s("p",{staticClass:"color-999 align-left",staticStyle:{"margin-left":"10px"}},[e._v("\n              "+e._s(t[0]?t[0].time:"-")+"\n            ")]),e._l(t,(function(t,n){return s("span",{key:t+a+n,staticClass:"image-box"},["image"===t.content.type?s("img",{attrs:{span:5,src:t.content.url,alt:""},on:{click:function(s){return e.goMessageDetail(t)}}}):e._e(),"video"===t.content.type?s("div",{staticClass:"cardVideoContent",attrs:{span:5},on:{click:function(s){return e.goMessageDetail(t)}}},[s("img",{attrs:{src:t.content.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg","data-src":t.content.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg",alt:""}}),s("i",{staticClass:"el-icon-video-play"})]):e._e()])}))],2)])])})),0):e._e(),e.loading?s("p",[e._v("加载中...")]):e._e(),e.noMore?s("p",[e._v("没有更多了")]):e._e()]):e._e()])},Bt=[],Mt=(s("8615"),s("ed08")),Lt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{clss:"msg_type_page"}},["text"===e.msgType?s("p",{staticClass:"align-left content",domProps:{innerHTML:e._s(e.brightenKeyword(e.item.content.content,e.keyword))},on:{click:function(t){return e.goMessage(e.item)}}},[e._v("\n    "+e._s(e.item.content.content)+"\n  ")]):e._e(),"link"===e.msgType?s("div",{staticClass:"align-left content"},[s("p",{staticClass:"link",domProps:{innerHTML:e._s(e.brightenKeyword(e.item.content.content,e.keyword))},on:{click:function(t){return e.toURL(e.item.content.content)}}})]):e._e(),"image"===e.msgType?s("div",{staticClass:"image-box",on:{click:function(t){return e.goMessage(e.item)}}},[s("img",{attrs:{src:e.item.content.url,alt:""}})]):e._e(),"robot_card"===e.msgType||"round_msg"===e.msgType?s("div",{staticClass:"card_msg"},e._l(e.item.content.content,(function(t,a){return s("div",{key:t.ask_type?t.ask_type+a:a},[s("BoutCard",{attrs:{title:e.item.content.title,reAsk:"re_ask"===e.item.content.content[0].ask_type,boutCard:e.boutCardData(t,e.item.accountType,a,e.item.msgOptions),msgTime:e.item.msgTime},on:{showDetail:function(t){return e.goMessage(e.item)},goMsgDetail:function(t){return e.goMessage(e.item)}}}),a<e.item.content.content.length-1&&"re_ask"!==e.item.content.content[0].ask_type?s("p",{class:e.item.isSelfSend?"chat_divider":"chat_divider_left"}):e._e()],1)})),0):e._e(),"voice"===e.msgType?s("div",{staticClass:"image-box",on:{click:function(t){return e.goMessage(e.item)}}},[e._v("\n    语音消息，点击查看详情\n  ")]):e._e(),"video"===e.msgType?s("div",{staticClass:"image-box",on:{click:function(t){return e.goMessage(e.item)}}},[s("div",{staticClass:"VideoContent"},[s("img",{attrs:{src:e.item.content.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg","data-src":e.item.content.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg",alt:""}}),s("i",{staticClass:"el-icon-video-play"})])]):e._e(),"voicecard"===e.msgType&&e.item.content.url?s("div",{staticClass:"image-box",on:{click:function(t){return e.goMessage(e.item)}}},[s("p",[e._v("录音消息，点击查看详情")])]):e._e(),"voicecard"!==e.msgType||e.item.content.url?e._e():s("div",{staticClass:"image-box"},[s("p",[e._v("录音待上传，请稍后查看")])]),"card"===e.msgType?s("div",{staticClass:"image-box",on:{click:function(t){return e.goMessage(e.item)}}},[s("p",[e._v("卡片消息，点击查看详情")])]):e._e(),"notice"===e.msgType||"suggestion"===e.msgType||"comment"===e.msgType?s("div",{staticClass:"align-left",on:{click:function(t){return e.goMessage(e.item)}}},["transfer_accept"===e.item.content.notice_type?s("SystemContent",{staticStyle:{"text-align":"left"},attrs:{"msg-type":e.item.show_in_admin?"systemWarnning":"systemInfo",content:e.item.content.content},domProps:{innerHTML:e._s(e.brightenKeyword(e.item.content.content||e.item.content.title,e.keyword))}}):s("div",[s("div",{staticClass:"image-box",on:{click:function(t){return e.goMessage(e.item)}}},[e._v("\n        系统消息，点击查看详情\n      ")])])],1):e._e()])},Et=[],Nt=s("92f3"),Rt=s("7160"),qt={components:{SystemContent:Rt["a"],BoutCard:Nt["a"]},props:{msgType:{type:String,default:""},keyword:{type:String,default:""},item:{type:Object,default:function(){}}},data:function(){return{}},methods:{brightenKeyword:Mt["a"],boutCardData:j["boutCardData"],goMessage:function(e){this.$emit("goMsg",e)},toURL:function(e){e&&window.open(e)}}},Pt=qt,Vt=(s("a66e"),Object(p["a"])(Pt,Lt,Et,!1,null,"694d0070",null)),Ut=Vt.exports,Ht={components:{msgType:Ut},props:{formInline:{type:Object,default:function(){}},keyword:{type:String,default:""},searchType:{type:String,default:"all"},msgList:{type:Array,default:function(){return[]}},pageTotal:{type:Number,default:0},page:{type:Number,default:1}},data:function(){return{loading:!1,pagesize:10,pageSizes:0,noMore:"",tip:"",imageArr:[]}},computed:Object(r["a"])({},Object(i["c"])(["activedBaby","getCurrentIMInfoMessages"]),{disabled:function(){return this.loading||this.noMore}}),watch:{msgList:function(e){this.getTipFun(),"imgAndVideo"===this.searchType&&this.getImageArr()},pageTotal:function(){this.pageSizes=this.pageTotal%this.pagesize===0?this.pageTotal/this.pagesize:this.pageTotal/this.pagesize+1}},created:function(){this.getTipFun()},methods:{goMessageDetail:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$emit("toMessage",t),e.next=3,this.$store.dispatch("goMessageDetail",t.id);case 3:this.$store.dispatch("setBottomBtn",!0,{root:!0});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getImageArr:function(){this.imageArr.length=0,this.imageArr=Object.values(this.msgList.reduce((function(e,t){return e[t.time]?e[t.time].push(t):e[t.time]=[t],e}),{}))},brightenKeyword:Mt["a"],getTipFun:function(){var e=this.keyword?this.pageTotal+"条与“"+this.keyword+"”相关的内容":"";this.tip=this.brightenKeyword(e,this.keyword)},loadMore:function(){this.page<=this.pageSizes&&(this.loading=!0,this.$emit("page"),this.$emit("getMsgListMore"),this.loading=!1)}}},Wt=Ht,Gt=(s("d3b1"),Object(p["a"])(Wt,zt,Bt,!1,null,"c205caa0",null)),Yt=Gt.exports,Kt=s("b775");function Qt(e){return Object(Kt["a"])({url:"/fd/health_ask/chat/message_search",method:"get",params:e})}var Jt={name:"MsgHistory",components:{MsgCard:Yt},data:function(){return{dialogVisible:!1,dialogTitle:"",isfullscreen:!1,formInline:{keyword:"",consultationTime:[]},activeName:"all",timeout:null,msgList:[],page:1,pageTotal:0,pagesize:20}},computed:Object(r["a"])({},Object(i["c"])(["activedBabyId","currentSession"])),watch:{activedBabyId:function(){this.dialogVisible||(this.activeName="all",this.titleFormat())},"formInline.consultationTime":function(e){this.keywordChange()}},methods:{handleCloseDialog:function(e){this.handleClose()},titleFormat:function(){var e=this.currentSession,t=e.family_member;this.dialogTitle=t&&t.name?t.name:"",this.formInline={keyword:"",consultationTime:[]}},changeFull:function(){this.isfullscreen=!0},closeFull:function(){this.isfullscreen=!1},handleModle:function(){this.dialogVisible=!0,this.getMsgList()},handleClose:function(){this.dialogVisible=!1,this.page=1,this.pageTotal=0,this.msgList=[]},tabChange:function(){this.formInline.keyword="",this.formInline.consultationTime=[],this.page=1,this.pageTotal=0,this.msgList=[]},getMsgList:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.activedBabyId){e.next=2;break}return e.abrupt("return");case 2:if(this.formInline.keyword||"imgAndVideo"===this.activeName||this.formInline.consultationTime&&0!==this.formInline.consultationTime.length){e.next=4;break}return e.abrupt("return");case 4:return t={family_member:this.activedBabyId,search_key:this.formInline.keyword,current_page:this.page,page_size:this.pagesize,start_at:this.formInline.consultationTime&&this.formInline.consultationTime.length>0?this.formatTime(this.formInline.consultationTime[0]):"",end_at:this.formInline.consultationTime&&this.formInline.consultationTime.length>0?this.formatTime(this.formInline.consultationTime[1]):"",message_type:"all"===this.activeName?"":"link"===this.activeName?"link":"image"},e.next=7,Qt(t).then((function(e){var t=e.data;return s.pageTotal=t.count,s.msgList&&0!==s.msgList.length?void(t.list&&t.list.length>0?t.list.forEach((function(e,t){s.msgList.push(e)})):1===s.page&&0===t.list.length&&(s.msgList=[])):void(s.msgList=t.list)}));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getPage:function(){this.page++},keywordChange:function(){this.page=1,this.msgList=[],this.pageTotal=0,this.getMsgList()},getMsgListMore:function(){this.getMsgList()}}},Xt=Jt,Zt=(s("824d"),Object(p["a"])(Xt,$t,At,!1,null,"d7df1eb8",null)),es=Zt.exports,ts=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"SendImage"},[s("el-tooltip",{attrs:{content:e.hasServer?"新建定制食谱任务":"该用户套餐不包含此服务",placement:"top"}},[s("svg-icon",{class:e.hasServer?"":"notAllow",attrs:{"icon-class":"xjdzshipu"},on:{click:e.openDrawer}})],1),s("el-drawer",{staticClass:"drawer-content",attrs:{title:"新建定制食谱任务",size:"25%",modal:!1,visible:e.drawer,direction:"ltr"},on:{"update:visible":function(t){e.drawer=t},opened:e.resetForm}},[s("div",{staticClass:"drawer-content"},[s("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"当前用户："}},[s("el-input",{attrs:{disabled:""},model:{value:e.customerName,callback:function(t){e.customerName=t},expression:"customerName"}})],1),s("el-form-item",{attrs:{label:"宝宝："}},[s("el-input",{attrs:{disabled:""},model:{value:e.activedBaby.name,callback:function(t){e.$set(e.activedBaby,"name",t)},expression:"activedBaby.name"}})],1),s("el-form-item",{attrs:{label:"月龄："}},[s("el-input",{attrs:{disabled:""},model:{value:e.activedBaby.age_of_month,callback:function(t){e.$set(e.activedBaby,"age_of_month",t)},expression:"activedBaby.age_of_month"}})],1),s("el-form-item",{attrs:{label:"模板名称：",prop:"recipe_template",rules:[{required:!0,message:"请选择服务类型",trigger:"change"}]}},[s("el-select",{on:{change:e.getRecipesTitle},model:{value:e.ruleForm.recipe_template,callback:function(t){e.$set(e.ruleForm,"recipe_template",t)},expression:"ruleForm.recipe_template"}},e._l(e.templateDic,(function(e){return s("el-option",{key:e._id,attrs:{label:e.title,value:e._id}})})),1)],1),s("el-form-item",{attrs:{label:"食谱名称：",prop:"title",rules:[{required:!0,message:"请填写食谱名称",trigger:"blur"}]}},[s("div",[s("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1)]),s("el-form-item",{attrs:{label:"备注：",prop:"desc"}},[s("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",rows:"5",resize:"none"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),s("el-form-item",{attrs:{prop:"executeTime",rules:[{required:!0,message:"请选择任务执行日期",trigger:"blur"}]}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            任务执行日期\n          ")]),s("div",[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择任务执行日期","picker-options":e.pickerOptions},model:{value:e.ruleForm.executeTime,callback:function(t){e.$set(e.ruleForm,"executeTime",t)},expression:"ruleForm.executeTime"}})],1)]),s("el-form-item",{staticClass:"form-btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.createTask}},[e._v("确认创建")])],1)],1)],1)])],1)},ss=[],as=s("1e42"),ns={name:"SendCustom",props:{hasServer:{type:Boolean,default:!1}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},uploading:!1,drawer:!1,ruleForm:{title:"",desc:"",executeTime:"",recipe_template:""}}},computed:Object(r["a"])({},Object(i["c"])(["activedBaby","activedBabyId","activedUserInfo","templateDic"]),{customerName:function(){var e=this.activedUserInfo;return e.name}}),mounted:function(){this.getTemplateDic()},methods:Object(r["a"])({},Object(i["b"])({getTemplateDic:"recipes/getTemplateDic"}),{getRecipesTitle:function(e){var t=this;this.templateDic.forEach((function(s){s._id===e&&(t.ruleForm.title=s.title)}))},resetForm:function(){this.$refs.ruleForm.resetFields()},openDrawer:function(){this.hasServer&&(this.drawer=!0)},closeDrawer:function(){var e=this;setTimeout((function(){e.drawer=!1}),1e3)},createTask:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var s=e.activedBabyId;Object(as["d"])(s,e.ruleForm).then((function(t){2e4===t.code?(e.$message.success("任务创建成功"),e.closeDrawer()):e.$message.warning("任务创建失败")}))}))}})},rs=ns,is=(s("f0c3"),Object(p["a"])(rs,ts,ss,!1,null,"a63d98ca",null)),os=is.exports,ls=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"grow-data"},[s("el-tooltip",{attrs:{content:"宝宝生长数据",placement:"top"}},[s("el-badge",[s("svg-icon",{attrs:{"icon-class":"bbszshuju"},on:{click:e.openDrawer}})],1)],1),s("el-drawer",{staticClass:"drawer-content",attrs:{title:"宝宝生长数据",size:"32%",visible:e.drawer,direction:"rtl",modal:!1},on:{"update:visible":function(t){e.drawer=t}}},[s("div",{staticClass:"drawer-content"},[s("div",{staticStyle:{padding:"30px"}},[s("div",{staticClass:"baby-info-container"},[s("div",{staticClass:"baby"},[s("div",{staticClass:"label"},[e._v("\n              宝宝:\n            ")]),s("div",{staticClass:"name"},[e._v("\n              "+e._s(e.babyName)+"\n            ")])]),s("div",{staticClass:"user"},[s("div",{staticClass:"label"},[e._v("\n              当前用户:\n            ")]),s("div",{staticClass:"name"},[e._v("\n              "+e._s(e.userName)+"\n            ")])])]),s("div",{staticClass:"button-container"},[s("div",[s("el-button",{attrs:{disabled:!e.operateData,type:"text"},on:{click:e.handleAdd}},[e._v("\n              添加一条生长数据\n            ")])],1),s("div",[s("el-button",{attrs:{type:"text",disabled:!e.operateData},on:{click:e.handleEdit}},[e._v("\n              修改\n            ")]),s("el-button",{attrs:{type:"text",disabled:!e.operateData},on:{click:e.handleDelete}},[e._v("\n              删除\n            ")])],1)]),s("el-table",{attrs:{data:e.tableData,height:"750px","header-cell-style":{background:"#F5F7FA"}}},[s("el-table-column",{attrs:{"header-align":"center",align:"center",label:"宝宝月龄",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticStyle:{display:"flex"}},[s("div",[s("el-radio",{attrs:{label:t.row._id},nativeOn:{change:function(s){return e.getTemplateRow(t.$index,t.row)}},model:{value:e.selectRadio,callback:function(t){e.selectRadio=t},expression:"selectRadio"}},[e._v(" ")])],1),s("div",{staticStyle:{width:"100px"}},[e._v("\n                  "+e._s(t.row.year)+" 岁 "+e._s(t.row.month)+" 月\n                  "+e._s(t.row.day)+" 天\n                ")])])]}}])}),s("el-table-column",{attrs:{"header-align":"center",align:"center",label:"身高/身长（cm）百分位（%）",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.height,!0))}}),e._v("\n                 cm"),s("br"),0===t.row.height_type?s("span",[e._v("\n                  ("),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.height_from_percent,!1))}}),e._v("% 到\n                  "),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.height_to_percent,!1))}}),e._v("\n                  %)\n                ")]):s("span",[e._v("\n                  (\n                  "),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.height_percent,!1))}}),e._v("\n                  %)\n                ")])])]}}])}),s("el-table-column",{attrs:{"header-align":"center",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.weight,!0))}}),e._v("\n                 kg"),s("br"),0===t.row.weight_type?s("span",[e._v("\n                  ("),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.weight_from_percent,!1))}}),e._v("% 到\n                  "),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.weight_to_percent,!1))}}),e._v("%)\n                ")]):s("span",[e._v("\n                  ("),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.weight_percent,!1))}}),e._v("%)\n                ")])])]}}])},[s("template",{slot:"header"},[s("div",[s("div",[e._v("体重（kg）")]),s("div",[e._v("百分位（%）")])])])],2),s("el-table-column",{attrs:{"header-align":"center",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.head,!0))}}),e._v(" cm"),s("br"),0===t.row.head_type?s("span",[e._v("\n                  ("),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.head_from_percent,!1))}}),e._v("% 到\n                  "),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.head_to_percent,!1))}}),e._v("%)\n                ")]):s("span",[e._v("\n                  ("),s("span",{domProps:{innerHTML:e._s(e.makePlaceHolder(t.row.head_percent,!1))}}),e._v("%)\n                ")])])]}}])},[s("template",{slot:"header"},[s("div",[s("div",[e._v("头围（cm）")]),s("div",[e._v("百分位（%）")])])])],2)],1)],1)])]),s("el-dialog",{attrs:{title:"未选中生长数据",visible:e.dialogVisible,width:"25%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("span",[e._v("请先选中某个月龄的一条生长数据再进行修改或删除操作")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("返回选择")])],1)]),s("el-dialog",{attrs:{title:"删除宝宝生长数据",visible:e.deleteConfirm,width:"30%"},on:{"update:visible":function(t){e.deleteConfirm=t}}},[s("span",[e._v("删除后该条数据将从宝宝生长数据列表中移除，请确认是否继续删除")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.deleteGrowthData}},[e._v("删除")])],1)]),s("el-dialog",{attrs:{title:"add"===e.addOrEditStatus?"添加宝宝生长数据":"修改宝宝生长数据",visible:e.addOrEditVisible,width:"40%"},on:{"update:visible":function(t){e.addOrEditVisible=t},opened:e.resetRuleForm}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"100px","label-position":"left"}},[s("el-form-item",{attrs:{label:"宝宝月龄",prop:"year",rules:[{required:!0,message:"请输入宝宝月龄",trigger:"blur"},{validator:e.checkTaskTime,trigger:"blur"}]}},[s("div",{staticClass:"age-flex-box"},[s("div",{staticClass:"age-container"},[s("el-input",{attrs:{placeholder:"请填写自然数",size:"mini"},on:{input:function(t){return e.setNumber(t,"year")}},model:{value:e.ruleForm.year,callback:function(t){e.$set(e.ruleForm,"year",e._n(t))},expression:"ruleForm.year"}}),e._v("  岁\n          ")],1),s("div",{staticClass:"age-container"},[s("el-input",{ref:"month",attrs:{placeholder:"请填写0-12的整数",size:"mini"},on:{input:function(t){return e.setNumber(t,"month")}},model:{value:e.ruleForm.month,callback:function(t){e.$set(e.ruleForm,"month",e._n(t))},expression:"ruleForm.month"}}),e._v("  月\n          ")],1),s("div",{staticClass:"age-container"},[s("el-input",{ref:"day",attrs:{placeholder:"请填写0-31的整数",size:"mini"},on:{input:function(t){return e.setNumber(t,"day")}},model:{value:e.ruleForm.day,callback:function(t){e.$set(e.ruleForm,"day",e._n(t))},expression:"ruleForm.day"}}),e._v("  天\n          ")],1)])]),s("el-form-item",{attrs:{label:"身高/身长",prop:"height"}},[s("div",{staticClass:"age-flex-box"},[s("div",{staticClass:"age-container"},[s("el-input",{attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setNumber(t,"sc")},blur:function(t){return e.toFixedNum(t,"sc")},change:function(t){return e.toFixedNum(t,"sc")}},model:{value:e.ruleForm.height,callback:function(t){e.$set(e.ruleForm,"height",t)},expression:"ruleForm.height"}}),e._v("  (cm)\n          ")],1),s("div",{staticClass:"range-select"},[e._v("\n                \n            "),s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.ruleForm.height_type,callback:function(t){e.$set(e.ruleForm,"height_type",t)},expression:"ruleForm.height_type"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0===e.ruleForm.height_type?s("div",{staticClass:"range-container"},[s("div",{staticClass:"range-item"},[e._v("\n              百分位  \n              "),s("el-input",{ref:"heightFromPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"scpf")}},model:{value:e.ruleForm.height_from_percent,callback:function(t){e.$set(e.ruleForm,"height_from_percent",e._n(t))},expression:"ruleForm.height_from_percent"}})],1),s("div",{staticClass:"range-item",staticStyle:{"margin-left":"-5px"}},[e._v("\n              %到  \n              "),s("el-input",{ref:"heightToPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"scpt")}},model:{value:e.ruleForm.height_to_percent,callback:function(t){e.$set(e.ruleForm,"height_to_percent",e._n(t))},expression:"ruleForm.height_to_percent"}}),e._v("  %\n            ")],1)]):s("div",{staticClass:"value-container"},[s("div",{staticClass:"value-item"},[e._v("\n              百分位  \n              "),s("el-input",{ref:"heightPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"scp")}},model:{value:e.ruleForm.height_percent,callback:function(t){e.$set(e.ruleForm,"height_percent",e._n(t))},expression:"ruleForm.height_percent"}}),e._v("  %\n            ")],1)])])]),s("el-form-item",{attrs:{label:"体重",prop:"weight"}},[s("div",{staticClass:"age-flex-box"},[s("div",{staticClass:"age-container"},[s("el-input",{attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setNumber(t,"tz")},blur:function(t){return e.toFixedNum(t,"tz")},change:function(t){return e.toFixedNum(t,"tz")}},model:{value:e.ruleForm.weight,callback:function(t){e.$set(e.ruleForm,"weight",t)},expression:"ruleForm.weight"}}),e._v("   (kg)\n          ")],1),s("div",{staticClass:"range-select"},[e._v("\n                \n            "),s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.ruleForm.weight_type,callback:function(t){e.$set(e.ruleForm,"weight_type",t)},expression:"ruleForm.weight_type"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0===e.ruleForm.weight_type?s("div",{staticClass:"range-container"},[s("div",{staticClass:"range-item"},[e._v("\n              百分位  \n              "),s("el-input",{ref:"weightFromPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"tzpf")}},model:{value:e.ruleForm.weight_from_percent,callback:function(t){e.$set(e.ruleForm,"weight_from_percent",e._n(t))},expression:"ruleForm.weight_from_percent"}})],1),s("div",{staticClass:"range-item",staticStyle:{"margin-left":"-5px"}},[e._v("\n              %到  \n              "),s("el-input",{ref:"weightToPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"tzpt")}},model:{value:e.ruleForm.weight_to_percent,callback:function(t){e.$set(e.ruleForm,"weight_to_percent",e._n(t))},expression:"ruleForm.weight_to_percent"}}),e._v("  %\n            ")],1)]):s("div",{staticClass:"value-container"},[s("div",{staticClass:"value-item"},[e._v("\n              百分位  \n              "),s("el-input",{ref:"weightPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"tzp")}},model:{value:e.ruleForm.weight_percent,callback:function(t){e.$set(e.ruleForm,"weight_percent",e._n(t))},expression:"ruleForm.weight_percent"}}),e._v("  %\n            ")],1)])])]),s("el-form-item",{attrs:{label:"头围",prop:"head"}},[s("div",{staticClass:"age-flex-box"},[s("div",{staticClass:"age-container"},[s("el-input",{attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setNumber(t,"tw")},blur:function(t){return e.toFixedNum(t,"tw")},change:function(t){return e.toFixedNum(t,"tw")}},model:{value:e.ruleForm.head,callback:function(t){e.$set(e.ruleForm,"head",t)},expression:"ruleForm.head"}}),e._v("  (cm)\n          ")],1),s("div",{staticClass:"range-select"},[e._v("\n                \n            "),s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.ruleForm.head_type,callback:function(t){e.$set(e.ruleForm,"head_type",t)},expression:"ruleForm.head_type"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0===e.ruleForm.head_type?s("div",{staticClass:"range-container"},[s("div",{staticClass:"range-item"},[e._v("\n              百分位  \n              "),s("el-input",{ref:"headFromPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"twpf")}},model:{value:e.ruleForm.head_from_percent,callback:function(t){e.$set(e.ruleForm,"head_from_percent",e._n(t))},expression:"ruleForm.head_from_percent"}})],1),s("div",{staticClass:"range-item",staticStyle:{"margin-left":"-5px"}},[e._v("\n              %到  \n              "),s("el-input",{ref:"headToPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"twpt")}},model:{value:e.ruleForm.head_to_percent,callback:function(t){e.$set(e.ruleForm,"head_to_percent",e._n(t))},expression:"ruleForm.head_to_percent"}}),e._v("  %\n            ")],1)]):s("div",{staticClass:"value-container"},[s("div",{staticClass:"value-item"},[e._v("\n              百分位  \n              "),s("el-input",{ref:"headPercent",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.setPercent(t,"twp")}},model:{value:e.ruleForm.head_percent,callback:function(t){e.$set(e.ruleForm,"head_percent",e._n(t))},expression:"ruleForm.head_percent"}}),e._v("  %\n            ")],1)])])])],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"align-center"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddOrEdit}},[e._v(e._s("add"===e.addOrEditStatus?"确认添加":"确认修改"))])],1)])],1)],1)},cs=[];function us(e){return Object(Kt["a"])({url:"/baby_growth_data/create",method:"post",data:e})}function ds(e){return Object(Kt["a"])({url:"/baby_growth_data/list/".concat(e),method:"get"})}function ms(e){return Object(Kt["a"])({url:"/baby_growth_data/destroy/".concat(e),method:"delete"})}function hs(e,t){return Object(Kt["a"])({url:"/baby_growth_data/edit/".concat(e),method:"put",data:t})}var ps={components:{},props:{babyId:{type:String,default:""},hasServer:{type:Boolean,default:!1}},data:function(){return{babyName:"",userName:"",addOrEditStatus:"add",options:[{value:0,label:"范围"},{value:1,label:"值"}],ruleForm:{year:"",month:"",day:"",height:"",height_type:0,height_from_percent:"",height_to_percent:"",height_percent:"",weight:"",weight_type:0,weight_from_percent:"",weight_to_percent:"",weight_percent:"",head:"",head_type:0,head_from_percent:"",head_to_percent:"",head_percent:""},deleteConfirm:!1,dialogVisible:!1,addOrEditVisible:!1,drawer:!1,selectRadio:null,tableData:[]}},computed:{operateData:function(){return"hm"===this.$store.state.user.bus_role}},watch:{},mounted:function(){},methods:{makePlaceHolder:function(e,t){return t?e?e.toFixed(2):"<span style='color: red'>-</span>":e||"<span style='font-size: 8px;color: red'> - </span>"},setNumber:function(e,t){"tz"===t&&(Number(e)||(this.ruleForm.weight="")),"sc"===t&&(Number(e)||(this.ruleForm.height="")),"tw"===t&&(Number(e)||(this.ruleForm.head="")),"year"===t&&(Number(e)||0===Number(e)||(this.ruleForm.year="")),"month"===t&&(Number(e)||0===Number(e)||(this.ruleForm.month="")),"day"===t&&(Number(e)||0===Number(e)||(this.ruleForm.day=""))},setPercent:function(e,t){"scpf"===t&&(Number(e)||(this.ruleForm.height_from_percent="")),"scpt"===t&&(Number(e)||(this.ruleForm.height_to_percent="")),"scp"===t&&(Number(e)||(this.ruleForm.height_percent="")),"tzpf"===t&&(Number(e)||(this.ruleForm.weight_from_percent="")),"tzpt"===t&&(Number(e)||(this.ruleForm.weight_to_percent="")),"tzp"===t&&(Number(e)||(this.ruleForm.weight_percent="")),"twpf"===t&&(Number(e)||(this.ruleForm.head_from_percent="")),"twpt"===t&&(Number(e)||(this.ruleForm.head_to_percent="")),"twp"===t&&(Number(e)||(this.ruleForm.head_percent=""))},toFixedNum:function(e,t){e&&("tz"===t&&Number(e)&&(this.ruleForm.weight=Number(e).toFixed(2)),"sc"===t&&Number(e)&&(this.ruleForm.height=Number(e).toFixed(2)),"tw"===t&&Number(e)&&(this.ruleForm.head=Number(e).toFixed(2)))},resetRuleForm:function(){this.$refs.ruleForm.clearValidate()},getGrowthList:function(){var e=this;ds(this.babyId).then((function(t){if(2e4===t.code){var s=t.data;e.tableData=s.list,e.babyName=k.a.get(s,"baby.name"),e.userName=k.a.get(s,"baby.user.nickname")}}))},checkTaskTime:function(e,t,s){var a=this.$refs.month.value,n=this.$refs.day.value;""!==t&&""!==a&&""!==n||s(new Error("请填写全部宝宝月龄")),a>12&&s(new Error("任务月龄月数不能大于12")),n>31&&s(new Error("任务月龄天数不能大于31")),s()},confirmAddOrEdit:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;"add"===e.addOrEditStatus?(e.ruleForm.family_member=e.babyId,us(e.ruleForm).then((function(t){2e4===t.code&&(e.$message.success("新增成功"),e.addOrEditVisible=!1,e.getGrowthList(),e.selectRadio=null)}))):hs(e.selectRadio,e.ruleForm).then((function(t){2e4===t.code&&(e.$message.success("修改成功"),e.addOrEditVisible=!1,e.getGrowthList(),e.selectRadio=null)}))}))},deleteGrowthData:function(){var e=this;ms(this.selectRadio).then((function(t){2e4===t.code&&(e.$message.success("删除成功"),e.deleteConfirm=!1,e.getGrowthList(),e.selectRadio=null)}))},handleAdd:function(){this.addOrEditStatus="add",this.selectRadio=null,this.ruleForm={year:"",month:"",day:"",height:"",height_type:0,height_from_percent:"",height_to_percent:"",height_percent:"",weight:"",weight_type:0,weight_from_percent:"",weight_to_percent:"",weight_percent:"",head:"",head_type:0,head_from_percent:"",head_to_percent:"",head_percent:""},this.addOrEditVisible=!0},handleEdit:function(){this.selectRadio?(this.addOrEditStatus="edit",this.addOrEditVisible=!0):this.dialogVisible=!0},handleDelete:function(){this.selectRadio?this.deleteConfirm=!0:this.dialogVisible=!0},getTemplateRow:function(e,t){this.ruleForm=k.a.cloneDeep(t),this.ruleForm=k.a.pick(this.ruleForm,["year","month","day","height","height_type","height_from_percent","height_to_percent","height_percent","weight","weight_type","weight_from_percent","weight_to_percent","weight_percent","head","head_type","head_from_percent","head_to_percent","head_percent"])},openDrawer:function(){this.selectRadio=null,this.drawer=!0,this.getGrowthList()}}},fs=ps,gs=(s("602b"),s("bf56"),Object(p["a"])(fs,ls,cs,!1,null,"5ef289a6",null)),bs=gs.exports,ys={props:{},components:{"transfer-diagnose":bt,MsgHistory:es,HealthManage:Ct,HealthFollow:Ot,Recipes:os,GrowthData:bs},data:function(){return{department:""}},computed:Object(r["a"])({},Object(i["c"])(["activedBabyId","activedBaby","role","bus_role","userInfo"])),created:function(){this.getDeprtment()},watch:{activedBaby:{handler:function(){this.getDeprtment()},deep:!0}},methods:{ifHasServer:_e["c"],getDeprtment:function(){this.department=this.activedBaby&&this.activedBaby.family_member?this.activedBaby.family_member.type:""}}},_s=ys,vs=(s("2bc0"),Object(p["a"])(_s,ut,dt,!1,null,"0cb8ca35",null)),ws=vs.exports,ks=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"phone_input"},[e.status?s("p",{staticClass:"phone"},[e._v("\n    请用"+e._s(e.customPhone)+"拨打"),s("span",[e._v(e._s(e.userPhone))])]):e._e(),s("p",{staticClass:"tip margin-top-10"},[e._v(e._s(e.tip))]),s("p",{staticClass:"button_p"},[s("el-button",{attrs:{type:"primary",disabled:e.loading,size:"small"},on:{click:e.startTransfer}},[e._v(e._s(e.btnTxt))]),e.status?s("span",{staticClass:"awite-time"},[s("span",{staticClass:"tip"},[e._v("电话接诊中：")]),s("span",{staticClass:"time-style"},[e._v(e._s(e.hour))]),s("span",{staticClass:"time-unit"},[e._v(":")]),s("span",{staticClass:"time-style"},[e._v(e._s(e.minute))]),s("span",{staticClass:"time-unit"},[e._v(":")]),s("span",{staticClass:"time-style"},[e._v(e._s(e.second))])]):e._e()],1)])},xs=[],Cs={props:{showVoice:{type:Boolean,default:!1},lastAskId:{type:String,default:""},hour:{type:String,default:"00"},minute:{type:String,default:"00"},second:{type:String,default:"00"}},data:function(){return{loading:!1,customPhone:"13000000000",userPhone:"12555444555",status:!1,time:"",tip:"请您单击下方【开始电话转诊】按钮绑定号码后，根据提示拨打电话开始电话转诊",btnTxt:"开始电话转诊"}},computed:Object(r["a"])({},Object(i["c"])(["lastAsk"])),watch:{showVoice:function(e){e&&this.isStartPhone()}},mounted:function(){this.showVoice&&this.isStartPhone()},methods:{isStartPhone:function(){var e=this;Object(Ue["l"])(this.lastAskId).then((function(t){t.data.result&&(e.customPhone=t.data.from,e.userPhone=t.data.to,e.status=!0,e.tip="请您单击下方【结束电话转诊】的按钮，结束此次电话转诊",e.btnTxt="结束电话转诊",e.$emit("doctorStartTransfer"),e.$store.dispatch("chat/getCustomerTree"))}))},startTransfer:function(){var e=this;if(this.loading=!0,this.status)return this.$emit("doctorCloseTransfer",""),void(this.loading=!1);var t=this.lastAsk._id;Object(Ue["h"])(t).then((function(t){e.loading=!1,t&&t.data.result&&(e.customPhone=t.data.from,e.userPhone=t.data.to,e.status=!0,e.tip="请您单击下方【结束电话转诊】的按钮，结束此次电话转诊",e.btnTxt="结束电话转诊",e.$emit("doctorStartTransfer"),e.$store.dispatch("chat/getCustomerTree"))})).catch((function(t){console.log(t),e.loading=!1}))}}},Fs=Cs,Ts=(s("52337"),Object(p["a"])(Fs,ks,xs,!1,null,"18b878b2",null)),Is=Ts.exports,Ss=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bout-input-box"},[s("p",{staticClass:"tip-content"},[e._v("\n    温馨提示：该用户套餐中限制了每次咨询的提问次数，不限制回复次数，需要您单击【回复完毕】按钮以后，用户才可以继续提问！\n  ")]),e._l(e.answerList,(function(t,a){return s("div",{key:"answerList"+a,staticClass:"answer"},[s("div",{staticClass:"textarea_wrap"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"item.content"}],attrs:{type:"textarea",autofocus:"",rows:"4"},domProps:{value:t.content},on:{input:function(s){s.target.composing||e.$set(t,"content",s.target.value)}}}),s("span",{staticClass:"limit_box"},[e._v(" "+e._s(e.currentLength)+"/"+e._s(e.maxLength)+" ")])]),s("el-row",[s("el-col",{attrs:{span:22}},[s("UploaderList",{attrs:{max:9,width:"50px",height:"50px"},model:{value:t.media,callback:function(s){e.$set(t,"media",s)},expression:"item.media"}})],1)],1)],1)})),s("el-row",[s("el-col",{staticClass:"count-box align-left",class:e.hasTransfer?"":"no-transfer",attrs:{span:8}},[e.hasTransfer?s("div",[e.lastRound.transfer?s("span",[e._v("\n          本次转诊回合数\n          "),s("span",{staticClass:"span_val"},[e._v("\n            "+e._s(e.lastRound.transfer.round_num)+"/"+e._s(e.lastRound.transfer.round_limit)+"\n          ")]),s("el-tooltip",{attrs:{content:"当前回合/回合数上限",placement:"top"}},[s("i",{staticClass:"el-icon-info"})])],1):e._e()]):e._e(),s("div",[e.lastRound&&e.lastRound.ask?s("span",[e._v("\n          本次咨询回合数\n          "),s("span",{staticClass:"span_val"},[e._v(e._s(e.lastRound.ask.round_num)+"/"+e._s(e.lastRound.ask.round_limit))]),s("el-tooltip",{attrs:{content:"当前回合/回合数上限",placement:"top"}},[s("i",{staticClass:"el-icon-info"})])],1):e._e()])]),s("el-col",{staticClass:"align-right",attrs:{span:16}},[s("el-button",{attrs:{size:"mini",type:"primary",disabled:e.replyEndBtnDiabeled},on:{click:e.replyEndFun}},[e._v("回复完毕")]),s("el-button",{attrs:{size:"mini",type:"primary",disabled:e.addBtnIsAppend},on:{click:e.showAddBoutDialog}},[e._v("追加回合")]),s("el-button",{staticClass:"close-btn",attrs:{size:"mini",type:"primary",disabled:e.closeBtnDisabled,plain:""},on:{click:e.closeBoutConsult}},[e._v("\n        结束咨询\n      ")]),s("el-button",{attrs:{size:"mini",disabled:!e.previewBtnStatus,type:"primary",loading:e.repyLoading},on:{click:e.preview}},[e._v("发送")])],1)],1),s("AddboutDialog",{attrs:{addBoutVisible:e.addBoutVisible},on:{addBoutConfirm:e.addBoutConfirm,addBoutCancel:e.addBoutCancel}})],2)},Ds=[],js=s("dc16"),Os=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-bout-dialog"},[s("el-dialog",{attrs:{title:"申请追加回合",visible:e.addBoutVisible,width:"30%",center:""},on:{close:e.addBoutCancel}},[s("el-row",[s("el-col",{attrs:{span:2}},[s("i",{staticClass:"el-icon-warning fontsize-20"})]),s("el-col",{attrs:{span:22}},e._l(e.contentText,(function(t,a){return s("p",{key:"contentText"+a,staticClass:"content-text"},[e._v("\n          "+e._s(t)+"\n        ")])})),0)],1),s("div",{staticClass:"reason-box"},[s("p",{staticClass:"title"},[e._v("追加原因")]),s("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"请输入内容"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addBoutCancel}},[e._v("\n        取消\n      ")]),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addBoutConfirm}},[e._v("\n        确认申请\n      ")])],1)],1)],1)},$s=[],As={props:{addBoutVisible:{type:Boolean,default:!1}},data:function(){return{reason:"",contentText:["1、该功能仅针对复杂问题，实在无法在回合内完成的情况下使用！申请成功后，可不限回合次数，只能由服务人员结束，无需用户确认。","2、请慎重使用该功能，避免用户后续依赖该功能，造成服务成本增加的问题！","3、套餐回合结束后将无法申请！"]}},methods:{addBoutConfirm:function(){this.reason?this.$emit("addBoutConfirm",this.reason):this.$message.warning("追加原因不能为空")},addBoutCancel:function(){this.$emit("addBoutCancel")}}},zs=As,Bs=(s("4398"),Object(p["a"])(zs,Os,$s,!1,null,null,null)),Ms=Bs.exports,Ls={components:{UploaderList:js["a"],AddboutDialog:Ms},props:{closeBtnStatus:{type:Boolean,default:!1}},computed:Object(r["a"])({},Object(i["c"])(["lastAsk","askMode","activedBaby","activedBabyId","getReplaceStatus","role"])),data:function(){return{currentLength:0,maxLength:2e3,addBoutVisible:!1,addBtnIsAppend:!0,repyLoading:!1,previewBtnStatus:!1,replyEndBtnDiabeled:!0,hasTransfer:!1,closeBtnDisabled:!0,hasAsking:!1,lastRound:{},answerList:[{content:"",media:[]}]}},watch:{lastAsk:{handler:function(e){e&&this.initPage()},deep:!0},answerList:{handler:function(e){Object(Mt["j"])(this.activedBabyId,JSON.stringify(e)),this.currentLength=e[0].content.length,this.currentLength>=2e3&&(this.currentLength=2e3,this.answerList[0].content=e[0].content.substring(0,2e3))},deep:!0},getReplaceStatus:function(){this.getBtnStatus()}},created:function(){this.initPage()},methods:{replyEndFun:function(){var e=this;"pending_reply"!==this.lastRound.reply_status?Object(Pe["h"])(this.lastAsk._id).then((function(t){e.$store.dispatch("chat/getLastAsk")})):this.$message.warning("请先回复用户")},initPage:function(){this.lastAsk&&(this.lastRound=this.lastAsk.round,this.hasAsking=this.lastAsk.status&&"ask_end"!==this.lastAsk.status,this.hasTransfer=this.lastAsk.has_transfer&&"start"===this.lastAsk.transfer_status||"asking"===this.lastAsk.transfer_status),this.getCacheData(),this.getBtnStatus()},getBtnStatus:function(){this.hasAsking?(this.closeBtnDisabled=!(this.lastRound&&this.lastRound.is_append&&this.lastRound.can_append),this.hasTransfer?this.role===this.lastAsk.transfer_role?(this.previewBtnStatus=this.lastRound.can_reply,this.addBtnIsAppend=this.lastRound.is_append):(this.previewBtnStatus=!1,this.addBtnIsAppend=!0):"hm"===this.role?(this.previewBtnStatus=this.lastRound.can_reply,this.addBtnIsAppend=this.lastRound.is_append):(this.previewBtnStatus=!1,this.closeBtnDisabled=!0,this.addBtnIsAppend=!0),this.getReplaceStatus.replace&&"replace_by_other"===this.getReplaceStatus.replace.status&&(this.previewBtnStatus=!1),this.replyEndBtnDiabeled=!(this.previewBtnStatus&&"stop_reply"!==this.lastRound.reply_status)):(this.replyEndBtnDiabeled=!0,this.closeBtnDisabled=!0,this.previewBtnStatus=!1,this.addBtnIsAppend=!0)},getCacheData:function(){var e=this;this.$nextTick((function(){var t=Object(Mt["i"])(e.activedBabyId);e.activedBabyId&&t?e.answerList=JSON.parse(t):e.resetAnswerList()}))},closeBoutConsult:function(){this.$emit("closeBoutConsult","bout")},addBoutCancel:function(){this.addBoutVisible=!1},showAddBoutDialog:function(){this.addBoutVisible=!0},addBoutConfirm:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(t){var s,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(Ve["a"])(this.lastAsk._id,{reason:t});case 2:s=e.sent,a=s.message,n=s.data,this.$message({type:n.result?"success":"error",message:n.result?"追加回合成功":a}),n.result&&this.addBoutCancel();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),resetAnswerList:function(){this.answerList=[{content:"",media:[]}]},preview:function(){var e=this.answerList.findIndex((function(e){return!e.content}));-1!==e||""===this.answerList[0].content.trim()?this.$message.warning("未检测到您输入的诊断内容，请输入后进行发送！"):this.confirmReply()},confirmReply:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return localStorage.removeItem(this.activedBabyId),t={fd_ask:this.lastAsk._id?this.lastAsk._id:"",message_body:{type:"round_msg",content:this.answerList}},this.repyLoading=!0,this.$store.dispatch("setTrigger","m",{root:!0}),e.next=6,Object(Pe["f"])(t).then((function(e){s.repyLoading=!1,e.data.result?(s.$store.dispatch("pushCurrentIMInfoMessages",e.data.message),s.$store.dispatch("setBottomBtn",!1,{root:!0}),s.resetAnswerList()):s.$message.error(e.data.message)})).catch((function(e){s.repyLoading=!1,console.log(e)}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},Es=Ls,Ns=(s("b1f3"),Object(p["a"])(Es,Ss,Ds,!1,null,"68d3e77a",null)),Rs=Ns.exports,qs={name:"ChatInput",components:{SendImage:Je,SendVideo:at,PhoneInput:Is,FastReply:ct,inputTab:ws,Bout:Rs},data:function(){return{time1:"",submitCommond:"enter",currentMessage:"",chatType:"咨询",closeType:"",closeConsultBtnStatus:!0,noSuggest:!1,suggestStatus:"未解决",suggestion_type:"suggestion",suggestContent:"",submitBtnDisabled:!0,submitBtnStatusDisabled:!0,haveMessage:!1,loading:!1,lastStatus:!1,timeCha:{hours:"",minutes:"",seconds:""},showVoice:!1,consultDialog:{title:"即将结束本次咨询",dialogVisible:!1},babyId:this.$route.query.id}},computed:Object(r["a"])({},Object(i["c"])(["currentTextAnswer","currentVoiceAnswer","currentTransferTextAnswer","habit","currentBabyList","activedBabyId","userInfo","activedBaby","lastAsk","getReplaceStatus","askMode","role"])),watch:{currentMessage:function(e){e&&(this.setSubmitBtnDisabled(),this.getSubmitBtnIsDisabled()),e&&!this.submitBtnStatusDisabled?this.haveMessage=!0:this.haveMessage=!1},habit:function(e){this.submitCommond=this.habit.submitCommond?this.habit.submitCommond:"ctrl"},lastAsk:{handler:function(e,t){this.initPage()},deep:!0},currentTextAnswer:function(){this.showSuggestDialog()},currentVoiceAnswer:function(){this.showSuggestDialog()},currentTransferTextAnswer:function(){this.showSuggestDialog()},activedBabyId:function(e,t){if(this.closeConsultBtnStatus=!0,t){var s={babyId:t,msg:this.currentMessage};window.sessionStorage.setItem("localMsg"+t,JSON.stringify(s))}var a=window.sessionStorage.getItem("localMsg"+e),n=JSON.parse(a);n&&n.babyId===e?this.currentMessage=n.msg:this.currentMessage="",this.submitCommond=this.habit.submitCommond?this.habit.submitCommond:"ctrl"}},created:function(){},methods:Object(r["a"])({ifHasServer:_e["c"]},Object(i["b"])({getUserInfo:"user/getInfo"}),{initPage:function(){this.lastAsk&&Object.keys(this.lastAsk).length>0&&(console.log("this.lastAsk",this.lastAsk),this.closeBtnIsDisabled(),this.showVoiceFun(),this.setSubmitBtnDisabled(),this.getSubmitBtnIsDisabled(),clearInterval(this.time1),this.setTimeCount())},lineFeed:function(e,t){"enter"!==t&&(e.preventDefault(),this.currentMessage=this.currentMessage+"\n")},setSubmitBtnDisabled:function(){this.activedBaby.is_asking?this.submitBtnDisabled=!1:this.submitBtnDisabled=!0},getFastReply:function(e){if("IM"!==this.askMode){var t=this.$refs.boutInput.answerIndex||0;this.$refs.boutInput.answerList[t].content+=e}else this.currentMessage+=e},showSuggestDialog:function(){this.chatType="咨询";var e=this.currentTextAnswer;this.lastAsk&&this.lastAsk.transfer_wait_user_at&&this.lastAsk.has_transfer&&"doctor_voice"===this.lastAsk.transfer_type?(e=this.currentVoiceAnswer,this.chatType="转诊"):this.lastAsk&&this.lastAsk.transfer_wait_user_at&&this.lastAsk.has_transfer&&"doctor_text"===this.lastAsk.transfer_type?(e=this.currentTransferTextAnswer,this.chatType="咨询"):this.lastAsk&&this.lastAsk.has_transfer&&"dietician_text"===this.lastAsk.transfer_type&&(e=this.currentTransferTextAnswer,this.chatType="咨询"),e?(this.suggestStatus="resolved"===e.status?"已解决":"未解决",this.suggestion_type=e.suggestion_type,this.suggestContent=e.suggestion?e.suggestion:"",this.suggestStatus&&this.suggestContent?this.noSuggest=!1:this.noSuggest=!0):this.noSuggest=!0},setTimeCount:function(){var e=this;this.timeCha=this.waitTime(this.lastAsk.transfer_asking_at,"obj"),this.time1=setInterval((function(){e.timeCha=e.waitTime(e.lastAsk.transfer_asking_at,"obj")}),1e3)},waitTime:D["f"],suggestType:ce["g"],showVoiceFun:function(){this.lastAsk.family_member!==this.activedBabyId||!this.lastAsk.has_transfer||"ask_end"===this.lastAsk.status||"start"!==this.lastAsk.transfer_status&&"asking"!==this.lastAsk.transfer_status||"doctor_voice"!==this.lastAsk.transfer_type||this.lastAsk.transfer_role!==this.role?this.showVoice=!1:(this.showVoice=!0,"asking"===this.lastAsk.transfer_status?this.lastStatus=!0:this.lastStatus=!1)},doctorStart:function(){this.chatType="转诊"},doctorClose:function(){this.closeConsult()},closeBtnIsDisabled:function(){this.activedBaby.is_asking?this.lastAsk&&"asking"===this.lastAsk.status&&!this.lastAsk.has_transfer&&"hm"===this.role?this.closeConsultBtnStatus=!1:this.lastAsk&&"pending_close"===this.lastAsk.status?this.closeConsultBtnStatus=!0:this.lastAsk&&"asking"===this.lastAsk.status&&this.lastAsk.has_transfer?this.role!==this.lastAsk.transfer_role||"start"!==this.lastAsk.transfer_status&&"asking"!==this.lastAsk.transfer_status?this.transfer_role!==this.role&&"start"!==this.lastAsk.transfer_status&&"wait_user"!==this.lastAsk.transfer_status&&"asking"!==this.lastAsk.transfer_status&&"hm"===this.role?this.closeConsultBtnStatus=!1:"apply"===this.lastAsk.transfer_status&&"hm"===this.role?this.closeConsultBtnStatus=!1:this.closeConsultBtnStatus=!0:this.closeConsultBtnStatus=!1:this.closeConsultBtnStatus=!0:this.closeConsultBtnStatus=!0},getSubmitBtnIsDisabled:function(){!this.lastAsk||"asking"!==this.lastAsk.status&&"pending_ask"!==this.lastAsk.status&&"pending_close"!==this.lastAsk.status||"hm"!==this.role?this.lastAsk&&"asking"===this.lastAsk.status&&this.lastAsk.has_transfer&&("start"!==this.lastAsk.transfer_status&&"asking"!==this.lastAsk.transfer_status||this.role!==this.lastAsk.transfer_role?"hm"===this.role?this.submitBtnStatusDisabled=!1:this.submitBtnStatusDisabled=!0:this.submitBtnStatusDisabled=!1):this.submitBtnStatusDisabled=!1},keyEnter:function(e){this.closeBtnIsDisabled(),this.setSubmitBtnDisabled(),this.getSubmitBtnIsDisabled(),"enter"!==this.submitCommond||this.submitBtnDisabled||this.loading||!this.haveMessage||(this.loading=!0,this.submitNewMsg(),e.preventDefault())},keyCtrlEnter:function(e){this.closeBtnIsDisabled(),this.setSubmitBtnDisabled(),this.getSubmitBtnIsDisabled(),"ctrl"!==this.submitCommond||this.submitBtnDisabled||this.loading||!this.haveMessage||(this.loading=!0,this.submitNewMsg(),e.preventDefault())},msgIsLink:Mt["k"],handleClose:function(){this.consultDialog.dialogVisible=!1,this.showSuggestDialog()},confirmCloseConsulte:function(e){this.noSuggest?this.handleClose():"咨询"===this.chatType?"bout"===this.closeType?this.closeBoutConsult():this.confirmCloseConsult():"转诊"===this.chatType&&this.endDoctorVoiceApi(e)},closeBoutConsult:function(){var e=this;Object(Ve["b"])(this.lastAsk._id).then((function(t){t.data.result&&(e.$message({type:t.data.result?"success":"error",message:t.data.message}),e.handleClose())}))},endDoctorVoiceApi:function(e){var t=this;Object(Ue["g"])(this.lastAsk._id,{is_transfer_valid:e}).then((function(s){if(s&&s.data.result){var a="电话转诊结束，转诊次数扣除成功",n="电话转诊结束，减免转诊次数成功";t.$message({type:"success",message:e?a:n}),t.handleClose(),t.$store.dispatch("chat/getCustomerTree")}else{var r="电话转诊结束失败，转诊扣除操作失败",i="电话转诊结束失败，减免转诊次数失败";t.$message({type:"error",message:e?r:i})}}))},confirmCloseConsult:function(){var e=this;Object(Pe["c"])(this.lastAsk._id).then((function(t){var s="结束会话";e.$message({type:t.data.result?"success":"error",message:t.data.result?s+"请求成功，待用户确认":s+"请求失败，待用户确认"}),e.handleClose()}))},submitCommondFun:function(e){var t=this;e&&(this.submitCommond=e);var s={habit_key:"submitCommond",habit_value:this.submitCommond};Object(Pe["b"])(s).then((function(e){t.$message({type:e&&e.data.result?"success":"error",message:e.message}),t.getUserInfo()}))},submitDisabled:function(){this.activedBaby.is_asking||this.$message({type:"warning",message:"当前用户未在咨询中，您不能主动向用户发起对话"})},submitNewMsg:function(){var e=Object(qe["a"])(regeneratorRuntime.mark((function e(t){var s,a,n,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.submitBtnStatusDisabled){e.next=2;break}return e.abrupt("return");case 2:if(this.submitBtnDisabled=!0,s=this.currentMessage.replace(/(^\s*)|(\s*$)/g,""),this.currentMessage&&!(s.length<=0)){e.next=9;break}return this.$message.error("请输入内容后发送"),this.currentMessage="",this.loading=!1,e.abrupt("return");case 9:if(this.lastAsk._id){e.next=12;break}return this.$message.error("当前对话的用户fd_ask为null,请联系相关人员处理"),e.abrupt("return");case 12:return a=this.lastAsk._id,window.sessionStorage.setItem("currentFdAsk",a),n=this.msgIsLink(this.currentMessage)?"link":"text",r={fd_ask:sessionStorage.getItem("currentFdAsk"),message_body:{type:n,content:this.currentMessage}},e.next=18,Object(Pe["f"])(r).then((function(e){i.loading=!1,i.submitBtnDisabled=!1,i.currentMessage=" ",e.data.result?(window.sessionStorage.removeItem("currentFdAsk"),i.$store.dispatch("setBottomBtn",!1,{root:!0}),i.$store.dispatch("pushCurrentIMInfoMessages",e.data.message)):(window.sessionStorage.removeItem("currentFdAsk"),i.$message.error(e.data.message))})).catch((function(e){i.loading=!1,i.submitBtnDisabled=!1}));case 18:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),closeConsult:function(e){this.closeType="bout"===e?"bout":"im",this.showSuggestDialog(),this.consultDialog.dialogVisible=!0}})},Ps=qs,Vs=(s("2275"),Object(p["a"])(Ps,Ne,Re,!1,null,"bc21813c",null)),Us=Vs.exports,Hs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[e.lastAsk&&e.lastAsk.family_member===e.activedBabyId&&(e.lastAsk.has_transfer||"failed"===e.lastAsk.transfer_status)&&"ask_end"!==e.lastAsk.status?s("span",{staticClass:"transfer_status_box",class:e.diagnoseStatue&&"IM"!==e.askMode?"round-diagnose-status":e.diagnoseStatue?"im-diagnose-status":""},[s("span",{staticClass:"text"},[e._v(e._s(e.diagnoseStatue))]),e.timeCha?s("span",{staticClass:"awite-time"},[s("span",{staticClass:"time-style"},[e.timeCha.hours?s("span",[e._v(e._s(e.timeCha.hours))]):e._e()]),s("span",{staticClass:"time-unit"},[e._v(":")]),s("span",{staticClass:"time-style"},[e._v(e._s(e.timeCha.minutes))]),s("span",{staticClass:"time-unit"},[e._v(":")]),s("span",{staticClass:"time-style"},[e._v(e._s(e.timeCha.seconds))])]):e._e()]):e._e()])])},Ws=[],Gs={data:function(){return{transferStatus:!1,diagnoseStatue:"",time:{startTime:"",endTime:""},transferTimer:"",timeCha:""}},computed:Object(r["a"])({},Object(i["c"])(["askMode","lastAsk","activedBabyId","role"])),watch:{lastAsk:{handler:function(e){if(e){var t=this.lastAsk.transfer_status,s=this.lastAsk.transfer_user,a=this.lastAsk.transfer_type,n=!!this.lastAsk.is_transfer_auto_accept&&this.lastAsk.is_transfer_auto_accept;this.diagnoseStatue=this.TransferStatusText(t,s,a,n,this.role),this.time=this.TransferStatusTime(t,this.lastAsk,n,this.role),this.transferTimer&&clearInterval(this.transferTimer),this.timeFormatter()}},deep:!0}},mounted:function(){this.timeFormatter()},methods:{TransferStatusText:j["TransferStatusText"],TransferStatusTime:j["TransferStatusTime"],countTime:Mt["b"],waitTime:D["f"],timeFormatter:function(){var e=this;this.time&&this.time.startTime&&this.time.endTime?(this.timeCha=this.countTime(this.time.startTime,this.time.endTime),this.transferTimer=setInterval((function(){e.timeCha=e.countTime(e.time.startTime,e.time.endTime)}),1e3)):this.time&&this.time.startTime&&!this.time.endTime?(this.timeCha=this.waitTime(this.time.startTime,"obj"),this.transferTimer=setInterval((function(){e.timeCha=e.waitTime(e.time.startTime,"obj")}),1e3)):this.timeCha="",this.timeCha&&(this.timeCha.seconds||this.timeCha.minutes)||clearInterval(this.transferTimer)}}},Ys=Gs,Ks=(s("2a9e"),Object(p["a"])(Ys,Hs,Ws,!1,null,null,null)),Qs=Ks.exports,Js=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"GoBottom",on:{click:function(t){return e.goBottom(e.step)}}},[a("img",{staticStyle:{width:"11px"},attrs:{src:s("c83b"),alt:""}}),e._v("\n  直达最新消息\n")])},Xs=[],Zs={name:"GoBottom",props:{step:{type:Number,default:550}},data:function(){return{}},mounted:function(){},methods:{goBottom:function(e){this.$emit("goBottom")}}},ea=Zs,ta=(s("8fae"),Object(p["a"])(ea,Js,Xs,!1,null,null,null)),sa=ta.exports,aa=s("cd4a"),na=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("span",{staticClass:"ask-status"},["closed"===e.currentSession.chat_status?s("span",[e._v("\n      已结束\n    ")]):s("span",[e._v("\n      "+e._s(e.getStatusText(e.currentSession.last_message.content))+"\n    ")])])])},ra=[],ia=(s("28a5"),{data:function(){return{}},computed:Object(r["a"])({},Object(i["c"])(["currentSession"])),mounted:function(){},methods:{getStatusText:function(e){var t=e?e.split("[")[1].split("]")[0]:"";return e?t:""}}}),oa=ia,la=(s("c776"),Object(p["a"])(oa,na,ra,!1,null,null,null)),ca=la.exports,ua={components:{"app-header":aa["a"],askingStatus:ca,transferStatus:Qs,messageQueue:X,customerList:W,userInfo:g,Drawer:re["a"],Extend:ie["a"],CaseTimeline:De,CustomerInDrawer:ne,chatArea:Ee,ChatInput:Us,GoBottom:sa},data:function(){return{MSG_ELEMENT_TYPE:$e["a"].MSG_ELEMENT_TYPE,readTimer:!1,haveReadFlag:!1,box:"",msgAudio:"",quickList:!1,drawerWidth:"100%",activeList:"messageQueue",listType:"",chatMessage:"",beforeScrollTop:"",direction:"",oldtrigger:""}},computed:Object(r["a"])({},Object(i["c"])(["askMode","role","scrollBottomBtn","noMessageFlag","msgQueue","trigger","current_fdAsk","currentSession","activedBabyId","lastAsk","waitingCustomerList","askingCustomerList","getCurrentIMInfoMessages","transferCustomerList"])),created:function(){var e={type:"init",babyId:this.$route.query.babyId||"",userId:this.$route.query.userId||"",messageId:this.$route.query.messageId||"",sessionId:this.$route.query.sessionId||""};this.$store.dispatch("chat/getCustomerTree",e,{root:!0})},watch:{trigger:function(e,t){this.oldtrigger=t},activeList:function(e){e&&(this.$store.commit("chat/SET_CHAT_LIST_TYPE",e,{root:!0}),this.$store.dispatch("chat/getCustomerTree","",{root:!0}))},currentSession:function(e,t){var s=!1;t?t&&e.session_id!==t.session_id?s=!0:t&&e.user._id!==t.user._id&&(s=!0):s=!0,s&&(this.$store.dispatch("setCurrentIMInfoMessages",[],{root:!0}),this.$store.dispatch("chat/getLastC2CHistoryMessages","",{root:!0}))},getCurrentIMInfoMessages:function(e,t){var s=this;this.$nextTick((function(){if(("scroll"!==s.trigger&&"scroll"!==s.oldtrigger||"changebaby"===s.trigger)&&(s.$store.dispatch("setBottomBtn",!1,{root:!0}),s.box.scrollTop=s.box.scrollHeight,s.beforeScrollTop=s.box.scrollTop,s.sendRead(),s.$store.dispatch("setMessageFlag",!0,{root:!0})),e&&null!==e&&e.length>3)var t=e[9]?document.getElementById(e[9]._id).offsetTop:e[3]?document.getElementById(e[3]._id).offsetTop:document.getElementById(e[0]._id).offsetTop;"scroll"===s.trigger&&s.noMessageFlag&&"up"===s.direction?s.box.scrollTop=t||s.box.scrollTop+100:"scroll"!==s.trigger||s.noMessageFlag||"up"!==s.direction||(s.box.scrollTop=t||0)}))}},mounted:function(){var e=this;setTimeout((function(){e.$store.commit("chat/SET_LAST_ASK",e.currentSession.last_ask),e.$store.commit("chat/SET_SERVICE_ITEMS",e.currentSession.service_items)}),2e3),this.$nextTick((function(){e.box=e.$refs.chatListWrapper;var t=e;e.box.onscroll=function(){var s=t.box.scrollTop,a=t.box.scrollHeight,n=t.box.clientHeight,r=a-s,i=s-e.beforeScrollTop;if(0===i)return!1;e.direction=i>0?"down":"up",e.$store.dispatch("setTrigger","scroll",{root:!0}),"up"===e.direction&&0===s?e.noMessageFlag&&e.isScrollTop():"down"===e.direction&&e.noMessageFlag&&r===n&&e.isScrollDown(),e.readTimer&&clearTimeout(e.readTimer),e.readTimer=setTimeout((function(){e.sendRead()}),150),e.handleScroll()}}))},methods:{closeDrawerFun:function(){this.quickList=!1,this.listType=""},replyBoxFlag:function(){this.$store.dispatch("setReplyBoxFlag",!1)},gotoDashboard:function(){this.$router.push({path:"/dashboard"})},monitorFdAskChangeFun:function(e){e.getAttribute("fdAsk")!==this.current_fdAsk&&this.$store.dispatch("monitorFdAskChange",e.getAttribute("fdAsk"))},handleScroll:function(){var e=this.box;if(e){var t=e.scrollTop+e.clientHeight+10,s=e.scrollHeight,a=t-s;e.scrollTop>0&&this.$store.dispatch("setBottomBtn",!0,{root:!0}),a>=0&&(this.$store.dispatch("setBottomBtn",!1,{root:!0}),this.$store.dispatch("monitorFdAskChange",this.lastAsk._id))}},sendRead:function(){for(var e=document.getElementById("chat_list_wrapper").getElementsByTagName("li"),t=this.$refs.chatListWrapper,s=t.clientHeight,a=t.scrollTop,n=s+a,r=0;r<e.length;r++){if(e[r].offsetTop<n-100){var i=e[r].getAttribute("isSelfSend"),o=e[r].getAttribute("msgStatus"),l=e[r].getAttribute("msgType");if(!i&&!o&&l!==this.MSG_ELEMENT_TYPE.NOTICE){var c=e[r].getAttribute("id");this.sendReadApi(c),this.haveReadFlag=!0}}a<e[r].offsetTop&&e[r].offsetTop<n&&this.monitorFdAskChangeFun(e[r])}},sendReadApi:function(e){var t=this;e&&Object(Pe["a"])(e).then((function(s){s&&t.$store.dispatch("changeMessageReadSatus",e)}))},isScrollTop:function(){var e={message_id:this.getCurrentIMInfoMessages&&this.getCurrentIMInfoMessages.length>0?this.getCurrentIMInfoMessages[0]._id:"",direction:this.direction};this.$store.dispatch("chat/getLastC2CHistoryMessages",e,{root:!0})},isScrollDown:function(){var e="";this.getCurrentIMInfoMessages&&this.getCurrentIMInfoMessages.length>0&&(e=this.getCurrentIMInfoMessages[this.getCurrentIMInfoMessages.length-1]._id);var t={message_id:e,direction:this.direction};this.$store.dispatch("chat/getLastC2CHistoryMessages",t,{root:!0})},scrollBottom:function(){var e=this;this.$store.dispatch("setTrigger","",{root:!0}),this.$store.dispatch("setCurrentIMInfoMessages",[],{root:!0}),this.$store.dispatch("setMessageFlag",!0,{root:!0}),setTimeout((function(){e.$store.dispatch("chat/getLastC2CHistoryMessages","",{root:!0}),e.$store.dispatch("setBottomBtn",!1,{root:!0})}),300)}}},da=ua,ma=(s("242d"),Object(p["a"])(da,a,n,!1,null,"64fdd34f",null));t["default"]=ma.exports},"9ca1":function(e,t,s){"use strict";var a=s("0f00"),n=s.n(a);n.a},a340:function(e,t,s){"use strict";var a=s("2413"),n=s.n(a);n.a},a482:function(e,t,s){},a66e:function(e,t,s){"use strict";var a=s("8fa3"),n=s.n(a);n.a},a7c9:function(e,t,s){"use strict";var a=s("408a"),n=s.n(a);n.a},a822:function(e,t,s){"use strict";var a=s("f596"),n=s.n(a);n.a},a9c7:function(e,t,s){"use strict";var a=s("b285"),n=s.n(a);n.a},aaff:function(e,t,s){"use strict";var a=s("0e08"),n=s.n(a);n.a},ab54:function(e,t,s){"use strict";var a=s("09d0"),n=s.n(a);n.a},af6d:function(e,t,s){},af7d:function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i}));var a=s("92fc"),n=s("8722");function r(e){return a[e]}function i(e,t){return n[e][t]}},afce:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",["image"===e.mediaType?s("img",{attrs:{src:e.url,alt:"",width:"50px",height:"50px"},on:{click:function(t){return e.showMediaDetail(e.urlList,e.mediaType,e.url)}}}):"video"===e.mediaType?s("div",{staticClass:"video-container"},[s("video",{attrs:{src:e.url,controls:"controls",height:"50",width:"50"}}),s("div",{staticClass:"video-mask",on:{click:function(t){return e.showMediaDetail(e.urlList,e.mediaType,e.url)}}},[s("span",{staticClass:"el-icon-video-play"})])]):e._e()])},n=[],r={name:"MediaDisplayItem",props:{url:{type:String,default:""},mediaType:{type:String,default:""},showMediaDetail:{type:Function,default:function(){}},urlList:{type:Array,default:function(){return[]}}}},i=r,o=(s("c48f"),s("2877")),l=Object(o["a"])(i,a,n,!1,null,"de1d0c06",null);t["a"]=l.exports},b1f3:function(e,t,s){"use strict";var a=s("4d15"),n=s.n(a);n.a},b285:function(e,t,s){},b892:function(e,t,s){},ba59:function(e,t,s){"use strict";var a=s("b892"),n=s.n(a);n.a},bc96:function(e,t,s){},bf56:function(e,t,s){"use strict";var a=s("4b77"),n=s.n(a);n.a},c0ab:function(e,t,s){"use strict";var a=s("e826"),n=s.n(a);n.a},c1a0:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"clearfix"},[s("span",{staticClass:"title"},[e._v("通话录音")]),s("span",{staticClass:"float-right"},[e._v(e._s(e.msgtime))])]),s("div",{ref:"wrap",staticClass:"x-audio-wrap",staticStyle:{"min-width":"250px","max-width":"500px"},style:"width:"+e.width+"px"},[s("div",{staticClass:"x-sector",on:{click:e.play}},[s("img",{staticClass:"sound-img",attrs:{src:e.soundImg}})]),s("div",{staticClass:"progress_box"},[s("el-slider",{attrs:{"format-tooltip":e.formatTooltip},on:{change:e.changeProgressValue},model:{value:e.progressValue,callback:function(t){e.progressValue=t},expression:"progressValue"}})],1),s("div",{staticClass:"x-time"},[e._v(e._s(e.duration&&e.showDuration?e.duration:e.text))])])])},n=[],r=s("7618"),i=(s("ac6a"),s("db72")),o=(s("c5f6"),s("2f62")),l={name:"VoiceCard",props:{src:{type:String,default:""},msgtime:{type:String,default:""},text:{type:String,default:""},vduration:{type:Number,default:0},showDuration:{type:Boolean,default:!0}},data:function(){return{width:"",progressValue:0,audio:null,animate:!1,timer:null,duration:null,soundImg:s("df84"),slideLeft:"0",oldvalue:0,audioTime:"",is_moving:!1,sb_bkx:0,sb_bky:0}},computed:Object(i["a"])({},Object(o["c"])(["activedBaby"])),watch:{animate:function(){!1===this.animate?this.soundImg=s("df84"):this.soundImg=s("88ae")},activedBaby:function(){this.audio.pause()}},mounted:function(){var e=this;this.audio=new Audio,this.audio.src=this.src,this.width=this.vduration/6e4*75-25,this.audio.setAttribute("msgtime",this.msgtime),this.audio.addEventListener("canplaythrough",(function(){})),this.audio.onplay=function(){e.timer=setInterval((function(t){e.updateProgress()}),300),e.animate=!0},this.audio.onpause=function(){e.animate=!1,e.timer&&clearInterval(e.timer)},this.audio.onended=function(){e.animate=!1,e.timer&&clearInterval(e.timer)},window.audioList.push(this.audio)},methods:{formatTooltip:function(){var e=0;return this.audio&&this.audio.duration&&(e=this.realFormatSecond(this.audio.duration*this.progressValue/100)),e},changeProgressValue:function(e){this.play(),this.audio.currentTime=parseInt(this.audio.duration*e/100)},play:function(){var e=this;window.audioList.forEach((function(t,s){var a=t.getAttribute("msgtime"),n=e.audio.getAttribute("msgtime");a!==n&&t.pause()})),this.audio.paused?this.audio.play():this.audio.pause()},updateProgress:function(){var e=Math.round(Math.floor(this.audio.currentTime)/Math.floor(this.audio.duration)*100);e-this.oldvalue>0&&(this.oldvalue=e,this.progressValue=e)},realFormatSecond:function(e){var t=Object(r["a"])(e);if("number"===t||"string"===t){e=parseInt(e);var s=Math.floor(e/60);return e-=60*s,("0"+s).slice(-2)+":"+("0"+e).slice(-2)}return"00:00"}}},c=l,u=(s("ff2e"),s("2877")),d=Object(u["a"])(c,a,n,!1,null,"19341bc4",null);t["a"]=d.exports},c1c0:function(e,t,s){},c2c8:function(e,t,s){},c48f:function(e,t,s){"use strict";var a=s("f9ff"),n=s.n(a);n.a},c50f:function(e,t,s){},c5be:function(e,t,s){},c75d:function(e,t,s){"use strict";var a=s("4a43"),n=s.n(a);n.a},c776:function(e,t,s){"use strict";var a=s("da1e"),n=s.n(a);n.a},c83b:function(e,t,s){e.exports=s.p+"static/img/icon-dianji.cef34038.png"},cbf7:function(e,t,s){"use strict";var a=s("dad5"),n=s.n(a);n.a},cd3c:function(e,t,s){"use strict";var a=s("c5be"),n=s.n(a);n.a},d2ab:function(e,t,s){"use strict";var a=s("61ae"),n=s.n(a);n.a},d3b1:function(e,t,s){"use strict";var a=s("bc96"),n=s.n(a);n.a},d48b:function(e,t,s){},d496:function(e,t,s){},d679:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"CardContent"},[s("div",[s("el-row",{staticClass:"baby-info",attrs:{gutter:4}},[s("el-col",{attrs:{span:2}},[s("svg-icon",{attrs:{"icon-class":"baby"}})],1),s("el-col",{attrs:{span:22}},[s("p",[e._v("宝宝信息")]),s("div",[e._v("\n          姓名："+e._s(e.baby.name)+"    性别："+e._s(e.genderFilter(e.baby.gender))+"\n             年龄："+e._s(e.baby.age_of_month?e.baby.age_of_month:"未知")+"\n        ")])])],1),s("el-row",{staticClass:"symptom",attrs:{gutter:24}},[s("el-col",{attrs:{span:2}},[s("svg-icon",{attrs:{"icon-class":"yiliaoqixie"}})],1),s("el-col",{attrs:{span:22}},[s("p",[e._v("症状描述")]),s("div",[e._v(e._s(e.symptom))])])],1),s("el-row",{staticClass:"interven",attrs:{gutter:24}},[s("el-col",{attrs:{span:2}},[s("svg-icon",{attrs:{"icon-class":"yao"}})],1),s("el-col",{attrs:{span:22}},[s("p",[e._v("干预史")]),s("div",[e._v(e._s(e.intervenDesc||"无"))])])],1),s("el-row",{staticClass:"data",attrs:{gutter:24}},[s("el-col",{attrs:{span:2}},[s("svg-icon",{attrs:{"icon-class":"tupian"}})],1),s("el-col",{attrs:{span:22}},[s("p",[e._v("资料照片及视频")]),e.dataArr&&e.dataArr.length>0?s("div",e._l(e.dataArr,(function(t,a){return s("div",{key:a,staticClass:"image-and-video"},["image"===t.type?s("img",{attrs:{src:t.url,alt:"",width:"50px"},on:{click:function(s){return e.showMediaDetail(t.url,t.type)}}}):"video"===t.type?s("div",{staticClass:"video-container"},[s("div",{staticClass:"VideoContent"},[s("img",{attrs:{src:t.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg","data-src":t.url+"?x-oss-process=video/snapshot,t_0,w_0,h_0,f_jpg",alt:""}}),s("i",{staticClass:"el-icon-video-play",on:{click:function(s){return e.showMediaDetail(t.url,"video")}}})])]):e._e()])})),0):e._e(),e.dataArr.length<=0?s("p",[e._v("无")]):e._e()])],1)],1)])},n=[],r=s("2b0e"),i=r["default"].filter("gender"),o={name:"CardContent",components:{},props:{baby:{type:Object,default:function(){return{name:"未知",gender:0,age:"未知"}}},symptom:{type:String,default:""},hasInterven:{type:Boolean,default:!1},intervenDesc:{type:String,default:""},dataArr:{type:Array,default:function(){return["http://"]}}},data:function(){return{currentMediaType:"",currentMediaUrl:"",dialogVisible:!1}},methods:{genderFilter:i,showMediaDetail:function(e,t){for(var s=[],a=0;a<this.dataArr.length;a++){var n=this.dataArr[a];"image"===n.type&&n.url&&s.push(n.url)}var r={mediaType:t,meidiaUrl:e,list:s};this.$emit("showDetail",r)},closeVideoDialog:function(){if("video"===this.currentMediaType){var e=document.getElementById("myVideo");e.pause()}}}},l=o,c=(s("a822"),s("2877")),u=Object(c["a"])(l,a,n,!1,null,"7cfbca32",null);t["a"]=u.exports},d8a3:function(e,t,s){"use strict";var a=s("11b6"),n=s.n(a);n.a},da1e:function(e,t,s){},dac4:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"see-details"},[s("el-row",{staticClass:"user-info"},[s("el-col",{staticStyle:{"max-width":"80px"},attrs:{span:4}},[s("el-avatar",{attrs:{src:e.babyInfo.user&&e.babyInfo.user.avatar}})],1),s("el-col",{attrs:{span:20}},[s("span",{staticClass:"item-title"},[e._v("用户名称：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.babyInfo.user&&e.babyInfo.user.nickname)+"  "),e.replace?s("svg-icon",{attrs:{"icon-class":"replace"}}):e._e()],1)])],1),s("el-row",[s("el-col",{attrs:{span:24}},[s("span",{staticClass:"item-title"},[e._v("宝宝：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.babyInfo.name))]),s("span",{staticClass:"item-title",staticStyle:{"margin-left":"10px"}},[e._v("宝宝月龄：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.babyInfo.birthday))])])],1),s("el-tabs",{staticClass:"professional-role__header__tabs",staticStyle:{"margin-top":"30px"},on:{"tab-click":e.getActiveList},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabArr,(function(t){var a=t.label,n=t.name,r=t.num;return s("el-tab-pane",{key:n,attrs:{name:n}},[s("span",{staticClass:"professional-role__header__tabs__slot-label",attrs:{slot:"label"},slot:"label"},[r>0?s("el-badge",{staticClass:"item",attrs:{value:r}}):e._e(),e._v(e._s(a))],1)])})),1),s("el-table",{staticStyle:{width:"100%","min-width":"400px"},attrs:{data:e.tableData,"empty-text":"暂无数据"}},[s("el-table-column",{attrs:{width:"chat"===e.pageType?"60px":"110px",prop:"monthAge",label:"测试月龄",align:"center"}}),s("el-table-column",{attrs:{prop:"name",label:"发育量表名称",align:"center",width:"chat"===e.pageType?"110px":"250px"}}),s("el-table-column",{attrs:{prop:"status",label:"当前状态",align:"center",width:"chat"===e.pageType?"100px":"150px"}}),"health"===e.pageType?s("el-table-column",{attrs:{label:"最近操作时间",width:"220px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("formatTime")(new Date(t.row.operateTime)))+"\n      ")]}}],null,!1,648558294)}):e._e(),"health"===e.pageType?s("el-table-column",{attrs:{prop:"name",align:"center",label:"医生建议"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.suggestion?t.row.suggestion:"暂无数据")+"\n      ")]}}],null,!1,135623844)}):e._e(),s("el-table-column",{attrs:{label:"操作",width:"chat"===e.pageType?"100px":"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row?[s("el-badge",{staticClass:"dot-badge",attrs:{"is-dot":t.row.status&&"待发送"===t.row.status&&"hm"===e.$store.state.user.bus_role||t.row.status&&"待反馈"===t.row.status||t.row.status&&"反馈已保存"===t.row.status&&"doctor"===e.$store.state.user.bus_role}},[t.row.status&&"待测试"!==t.row.status||"已完成"!==t.row.status?s("el-button",{attrs:{type:"text",size:"small",disabled:!e.isMyUser},on:{click:function(s){e.sendClick(e.getOperation(t.row.status),t.row)}}},[e._v(e._s(e.getOperation(t.row.status)))]):e._e()],1),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return e.seeDetail(t.row)}}},[e._v("查看")])]:void 0}}],null,!0)})],1),s("el-dialog",{attrs:{title:"发送发育量表提醒",visible:e.growDialogVisible,width:"400px",center:"",top:"30vh",modal:!1},on:{"update:visible":function(t){e.growDialogVisible=t}}},[s("span",{staticStyle:{"line-height":"24px"}},[e._v("操作成功后，您将发送【"+e._s(e.rowInfo.name)+"】给【"+e._s(e.babyInfo.name)+"】，如果确认无误，请单击确认发送")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticStyle:{padding:"6px 15px",height:"32px"},attrs:{type:"primary"},on:{click:e.confirmSend}},[e._v("确认发送")])],1)])],1)},n=[],r=(s("96cf"),s("3b8d")),i=(s("7f7f"),s("db72")),o=s("875a"),l=s("2f62"),c={props:{pageType:{type:String,default:"health"},member:{type:String,default:""}},data:function(){return{replace:!1,activeName:"all",tableData:[],allDataArr:[],testedArr:[],suggestedArr:[],babyInfo:{},statusText:"",rowInfo:{},tabArr:[{label:"全部",name:"all",num:0},{label:"医生已反馈",name:"suggested",num:0},{label:"已测",name:"tested",num:0}],growDialogVisible:!1}},computed:Object(i["a"])({},Object(l["c"])(["isMyUser"]),{getStatus:function(){return function(e){return"un_send"===e?"未发送":"pre_send"===e?"待发送":"send"===e?"待测试":"tested"===e?"待反馈":"save"===e?"反馈已保存":"suggested"===e?"已完成":void 0}},getOperation:function(){return function(e){return"未发送"===e||"待发送"===e?"发送":"待反馈"===e?"填写反馈":"反馈已保存"===e?"编辑反馈":void 0}},isHasUser:function(){return function(e){return e[this.$store.state.user.bus_role]===this.$store.state.user.id}}}),created:function(){this.getGrowthDetail(),this.$route.params.id&&window.localStorage.setItem("paramsID",this.$route.params.id)},watch:{member:function(){this.getGrowthDetail()}},methods:{getActiveList:function(){var e=this.activeName;this.tableData="all"===e?this.allDataArr:"suggested"===e?this.suggestedArr:this.testedArr},seeDetail:function(e){this.statusText=e.status,"growListDetail"===this.$route.name?(this.statusText=e.status,this.$router.push({name:"growStatusDetail",params:{id:e.id},query:{status:this.statusText}})):(this.$store.state.chat.growthId=e.id,this.$emit("setLookStatus",e.id))},getGrowthDetail:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["g"])({member:this.$route.params.id||this.member,needSort:"health"===this.pageType});case 2:t=e.sent,s=t.data,a=t.code,2e4===a&&(this.replace=s.baby.is_replace,this.babyInfo=s.baby,this.suggestedArr=[],this.testedArr=[],this.allDataArr=[],s.list&&s.list.length?(s.list.map((function(e){e.status&&"suggested"===e.status?n.suggestedArr.push({monthAge:e.month_age,name:e.name,status:n.getStatus(e.status),id:e._id,reminded_at:e.reminded_at,suggestion:e.suggest_content,operateTime:e.operateTime}):e.status&&"tested"===e.status&&n.testedArr.push({monthAge:e.month_age,name:e.name,status:n.getStatus(e.status),id:e._id,reminded_at:e.reminded_at,suggestion:e.suggest_content,operateTime:e.operateTime}),n.allDataArr.push({monthAge:e.month_age,name:e.name,status:n.getStatus(e.status),id:e._id,reminded_at:e.reminded_at,suggestion:e.suggest_content,operateTime:e.operateTime})})),this.tableData=this.suggestedArr):this.tableData=[],this.getActiveList());case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),sendClick:function(e,t){if(this.statusText=t.status,"hm"!==this.$store.state.user.bus_role&&"发送"===e||"doctor"!==this.$store.state.user.bus_role&&"发送"!==e)return this.$message.warning("没有操作权限");"发送"===e?(this.rowInfo=t,this.growDialogVisible=!0):this.$router.push({name:"growStatusDetail",params:{id:t.id},query:{status:this.statusText}})},confirmSend:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["j"])(this.rowInfo.id);case 2:t=e.sent,s=t.data,a=t.code,2e4===a&&s.result?(this.$message.success("发送成功"),this.getGrowthDetail(),this.growDialogVisible=!1):this.$message.error(s.message);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},beforeRouteLeave:function(e,t,s){"未发送"!==this.statusText&&"待发送"!==this.statusText&&"待测试"!==this.statusText||(e.meta.title="未发送"),"待反馈"===this.statusText&&(e.meta.title="待反馈"),"反馈已保存"===this.statusText&&(e.meta.title="填写反馈"),"已完成"===this.statusText&&(e.meta.title="已完成"),s()}},u=c,d=(s("38e1"),s("2877")),m=Object(d["a"])(u,a,n,!1,null,"5c71082a",null);t["default"]=m.exports},dad5:function(e,t,s){},daf6:function(e,t,s){"use strict";var a=s("6ad2"),n=s.n(a);n.a},db8d:function(e,t,s){},df64:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"status-detail"},[e.showBtn?s("el-button",{staticClass:"float-right",attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.returnList}},[e._v("\n    返回\n  ")]):e._e(),s("div",{staticClass:"user-info"},[s("div",{staticClass:"info-content"},[s("el-avatar",{attrs:{src:e.user.avatar}}),s("p",[s("span",{staticClass:"item-title",staticStyle:{width:"80px"}},[e._v("用户名称：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.user.nickname))])]),s("p",[s("span",{staticClass:"item-title"},[e._v("宝宝：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.member.name))])]),s("p",[s("span",{staticClass:"item-title",staticStyle:{width:"80px"}},[e._v("宝宝月龄：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.member.birthday))])])],1)]),s("div",{staticClass:"card-question"},[s("div",{staticClass:"m-b-20"},[s("span",{staticClass:"item-title"},[e._v("模板名称：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.name))])]),s("div",{staticClass:"m-b-20"},[s("span",{staticClass:"item-title"},[e._v("测试月龄：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.monthAge))])]),e._l(e.questions,(function(t,a){return s("el-card",{key:a,staticClass:"m-b-20",attrs:{shadow:"never"}},[s("div",{staticClass:"question m-b-20"},[s("p",{staticClass:"item-title question-title"},[e._v("问题"+e._s(a+1)+"：")]),s("p",{staticClass:"question-text",staticStyle:{"line-height":"16px"}},[e._v("\n          "+e._s(t.question)+"\n        ")])]),s("div",{staticClass:"answer"},[s("span",{staticClass:"item-title answer-title"},[e._v("答案：")]),s("p",e._l(t.answer,(function(t,n){return s("span",{key:t.key,staticClass:"item-text",class:"未发送"!==e.$route.query.status&&e.answers[a]===n?"answer-active":""},[e._v(e._s(t.value))])})),0)])])})),e.submitTime?s("div",{staticClass:"time"},[e._v("\n      "+e._s(e.testTime)+"\n    ")]):e._e(),"save"!==e.status&&"tested"!==e.status||"doctor"!==e.$store.state.user.bus_role?e._e():s("el-form",{ref:"createSuggestForm",attrs:{model:e.suggestForm,rules:e.rules,"label-width":"100px","label-position":"left"}},[s("el-form-item",{attrs:{label:"医生建议：",prop:"suggest"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入您的建议",maxlength:"200","show-word-limit":"",resize:"none",rows:4},model:{value:e.suggestForm.suggest,callback:function(t){e.$set(e.suggestForm,"suggest",t)},expression:"suggestForm.suggest"}})],1),"suggested"===e.status||"save"===e.status?s("div",{staticClass:"time",staticStyle:{"margin-bottom":"20px"}},[e._v("\n        "+e._s(e.updateTime)+"\n      ")]):e._e(),"suggested"!==e.status?s("el-form-item",{staticClass:"form-btn"},[s("el-button",{on:{click:function(t){return e.submitForm("createSuggestForm","save")}}},[e._v("保存")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("createSuggestForm","suggested")}}},[e._v("发送")])],1):e._e()],1),"suggested"===e.status?s("div",{staticClass:"m-b-20"},[s("span",{staticClass:"item-title"},[e._v("医生建议：")]),s("span",{staticClass:"item-text"},[e._v(e._s(e.suggestForm.suggest))])]):e._e(),"suggested"===e.status?s("div",{staticClass:"time",staticStyle:{"margin-bottom":"20px"}},[e._v("\n      "+e._s(e.updateTime)+"\n    ")]):e._e()],2)],1)},n=[],r=(s("7f7f"),s("96cf"),s("3b8d")),i=s("875a"),o={props:{showBtn:{type:Boolean,default:!1}},data:function(){return{suggestForm:{suggest:""},rules:{suggest:[{required:!0,message:"内容不能为空"}]},questions:[],member:{},user:{},monthAge:"",name:"",status:"",answers:[],testTime:"",updateTime:""}},computed:{submitTime:function(){return"un_send"!==this.status&&"pre_send"!==this.status&&"send"!==this.status}},created:function(){this.getGrowthStatus()},methods:{returnList:function(){this.$emit("return")},getGrowthStatus:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["i"])(this.$route.params.id||this.$store.state.chat.growthId);case 2:t=e.sent,s=t.data,a=t.code,2e4===a&&s.result&&(this.member=s.growth.member,this.user=s.growth.user,this.questions=s.growth.growth_info&&s.growth.growth_info.questions,this.monthAge=s.growth.month_age,this.name=s.growth.name,this.suggestForm.suggest=s.growth.suggest_content||"",this.status=s.growth.status,this.answers=s.growth.answers||[],this.testTime=this.formatTime(s.growth.tested_at),this.updateTime=this.formatTime(s.growth.updated_at));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),submitForm:function(e,t){var s=this;this.$refs[e].validate(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=9;break}return e.next=3,Object(i["a"])({id:s.$route.params.id,content:s.suggestForm.suggest,status:t});case 3:n=e.sent,r=n.data,o=n.code,2e4===o&&(r.result?(s.$message.success(("save"===t?"保存":"发送")+"成功"),s.$router.go(-1)):s.$message.error(r.message)),e.next=10;break;case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},beforeRouteEnter:function(e,t,s){s((function(e){"未发送"!==e.$route.query.status&&"待发送"!==e.$route.query.status&&"待测试"!==e.$route.query.status||(e.$route.meta.title="未发送"),"待反馈"===e.$route.query.status&&(e.$route.meta.title="待反馈"),"反馈已保存"===e.$route.query.status&&(e.$route.meta.title="填写反馈"),"已完成"===e.$route.query.status&&(e.$route.meta.title="已完成")}))}},l=o,c=(s("9055"),s("2877")),u=Object(c["a"])(l,a,n,!1,null,"6f87a4dc",null);t["default"]=u.exports},df84:function(e,t,s){e.exports=s.p+"static/img/play.c0a23e29.png"},e1de:function(e,t,s){"use strict";var a=s("f30a"),n=s.n(a);n.a},e405:function(e,t,s){"use strict";var a=s("8124"),n=s.n(a);n.a},e7e2:function(e,t,s){},e826:function(e,t,s){},eb11:function(e,t,s){},eb95:function(e,t,s){"use strict";var a=s("63d9"),n=s.n(a);n.a},f06c:function(e,t,s){"use strict";var a=s("1d3d"),n=s.n(a);n.a},f0c3:function(e,t,s){"use strict";var a=s("c1c0"),n=s.n(a);n.a},f28d:function(e,t,s){},f30a:function(e,t,s){},f467:function(e,t,s){},f596:function(e,t,s){},f60f:function(e,t,s){},f615:function(e,t,s){},f8b7:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"i",(function(){return r})),s.d(t,"h",(function(){return i})),s.d(t,"k",(function(){return o})),s.d(t,"l",(function(){return l})),s.d(t,"d",(function(){return c})),s.d(t,"f",(function(){return u})),s.d(t,"e",(function(){return d})),s.d(t,"j",(function(){return m})),s.d(t,"g",(function(){return h})),s.d(t,"c",(function(){return p})),s.d(t,"m",(function(){return f})),s.d(t,"b",(function(){return g}));var a=s("b775");function n(e){return Object(a["a"])({url:"/fd/contract/".concat(e,"/active"),method:"put"})}function r(){return Object(a["a"])({url:"order/basic/options",method:"get"})}function i(){return Object(a["a"])({url:"/order/basic/order_name/options",method:"get"})}function o(){return Object(a["a"])({url:"/order/basic/order_status/options",method:"get"})}function l(){return Object(a["a"])({url:"/order/basic/order_type/options",method:"get"})}function c(e){return Object(a["a"])({url:"/order/check_export",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/order/".concat(e,"/detail"),method:"get"})}function d(e,t){return Object(a["a"])({url:"/order/".concat(e,"/close"),method:"put",data:t})}function m(){return Object(a["a"])({url:"/order/process_numbers",method:"get"})}function h(e){return Object(a["a"])({url:"/order/list",method:"post",data:e})}function p(e,t){return Object(a["a"])({url:"/order/".concat(e,"/refund"),method:"put",data:t})}function f(e){return Object(a["a"])({url:"/order/log",method:"get",params:e})}function g(e){return Object(a["a"])({url:"/order/log",method:"post",data:e})}},f9ff:function(e,t,s){},fc3c:function(e,t,s){"use strict";var a=s("215c"),n=s.n(a);n.a},ff2e:function(e,t,s){"use strict";var a=s("117b"),n=s.n(a);n.a}}]);
//# sourceMappingURL=chunk-747caf0a.c56fee8d.js.map