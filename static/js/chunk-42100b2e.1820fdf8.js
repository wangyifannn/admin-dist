(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42100b2e"],{"1d61":function(t,e,s){"use strict";var a=s("4ace"),i=s.n(a);i.a},"364e":function(t,e,s){"use strict";var a=s("fb53"),i=s.n(a);i.a},"4ace":function(t,e,s){},"4d5b":function(t,e,s){"use strict";var a=s("7089"),i=s.n(a);i.a},5118:function(t,e,s){(function(t){var a="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(i.call(setTimeout,a,arguments),clearTimeout)},e.setInterval=function(){return new n(i.call(setInterval,a,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(a,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},s("6017"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,s("24aa"))},6017:function(t,e,s){(function(t,e){(function(t,s){"use strict";if(!t.setImmediate){var a,i=1,n={},r=!1,c=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?h():d()?f():t.MessageChannel?v():c&&"onreadystatechange"in c.createElement("script")?g():w(),l.setImmediate=o,l.clearImmediate=u}function o(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),s=0;s<e.length;s++)e[s]=arguments[s+1];var r={callback:t,args:e};return n[i]=r,a(i),i++}function u(t){delete n[t]}function p(t){var e=t.callback,a=t.args;switch(a.length){case 0:e();break;case 1:e(a[0]);break;case 2:e(a[0],a[1]);break;case 3:e(a[0],a[1],a[2]);break;default:e.apply(s,a);break}}function m(t){if(r)setTimeout(m,0,t);else{var e=n[t];if(e){r=!0;try{p(e)}finally{u(t),r=!1}}}}function h(){a=function(t){e.nextTick((function(){m(t)}))}}function d(){if(t.postMessage&&!t.importScripts){var e=!0,s=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=s,e}}function f(){var e="setImmediate$"+Math.random()+"$",s=function(s){s.source===t&&"string"===typeof s.data&&0===s.data.indexOf(e)&&m(+s.data.slice(e.length))};t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),a=function(s){t.postMessage(e+s,"*")}}function v(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;m(e)},a=function(e){t.port2.postMessage(e)}}function g(){var t=c.documentElement;a=function(e){var s=c.createElement("script");s.onreadystatechange=function(){m(e),s.onreadystatechange=null,t.removeChild(s),s=null},t.appendChild(s)}}function w(){a=function(t){setTimeout(m,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,s("24aa"),s("4362"))},7089:function(t,e,s){},"79c2":function(t,e,s){"use strict";var a=s("caf8"),i=s.n(a);i.a},caf8:function(t,e,s){},ee6f:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"topic-list"},[s("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"训练点评",name:"first"}},[s("el-form",{attrs:{"label-position":"left","label-width":"100px",model:t.topic,inline:""}},[s("el-form-item",{staticClass:"search-item",attrs:{label:"题型"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.topic.type,callback:function(e){t.$set(t.topic,"type",e)},expression:"topic.type"}},t._l(t.typeList,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t.isOpen?[s("el-form-item",{staticClass:"search-item",attrs:{label:"答题时间",clearable:""}},[s("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"答题时间","end-placeholder":"答题时间","value-format":"yyyy-MM-dd"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),s("el-form-item",{staticClass:"search-item",attrs:{label:"试题难度"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.topic.difficult,callback:function(e){t.$set(t.topic,"difficult",e)},expression:"topic.difficult"}},t._l(t.difficultyList,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("el-form-item",{staticClass:"search-item",attrs:{label:"学员姓名"}},[s("el-input",{attrs:{clearable:"",placeholder:"请输入学员姓名"},model:{value:t.topic.name,callback:function(e){t.$set(t.topic,"name",e)},expression:"topic.name"}})],1)]:t._e(),s("el-form-item",{staticClass:"search-item",attrs:{label:"单节课名称"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.topic.catalog,callback:function(e){t.$set(t.topic,"catalog",e)},expression:"topic.catalog"}},t._l(t.singleList,(function(t){return s("el-option",{key:t._id,attrs:{label:t.title,value:t._id}})})),1)],1),t.isOpen?[s("el-form-item",{staticClass:"search-item",attrs:{label:"所属阶段"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.topic.stage,callback:function(e){t.$set(t.topic,"stage",e)},expression:"topic.stage"}},t._l(t.stageList,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]:t._e(),s("el-form-item",[s("el-button",{staticClass:"select-btn",attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1),s("el-button",{staticClass:"arrow",attrs:{type:"text"},on:{click:function(e){t.isOpen=!t.isOpen}}},[t._v("\n          "+t._s(t.isOpen?"收起":"展开")+"\n          "),s("i",{class:t.isOpen?"el-icon-arrow-up":"el-icon-arrow-down",staticStyle:{"font-size":"16px",color:"#0085FF"}})])],2),s("div",{staticClass:"list"},[s("div",{staticClass:"title"},[s("div",[t._v("点评列表")])]),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,"empty-text":t.hasListInfo}},[s("el-table-column",{attrs:{fixed:"",prop:"num",label:"编号","min-width":"100",align:"center"}}),s("el-table-column",{attrs:{prop:"stem",label:"试题内容","min-width":"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-popover",{attrs:{placement:"top-start",trigger:"hover",content:e.row.stem}},[s("span",{staticClass:"cell",attrs:{slot:"reference"},domProps:{innerHTML:t._s(e.row.stem)},slot:"reference"})])]}}])}),s("el-table-column",{attrs:{prop:"title",label:"单节课名称","min-width":"120",align:"center"}}),s("el-table-column",{attrs:{prop:"stage",label:"所属阶段","min-width":"100",align:"center"}}),s("el-table-column",{attrs:{prop:"type",label:"题型","min-width":"80",align:"center"}}),s("el-table-column",{attrs:{prop:"difficult",label:"难度","min-width":"80",align:"center"}}),s("el-table-column",{attrs:{prop:"name",label:"学员姓名","min-width":"80",align:"center"}}),s("el-table-column",{attrs:{prop:"updated_at",label:"答题时间","min-width":"120",align:"center"}}),s("el-table-column",{attrs:{prop:"status",label:"答题结果","min-width":"80",align:"center"}}),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small",disabled:"简单题"!==e.row.type},on:{click:function(s){return t.goComment(e.row)}}},[t._v("去点评")])]}}])})],1),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[12,18,24],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),s("el-tab-pane",{attrs:{label:"咨询点评",name:"second"}},["human_resource"===t.type?s("hr-statistics"):t._e(),"doctor"===t.character?s("review-statistics"):t._e(),s("consulting-review",{class:"hm"!==t.character?"review-list":""})],1)],1)],1)},i=[],n=(s("28a5"),s("7f7f"),s("a481"),s("96cf"),s("3b8d")),r=(s("6b54"),s("db72")),c=(s("c5f6"),s("f296")),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"consulting-review"},[s("el-form",{attrs:{"label-position":"left","label-width":"100px",model:t.consulting,inline:""}},[s("el-form-item",{staticClass:"search-item",attrs:{label:"被点评人"}},[s("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:t.consulting.reviewer,callback:function(e){t.$set(t.consulting,"reviewer",e)},expression:"consulting.reviewer"}},t._l(t.reviewerList,(function(t){return s("el-option",{key:t.value,attrs:{label:t.name,value:t._id}})})),1)],1),s("el-form-item",{staticClass:"search-item",attrs:{label:"分数"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.consulting.score,callback:function(e){t.$set(t.consulting,"score",e)},expression:"consulting.score"}},t._l(t.scoreList,(function(t){return s("el-option",{key:t.title,attrs:{label:t.title,value:t.value}})})),1)],1),s("el-form-item",{staticClass:"search-item",attrs:{label:"点评时间",clearable:""}},[s("el-date-picker",{attrs:{type:"human_resource"===t.type?"monthrange":"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"点评时间","end-placeholder":"点评时间","value-format":"yyyy-MM-dd"},model:{value:t.reviewTime,callback:function(e){t.reviewTime=e},expression:"reviewTime"}})],1),s("el-form-item",[s("el-button",{staticClass:"select-btn",attrs:{type:"primary"},on:{click:t.select}},[t._v("查询")])],1)],1),"hm"!==t.character?s("el-divider"):t._e(),s("div",{staticClass:"list"},[t._m(0),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,"empty-text":t.hasListInfo}},[s("el-table-column",{attrs:{prop:"reviewTime",label:"点评时间",align:"center"}}),s("el-table-column",{attrs:{prop:"reviewer",label:"被点评人",align:"center"}}),"human_resource"===t.type?s("el-table-column",{attrs:{prop:"commentatorNum",label:"已评人数",align:"center"}}):t._e(),"human_resource"===t.type?s("el-table-column",{attrs:{prop:"commentNum",label:"评价条数",align:"center"}}):t._e(),s("el-table-column",{attrs:{prop:"score",label:"human_resource"===t.type?"最终分数":"分数",align:"center"}}),s("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.examine(e.row)}}},[t._v("查看")]),e.row.un_read?s("span",{staticClass:"tip-spot"}):t._e()]}}])})],1),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[12,18,24],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("div",[t._v("点评列表")])])}],u={name:"ConsultingReview",data:function(){return{consulting:{reviewer:"",score:[0,100]},reviewerList:[],scoreList:[{title:"全部",value:[0,100]},{title:"91-100",value:[91,100]},{title:"81-90",value:[81,90]},{title:"71-80",value:[71,80]},{title:"61-70",value:[61,70]},{title:"60以下",value:[0,60]}],reviewTime:["",""],hasListInfo:"暂无数据",list:[],currentPage:1,pageSize:12,count:0,type:this.$store.state.user.mts_user?this.$store.state.user.mts_user.type:"",character:this.$store.state.user.bus_role}},created:function(){this.getReviewList(),this.getBusUser()},methods:{select:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.currentPage=1,t.next=3,this.getReviewList(this.consulting);case 3:this.list.length?this.hasListInfo="暂无数据":this.hasListInfo="暂无数据，请重新输入关键词";case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSizeChange:function(t){this.pageSize=t,this.getReviewList(this.consulting)},handleCurrentChange:function(t){this.currentPage=t,this.getReviewList(this.consulting)},examine:function(t){Object(c["hb"])({id:t.id}),"human_resource"!==this.type?this.$router.push("/learning-admin/comment/see-reviews/"+t.id):this.$router.push("/learning-admin/comment/review-detail/"+t.id+"?date="+t.reviewTime)},getReviewList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s,a,i,n,r,l,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s={page:this.currentPage,pageSize:this.pageSize},e&&(e.reviewer&&(s.commentator=e.reviewer),e.score&&(s.start_score=e.score[0]),e.score&&(s.end_score=e.score[1]),this.reviewTime&&this.reviewTime[0]&&(s.review_started_at=this.reviewTime[0]),this.reviewTime&&this.reviewTime[1]&&(s.review_ended_at=this.reviewTime[1])),"human_resource"===this.type){t.next=11;break}return t.next=5,Object(c["K"])(s);case 5:a=t.sent,i=a.data,n=a.code,2e4===n&&(this.count=i.count,i.list.length?this.list=i.list.map((function(t){return{reviewTime:t.created_at.split("T")[0],reviewer:t.commentator?t.commentator.name:"/",score:t.score,id:t._id,un_read:t.un_read}})):this.list=i.list),t.next=17;break;case 11:return t.next=13,Object(c["C"])(s);case 13:r=t.sent,l=r.code,o=r.data,2e4===l&&(this.count=o.count,o.list.length?this.list=o.list.map((function(t){return{reviewTime:t._id.year+"-"+(t._id.month<10?"0"+t._id.month:t._id.month),reviewer:t._id.name||"/",commentatorNum:t.reviewer_count,commentNum:t.count,score:Math.round(t.score),id:t._id.commentator,un_read:t.un_read}})):this.list=o.list);case 17:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getBusUser:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["x"])({bus_role:"hm"});case 2:e=t.sent,s=e.code,a=e.data,2e4===s&&(this.reviewerList=a.list);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},p=u,m=(s("1d61"),s("2877")),h=Object(m["a"])(p,l,o,!1,null,"6482241a",null),d=h.exports,f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-row",{staticClass:"review-statistics",attrs:{gutter:12}},[s("el-col",{staticClass:"item",attrs:{span:4}},[s("el-card",{attrs:{shadow:"never"}},[s("p",{staticClass:"statistics-title"},[t._v("点评统计")]),s("p",{staticClass:"task-volume"},[t._v("\n        "+t._s(t.getMonth())+"月点评任务量："),s("span",{staticClass:"task-num"},[t._v(t._s(t.statistics.task_count))])]),s("p",{staticClass:"task-volume"},[t._v("\n        "+t._s(t.getMonth())+"月待点评数量："),s("span",{staticClass:"task-num"},[t._v(t._s(t.statistics.review_count))])]),s("p",{staticClass:"task-volume"},[t._v("\n        "+t._s(t.getMonth(-1))+"月点评数量："),s("span",{staticClass:"task-num"},[t._v(t._s(t.statistics.pre_month))])])])],1),s("el-col",{staticClass:"item",attrs:{span:6}},[s("el-card",{attrs:{shadow:"never"}},[s("p",{staticClass:"statistics-title"},[t._v("\n        点评用时："),s("span",{staticClass:"statistics-time"},[t._v(t._s(t.statistics.time||0)+"分钟")])]),s("el-progress",{attrs:{type:"circle",percentage:t.getCarryOut||0,width:130,"stroke-width":10}},[t._v("已完成")])],1)],1),s("el-col",{staticClass:"item",attrs:{span:10}},[s("el-card",{attrs:{shadow:"never"}},[s("p",{staticClass:"statistics-title"},[t._v(t._s(t.getMonth())+"月点评分数统计")]),t._l(t.scoreStatistics,(function(e,a){return s("div",{key:a,staticClass:"review-item"},[s("p",{staticClass:"task-volume"},[s("span",{staticClass:"segment"},[t._v(t._s(e.title))]),s("el-progress",{attrs:{color:t.colors[a],"show-text":!1,percentage:t.getScoreTotal(e.count),"stroke-width":15}}),s("span",{staticClass:"segment pl"},[t._v(t._s(e.count)+"个")])],1)])}))],2)],1),s("el-col",{staticClass:"item",attrs:{span:4}},[s("el-card",{staticClass:"doctor-comment",attrs:{shadow:"never"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.goToReview}},[t._v("去点评")])],1)],1),s("el-dialog",{attrs:{title:"提示",visible:t.hasReview,width:"400px",center:"",top:"30vh"},on:{"update:visible":function(e){t.hasReview=e}}},[s("p",{staticStyle:{"text-align":"center"}},[t._v("当前没有可点评的咨询记录，请稍后重试")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.hasReview=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.hasReview=!1}}},[t._v("确 定")])],1)])],1)},v=[],g={name:"ReviewStatistics",data:function(){return{colors:[[{color:"#0085FF",percentage:0},{color:"#4EABFF",percentage:100}],[{color:"#4160FF",percentage:0},{color:"#95A5FF",percentage:100}],[{color:"#67CA39",percentage:0},{color:"#53DE42",percentage:100}],[{color:"#FFB718",percentage:0},{color:"#FFC74A",percentage:100}],[{color:"#F8747F",percentage:0},{color:"#F8A1AB",percentage:100}]],hasReview:!1,statistics:{},scoreStatistics:[],scoreTotal:0}},computed:{getMonth:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(new Date).getMonth()+1+t||12}},getCarryOut:function(){if(!this.statistics.task_count)return 0;var t=Math.ceil(this.statistics.cur_month_total/this.statistics.task_count*100);return t?t>100?100:t:0},getScoreTotal:function(){return function(t){return 0===this.scoreTotal?0:Math.ceil(t/this.scoreTotal*100)}}},created:function(){this.getStatisticsContent()},methods:{goToReview:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["U"])();case 2:e=t.sent,s=e.code,a=e.data,2e4===s&&(a.result&&a.messages&&a.messages.fd_ask?this.$router.push("/learning-admin/comment/commit-review"):this.hasReview=!0);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getStatisticsContent:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["P"])();case 2:if(e=t.sent,s=e.code,a=e.data,2e4===s&&a.result)for(i in this.statistics=a.statistics,a.statistics.dataMap)this.scoreStatistics.push({title:i,count:a.statistics.dataMap[i]}),this.scoreTotal+=a.statistics.dataMap[i];case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},w=g,_=(s("4d5b"),Object(m["a"])(w,f,v,!1,null,"264acdac",null)),b=_.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-row",{staticClass:"statistics",attrs:{gutter:12}},[s("el-col",{staticClass:"item",attrs:{span:4}},[s("el-card",{attrs:{shadow:"never"}},[s("p",{staticClass:"statistics-title review-title"},[t._v("\n        点评情况\n        "),s("span",{on:{click:function(e){t.setReviewShow=!0}}},[s("svg",{staticClass:"icon feedback-icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#iconquanju_fankui"}})])])]),s("p",{staticClass:"task-volume"},[s("span",{staticClass:"task-text"},[t._v("点评咨询数量/人/医生：")]),s("span",{staticClass:"task-num"},[t._v(t._s(t.taskVolume))])]),s("p",{staticClass:"task-volume"},[s("span",{staticClass:"task-text"},[t._v(t._s(t.getMonth(0))+"月已点评任务量：")]),s("span",{staticClass:"task-num"},[t._v(t._s(t.statistics.cur_month_total))])]),s("p",{staticClass:"task-volume"},[s("span",{staticClass:"task-text"},[t._v(t._s(t.getMonth(-1))+"月点评任务量：")]),s("span",{staticClass:"task-num"},[t._v(t._s(t.statistics.pre_month_total))])]),s("p",{staticClass:"task-volume"},[s("span",{staticClass:"task-text"},[t._v("上线健康管理师数量：")]),s("span",{staticClass:"task-num"},[t._v(t._s(t.statistics.hm_count?t.statistics.hm_count.length:0))])])])],1),s("el-col",{staticClass:"item",attrs:{span:10}},[s("el-card",{attrs:{shadow:"never"}},[s("p",{staticClass:"statistics-title"},[t._v(t._s(t.getMonth())+"月点评量统计")]),t._l(t.statisticsList,(function(e,a){return s("div",{key:a,staticClass:"review-item"},[s("p",{staticClass:"finish-num"},[t._v("累计完成点评数量"+t._s(e.review_count))]),s("p",{staticClass:"task-volume"},[s("span",{staticClass:"segment"},[t._v(t._s(e.name))]),s("el-progress",{attrs:{color:t.colors[a],"show-text":!1,percentage:t.getNum(e.task_count,e.review_count),"stroke-width":15}}),s("span",{staticClass:"segment"},[t._v(t._s(0===e.task_count||e.task_count===e.review_count?"已完成":"未完成"+t.getNoFinishNum(e.task_count,e.review_count)))])],1)])}))],2)],1),s("el-col",{staticClass:"item",attrs:{span:10}},[s("el-card",{staticClass:"time-statistics",attrs:{shadow:"never"}},[s("p",{staticClass:"statistics-title"},[t._v(t._s(t.getMonth())+"月点评用时统计")]),t._l(t.statisticsList,(function(e,a){return s("div",{key:a,staticClass:"review-item"},[s("p",{staticClass:"finish-num"},[t._v(t._s(t.getTime(e.time)))]),s("p",{staticClass:"task-volume"},[s("span",{staticClass:"segment"},[t._v(t._s(e.name))]),s("el-progress",{attrs:{color:t.colors[a],"show-text":!1,percentage:t.getUseTime(e.time)||0,"stroke-width":15}})],1)])}))],2)],1),s("tip",{staticClass:"center",attrs:{"tip-show":t.setReviewShow,"btn-text":"确定","show-cancel-btn":!0,"has-footer":!0,"close-hid":!0,width:"400px",title:"点评情况设置"},on:{"update:tipShow":function(e){t.setReviewShow=e},"update:tip-show":function(e){t.setReviewShow=e},btnHandle:t.btnSetReviewShow,cancel:function(e){t.setReviewShow=!1,t.setReviewTip=""}}},[s("p",{attrs:{slot:"content"},slot:"content"},[s("span",[t._v("点评咨询数量/人/医生")]),s("el-input",{staticStyle:{display:"inline-block","margin-left":"10px",width:"auto"},attrs:{type:"number",placeholder:"请输入数量"},on:{blur:t.watchPerson},model:{value:t.personNum,callback:function(e){t.personNum=e},expression:"personNum"}}),s("span",{staticClass:"error"},[t._v(t._s(t.setReviewTip))])],1)])],1)},k=[],C=s("9039"),x={name:"ReviewStatistics",components:{Tip:C["a"]},data:function(){return{colors:[[{color:"#0085FF",percentage:0},{color:"#4EABFF",percentage:100}],[{color:"#67CA39",percentage:0},{color:"#53DE42",percentage:100}],[{color:"#FFB718",percentage:0},{color:"#FFC74A",percentage:100}]],setReviewShow:!1,setReviewTip:"",personNum:"",taskVolume:"",statisticsList:[],statistics:{}}},computed:{getMonth:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(new Date).getMonth()+1+t||12}},getTime:function(){return function(t){if(t<1)return"0-1分钟";if(t<60)return Math.round(t)+"分钟";var e=Math.round(t/60),s=parseInt(t-60*e);return"".concat(e,"时").concat(s,"分")}},getUseTime:function(){return function(t){if(this.statisticsList.length){var e=this.statisticsList.reduce((function(t,e){return t+e.time}),0);return Math.ceil(t/e*100)}return 0}},getNum:function(){return function(t,e){return t?Math.ceil(e/t*100)>100?100:Math.ceil(e/t*100):0}},getNoFinishNum:function(){return function(t,e){return t-e<0?0:t-e}}},created:function(){this.getTaskVolume(),this.getStatisticsContent()},methods:{btnSetReviewShow:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if((this.personNum+"").length){t.next=5;break}return this.setReviewTip="您输入的内容有误，请重新输入",t.abrupt("return");case 5:this.setReviewTip="";case 6:return t.next=8,Object(c["l"])({count:parseInt(this.personNum)});case 8:e=t.sent,s=e.code,a=e.data,2e4===s&&(a.result?(this.$message({message:"修改成功",type:"success"}),this.getTaskVolume(),this.setReviewShow=!1):this.$message({message:a.message,type:"error"}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),watchPerson:function(){(this.personNum+"").length?this.setReviewTip="":this.setReviewTip="您输入的内容有误，请重新输入"},getTaskVolume:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["R"])();case 2:e=t.sent,s=e.code,a=e.data,2e4===s&&a.result&&(this.taskVolume=a.task_count);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getStatisticsContent:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["P"])();case 2:if(e=t.sent,s=e.code,a=e.data,2e4===s&&a.result)for(n in this.statistics=a.statistics,i=a.statistics.dataMap,i)this.statisticsList.push({name:i[n].name,review_count:i[n].review_count,task_count:i[n].task_count,time:i[n].time});case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},T=x,S=(s("364e"),Object(m["a"])(T,y,k,!1,null,"167f6dbd",null)),R=S.exports,O={components:{ConsultingReview:d,ReviewStatistics:b,HrStatistics:R},data:function(){return{isOpen:!1,list:[],currentPage:1,delShow:!1,pageSize:12,count:0,rowInfo:"",hasListInfo:"暂无数据",singleList:[],createNameList:[],time:["",""],activeName:"first",type:this.$store.state.user.mts_user?this.$store.state.user.mts_user.type:"",character:this.$store.state.user.bus_role,topic:{type:"",name:"",stage:"",status:"",difficult:"",catalog:"",started_at:"",ended_at:""},typeList:[{value:"all",label:"全部"},{value:"radio",label:"单选题"},{value:"checkbox",label:"多选题"},{value:"short_answer",label:"简答题"}],stageList:[{value:"all",label:"全部"},{value:"0",label:"第一阶段"},{value:"1",label:"第二阶段"},{value:"2",label:"第三阶段"},{value:"3",label:"第四阶段"},{value:"4",label:"第五阶段"},{value:"5",label:"第六阶段"}],difficultyList:[{value:"all",label:"全部"},{value:"1",label:"简单"},{value:"2",label:"正常"},{value:"3",label:"难"}]}},watch:{time:function(t){this.topic.started_at=t[0],this.topic.ended_at=t[1]}},created:function(){var t=this.$route.query;this.time=[t.started_at||"",t.ended_at||""],t.page&&(this.currentPage=Number(t.page)),t.pageSize&&(this.pageSize=Number(t.pageSize)),this.isExistNegativeValue(this.topic,t),this.getQuestionList(t),this.getAllSingle()},methods:{isExistNegativeValue:function(t,e){for(var s in t=t||{},e=e||{},t)t.hasOwnProperty(s)&&e.hasOwnProperty(s)&&(t[s]=e[s])},getReviewType:function(t){switch(t){case"radio":return"单选题";case"checkbox":return"多选题";case"short_answer":return"简单题";default:return""}},getStageText:function(t){switch(t){case-1:return"试岗阶段";case 0:return"第一阶段";case 1:return"第二阶段";case 2:return"第三阶段";case 3:return"第四阶段";case 4:return"第五阶段";case 5:return"第六阶段";default:return""}},getDifficultText:function(t){switch(t){case"1":return"简单";case"2":return"正常";case"3":return"困难"}},getStatusText:function(t){switch(t){case"error":return"错误";case"success":return"正确";default:return"/"}},onSubmit:function(){this.currentPage=1,this.getQuestionList(this.isEmpty(Object(r["a"])({},this.topic,{page:1,pageSize:this.pageSize})))},isEmpty:function(t){var e={};for(var s in t=t||{},t)"[object Null]"===Object().toString.call(t[s])||"[object String]"===Object().toString.call(t[s])&&!t[s].trim()||t.hasOwnProperty(s)&&(e[s]=t[s]);return e},handleSizeChange:function(t){this.pageSize=t,this.getQuestionList(this.isEmpty(Object(r["a"])({},this.topic,{page:1,pageSize:t})))},handleCurrentChange:function(t){this.currentPage=t,this.getQuestionList(this.isEmpty(Object(r["a"])({},this.topic,{page:t,pageSize:this.pageSize})))},getQuestionList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s,a,i,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.hasListInfo=e?"暂无数据，请重新输入关键词":"暂无数据",t.next=3,Object(c["db"])(e);case 3:s=t.sent,a=s.data,i=s.code,2e4===i&&(this.count=a.count,this.list=a.list.map((function(t,e){return{num:(a.page-1)*a.pageSize+e+1,id:t._id,stem:t.stem.replace(/<\/?.+?>/g,""),is_review:(!t.diagnosis_review||!t.process_review)&&"short_answer"===t.type,title:t.catalog.title,stage:n.getStageText(t.stage),type:n.getReviewType(t.type),difficult:n.getDifficultText(t.difficult),name:t.name,status:n.getStatusText(t.status),updated_at:t.updated_at.split("T")[0]}})));case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getAllSingle:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["w"])();case 2:e=t.sent,s=e.code,a=e.data,2e4===s&&(this.singleList=a.list);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),goComment:function(t){if(!t.is_review)return!1;this.$router.push("/learning-admin/comment/management/"+t.id)},handleClick:function(t,e){this.$route.meta.title=t.label}},beforeRouteEnter:function(t,e,s){s((function(e){"咨询点评"===t.meta.title&&(e.activeName="second")}))}},L=O,j=(s("79c2"),Object(m["a"])(L,a,i,!1,null,"3e0ff6ee",null));e["default"]=j.exports},fb53:function(t,e,s){}}]);
//# sourceMappingURL=chunk-42100b2e.1820fdf8.js.map