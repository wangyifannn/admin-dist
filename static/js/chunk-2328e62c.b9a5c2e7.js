(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2328e62c"],{1651:function(e,t,r){},"53a9":function(e,t,r){"use strict";var n=r("c586"),a=r.n(n);a.a},7688:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-info"},[r("div",{staticClass:"head-info"},[r("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:"头像"}}),e._l(e.rowCount,(function(t,n){return r("div",{key:n,staticClass:"info-wrap"},[r("div",{staticClass:"info-item"},[e._v("\n        "+e._s(void 0!==e.headInfo[2*t-2]?e.headInfo[2*t-2].key+"：":"")+"\n        "+e._s(void 0!==e.headInfo[2*t-2]?e.headInfo[2*t-2].value:"")+"\n      ")]),r("div",{staticClass:"info-item"},[e._v("\n        "+e._s(void 0!==e.headInfo[2*t-1]?e.headInfo[2*t-1].key+"：":"")+"\n        "+e._s(void 0!==e.headInfo[2*t-1]?e.headInfo[2*t-1].value:"")+"\n      ")])])}))],2),r("el-tabs",{on:{"tab-click":e.tabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"信息详情",name:"info"}},[r("h3",{staticClass:"title"},[e._v("基本信息")]),r("vertical-table",{attrs:{"table-data":e.tableData,"table-style":{width:"100%"}}}),r("h3",{staticClass:"title"},[e._v("宝宝信息")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.babyList,border:""}},[r("el-table-column",{attrs:{prop:"name",label:"宝宝昵称",align:"center"}}),r("el-table-column",{attrs:{prop:"monthAge",label:"宝宝月龄",align:"center"}}),r("el-table-column",{attrs:{prop:"birthday",label:"宝宝出生日期",align:"center"}}),r("el-table-column",{attrs:{prop:"gender",label:"宝宝性别",align:"center"}})],1)],1),r("el-tab-pane",{attrs:{label:"跟进详情",name:"follow"}},[r("follow")],1),r("el-tab-pane",{attrs:{label:"订单详情",name:"order"}},[r("order",{attrs:{user:e.userId}})],1)],1)],1)},a=[],o=(r("7f7f"),r("96cf"),r("3b8d")),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.s_showByRow?r("table",{staticClass:"mailTable",style:e.styleObject},e._l(e.rowCount,(function(t,n){return r("tr",{key:n},[r("td",{staticClass:"column"},[e._v(e._s(e.tableData[4*t-4].key))]),r("td",[e._v(e._s(e.tableData[4*t-4].value))]),r("td",{staticClass:"column"},[e._v("\n      "+e._s(void 0!==e.tableData[4*t-3]?e.tableData[4*t-3].key:"")+"\n    ")]),r("td",[e._v("\n      "+e._s(void 0!==e.tableData[4*t-3]?e.tableData[4*t-3].value:"")+"\n    ")]),r("td",{staticClass:"column"},[e._v("\n      "+e._s(void 0!==e.tableData[4*t-2]?e.tableData[4*t-2].key:"")+"\n    ")]),r("td",[e._v("\n      "+e._s(void 0!==e.tableData[4*t-2]?e.tableData[4*t-2].value:"")+"\n    ")]),r("td",{staticClass:"column"},[e._v("\n      "+e._s(void 0!==e.tableData[4*t-1]?e.tableData[4*t-1].key:"")+"\n    ")]),r("td",[e._v("\n      "+e._s(void 0!==e.tableData[4*t-1]?e.tableData[4*t-1].value:"")+"\n    ")])])})),0):r("table",{staticClass:"mailTable",style:e.styleObject},e._l(e.rowCount,(function(t,n){return r("tr",{key:n},[r("td",{staticClass:"column"},[e._v(e._s(e.tableData[t-1].key))]),r("td",[e._v(e._s(e.tableData[t-1].value))]),r("td",{staticClass:"column"},[e._v("\n      "+e._s(void 0!==e.tableData[e.rowCount+t-1]?e.tableData[e.rowCount+t-1].key:"")+"\n    ")]),r("td",[e._v("\n      "+e._s(void 0!==e.tableData[e.rowCount+t-1]?e.tableData[e.rowCount+t-1].value:"")+"\n    ")])])})),0)},u=[],i={data:function(){return{styleObject:{},s_showByRow:!0}},props:["tableData","tableStyle","showByRow"],computed:{rowCount:function(){return Math.ceil(this.tableData.length/4)}},created:function(){this.styleObject=this.tableStyle,void 0!==this.showByRow&&(this.s_showByRow=this.showByRow)}},s=i,c=(r("d762"),r("2877")),d=Object(c["a"])(s,l,u,!1,null,null,null),f=d.exports,p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"follow-detail"},[r("el-form",{ref:"followForm",attrs:{"label-position":"left","label-width":"70px",model:e.followForm,inline:""}},[r("el-form-item",{staticClass:"search-item",attrs:{label:"跟进时间"}},[r("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"起始跟进时间","end-placeholder":"截至跟进时间","value-format":"yyyy-MM-dd"},model:{value:e.followForm.time,callback:function(t){e.$set(e.followForm,"time",t)},expression:"followForm.time"}})],1),r("el-form-item",{staticClass:"search-item",attrs:{label:"跟进人"}},[r("el-select",{attrs:{filterable:"","allow-create":"",clearable:"",placeholder:"请选择跟进人"},model:{value:e.followForm.followPerson,callback:function(t){e.$set(e.followForm,"followPerson",t)},expression:"followForm.followPerson"}},e._l(e.followPersonList,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{staticClass:"search-item",attrs:{label:"签约状态"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择签约状态"},model:{value:e.followForm.status,callback:function(t){e.$set(e.followForm,"status",t)},expression:"followForm.status"}},e._l(e.statusList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{staticClass:"search-item",attrs:{label:"用户类型"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择用户类型"},model:{value:e.followForm.type,callback:function(t){e.$set(e.followForm,"type",t)},expression:"followForm.type"}},e._l(e.typeList,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{staticStyle:{float:"right"}},[r("el-button",{staticClass:"select-btn",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),r("el-button",{staticClass:"select-btn",attrs:{type:"primary"},on:{click:e.resetForm}},[e._v("重置")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.followInfoList,"empty-text":e.hasListInfo,border:""}},[r("el-table-column",{attrs:{prop:"num",label:"序号",align:"center"}}),r("el-table-column",{attrs:{prop:"actionName",label:"跟进动作名称",align:"center"}}),r("el-table-column",{attrs:{prop:"followStatus",label:"跟进类型",align:"center"}}),r("el-table-column",{attrs:{prop:"followPerson",label:"操作人",align:"center"}}),r("el-table-column",{attrs:{prop:"type",label:"用户类型",align:"center"}}),r("el-table-column",{attrs:{prop:"status",label:"签约状态",align:"center"}}),r("el-table-column",{attrs:{prop:"time",label:"跟进时间",align:"center"}})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},m=[],h=r("ca7e"),b={data:function(){return{currentPage:1,pageSize:10,count:0,followForm:{time:["",""],followPerson:"",status:"",type:""},followPersonList:[],statusList:[{value:"empty",label:"未签约"},{value:"pending_service",label:"待激活"},{value:"in-service",label:"服务中"},{value:"out-service",label:"已过期"}],typeList:[],followInfoList:[],hasListInfo:"暂无跟进信息"}},computed:{translateType:function(){return function(e){return"first"===e?"首次跟进":"announcement"===e?"活动通知":"take_care"===e?"回访":"visit"===e?"日常关心":void 0}},getOrderType:function(){return function(e){return"out_service"===e?"服务结束":"in_service"===e?"服务中":"pending_service"===e?"待激活":"empty"!==e&&e?"pending_active"===e?"待激活":void 0:"未签约"}},getUserTypeInfo:function(){return function(e){return e&&e.type?e.type+(e.level?"-"+e.level:""):""}}},created:function(){this.getFollowLog(),this.getAdminList(),this.getUserTypeList()},methods:{onSubmit:function(){this.getFollowLog(this.followForm)},handleSizeChange:function(e){this.pageSize=e,this.getFollowLog(this.followForm)},handleCurrentChange:function(e){this.currentPage=e,this.getFollowLog(this.followForm)},resetForm:function(){this.followForm={time:["",""],followPerson:"",status:"",type:""}},getAdminList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["n"])({pageSize:0});case 2:t=e.sent,r=t.code,n=t.data,1e4===r&&(this.followPersonList=n.map((function(e){return e.name})));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getFollowLog:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={page:this.currentPage,pageSize:this.pageSize,external_userid:this.$route.params.id},t&&(t.status&&(r.order_status=t.status),t.type&&(r.user_type=t.type),t.followPerson&&(r.helper_name=t.followPerson),t.time&&t.time[0]&&t.time[1]&&(r.created_at=t.time[0]+" | "+t.time[1])),e.next=4,Object(h["s"])(r);case 4:n=e.sent,a=n.code,o=n.data,1e4===a&&(this.count=o.count,this.followInfoList=o.list.map((function(e,t){return{num:(l.currentPage-1)*l.pageSize+t+1,actionName:e.name,followStatus:l.translateType(e.type)||"/",followPerson:e.helper_name||"/",type:l.getUserTypeInfo(e.user_type)||"/",status:l.getOrderType(e.order_status)||"/",time:l.formatTime(e.follow_at)||"/"}})));case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getUserTypeList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["B"])({pageSize:0});case 2:t=e.sent,r=t.code,n=t.data,1e4===r&&(this.typeList=n.list.map((function(e){return e.type+(e.level?"-"+e.level:"")})).filter((function(e,t,r){return r.indexOf(e)===t})));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},v=b,_=(r("8c47"),Object(c["a"])(v,p,m,!1,null,"114c835e",null)),g=_.exports,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-info"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderInfoList,"empty-text":e.hasListInfo,border:""}},[r("el-table-column",{attrs:{prop:"orderNum",label:"订单号",align:"center"}}),r("el-table-column",{attrs:{prop:"orderName",label:"订单名称",align:"center"}}),r("el-table-column",{attrs:{prop:"type",label:"订单类型",align:"center"}}),r("el-table-column",{attrs:{prop:"price",label:"单价",align:"center"}}),r("el-table-column",{attrs:{prop:"count",label:"数量",align:"center"}}),r("el-table-column",{attrs:{prop:"actualReceipts",label:"实收款",align:"center"}}),r("el-table-column",{attrs:{prop:"status",label:"交易状态",align:"center"}}),r("el-table-column",{attrs:{prop:"saleStatus",label:"售后状态",align:"center"}}),r("el-table-column",{attrs:{prop:"time",label:"订单创建时间",align:"center"}})],1)],1)},w=[],k={props:{user:{type:String,default:""}},data:function(){return{orderInfoList:[],hasListInfo:"暂无订单信息"}},watch:{user:function(e){e&&this.getOrderList()}},computed:{getTradeStatusCh:function(){return function(e){return"SUCCESS"===e?"交易成功":"PENDING"===e?"待支付":"CLOSED"===e?"交易关闭":void 0}},getSaleStatusCh:function(){return function(e){return"PENDING_TRANSFER_ACCOUNT"===e?"退款待到账":"FAIL_TRANSFER_ACCOUNT"===e?"退款到账失败":"SUCCESS_MANUAL"===e?"退款成功(人工)":"SUCCESS_AUTO"===e?"退款成功(自动)":void 0}}},methods:{getOrderList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["v"])(this.user);case 2:t=e.sent,r=t.code,n=t.data,1e4===r&&(this.orderInfoList=n.list.map((function(e){return{orderNum:e._id,orderName:"FdServiceType"===e.order_type?e.order_logic_data.product_info.title+e.order_logic_data.product_info.sub_title:"单次问诊",type:"FdServiceType"===e.order_type?"家庭医生":"单次问诊",price:e.cost_price?e.cost_price/100:0,count:1,actualReceipts:e.pay_price?e.pay_price/100:0,status:a.getTradeStatusCh(e.trade_status),saleStatus:a.getSaleStatusCh(e.refund_status)||"/",time:a.formatTime(e.created_at)}})));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},C=k,S=(r("9f8c"),Object(c["a"])(C,y,w,!1,null,"3639a21a",null)),I=S.exports,L=r("ed08"),F={components:{VerticalTable:f,Follow:g,Order:I},data:function(){return{tableData:[],headInfo:[],babyList:[],avatar:"",activeName:"info",userId:""}},computed:{rowCount:function(){return Math.ceil(this.headInfo.length/2)},getOrderType:function(){return function(e){return"out_service"===e?"服务结束":"in_service"===e?"服务中":"pending_service"===e?"待激活":"empty"!==e&&e?"pending_active"===e?"待激活":void 0:"未签约"}},getMonthAge:function(){return function(e){var t=Object(L["e"])(e);return"".concat(t.year?t.year+"年":"").concat(t.month?t.month+"月":"").concat(t.date?t.date+"日":"")||"1天"}},getUserTypeInfo:function(){return function(e){return e?e.type+(e.level?"-"+e.level:""):""}},getFollowInfo:function(){return function(e,t,r){return(e>0?"跟进中":"未跟进")+" | "+(e||0)+"/"+(t||0)+" | "+(r?this.formatTime(r):"/")}},getUserSource:function(){return function(e){return e&&e.first_name?"".concat(e.first_name,"-").concat(e.second_name,"-").concat(e.three_name):""}}},created:function(){this.getUserInfo()},methods:{tabClick:function(e,t){},getUserInfo:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["z"])(this.$route.params.id);case 2:t=e.sent,r=t.code,n=t.data,1e4===r&&n&&(this.avatar=n.avatar,this.userId=n.user||"",this.headInfo=[{key:"用户昵称",value:n.name},{key:"当前负责人",value:n.handler_name+(n.nickname?"(".concat(n.nickname,")"):"")||"/"},{key:"用户类型",value:this.getUserTypeInfo(n.user_type)||"/"},{key:"跟进情况",value:this.getFollowInfo(n.follow_current_times,n.follow_total_times,n.last_follow_at)},{key:"用户诉求",value:n.user_remark||"/"}],this.tableData=[{key:"用户昵称",value:n.name},{key:"用户性别",value:1===n.gender?"男":2===n.gender?"女":"未知"},{key:"首次添加时间",value:this.formatTime(n.created_at)},{key:"更新时间",value:this.formatTime(n.updated_at)},{key:"用户类型",value:this.getUserTypeInfo(n.user_type)||"/"},{key:"当前负责人",value:n.handler_name+(n.nickname?"(".concat(n.nickname,")"):"")||"/"},{key:"首次负责人",value:n.first_handler_name+(n.first_nickname?"(".concat(n.first_nickname,")"):"")||"/"},{key:"用户来源",value:this.getUserSource(n.user_source)},{key:"来源场景",value:n.user_remark||"/"},{key:"用户诉求",value:n.from_scene||"/"},{key:"签约次数",value:n.order_count||0},{key:"跟进状态",value:n.follow_current_times>0?"跟进中":"未跟进"},{key:"阶段跟进次数",value:n.follow_current_times||0},{key:"最近一次跟进时间",value:n.last_follow_at?this.formatTime(n.last_follow_at):"/"},{key:"跟进总数",value:n.follow_total_times||0}],n.member&&(this.babyList=n.member.map((function(e){return{name:e.name,monthAge:a.getMonthAge(e.birthday),birthday:a.formatTime(e.birthday),gender:1===e.gender?"男":2===e.gender?"女":"未知"}}))));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},O=F,T=(r("53a9"),Object(c["a"])(O,n,a,!1,null,"e2e9bd14",null));t["default"]=T.exports},8278:function(e,t,r){},"8c47":function(e,t,r){"use strict";var n=r("8278"),a=r.n(n);a.a},"9f8c":function(e,t,r){"use strict";var n=r("1651"),a=r.n(n);a.a},c586:function(e,t,r){},ca7e:function(e,t,r){"use strict";var n=r("bc3a"),a=r.n(n),o=r("5c96"),l=r("a18c"),u=r("4360"),i=r("5f87"),s=a.a.create({baseURL:"https://api-crm.baobaohehu.com",timeout:2e5});s.interceptors.request.use((function(e){return u["a"].getters.token&&(e.headers["Authorization"]=Object(i["a"])()),e}),(function(e){return console.log(e),Promise.reject(e)})),s.interceptors.response.use((function(e){var t=e.config,r=e.data;return t.url.indexOf(t.baseURL)>-1&&1e4!==r.code?40001===r.code?(l["c"].push("/404"),Promise.reject()):(Object(o["Message"])({message:r.message||"Error",type:"error",duration:5e3}),401===r.code&&u["a"].dispatch("user/resetToken").then((function(){location.reload()})),Promise.reject(new Error(r.message||"Error"))):r}),(function(e){return console.log("err"+e),Object(o["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var c=s;function d(e){return c({url:"/corp/wechat/helper",method:"get",params:e})}function f(e){return c({url:"/corp/admin",method:"get",params:e})}function p(e){return c({url:"/corp/helper",method:"get",params:e})}function m(e){return c({url:"/corp/helper",method:"post",data:e})}function h(e,t){return c({url:"/corp/helper/"+e,method:"put",data:t})}function b(e,t){return c({url:"/corp/helper/change/"+e,method:"put",data:t})}function v(e){return c({url:"/corp/helper/"+e,method:"delete"})}function _(e){return c({url:"/corp/source_channel",method:"get",params:e})}function g(e){return c({url:"/corp/source_channel",method:"post",data:e})}function y(e,t){return c({url:"/corp/source_channel/"+e,method:"put",data:t})}function w(e){return c({url:"/corp/source_channel/"+e,method:"delete"})}function k(e){return c({url:"/corp/user_type",method:"get",params:e})}function C(e){return c({url:"/corp/user_type",method:"post",data:e})}function S(e,t){return c({url:"/corp/user_type/"+e,method:"put",data:t})}function I(e){return c({url:"/corp/user_type/"+e,method:"delete"})}function L(e){return c({url:"/corp/user_visit",method:"get",params:e})}function F(e){return c({url:"/corp/user_visit",method:"post",data:e})}function O(e,t){return c({url:"/corp/user_visit/"+e,method:"put",data:t})}function T(e){return c({url:"/corp/user_visit/"+e,method:"delete"})}function x(e){return c({url:"/corp/user_visit/status/"+e,method:"put"})}r.d(t,"u",(function(){return d})),r.d(t,"n",(function(){return f})),r.d(t,"t",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"C",(function(){return h})),r.d(t,"H",(function(){return b})),r.d(t,"i",(function(){return v})),r.d(t,"o",(function(){return _})),r.d(t,"b",(function(){return g})),r.d(t,"F",(function(){return y})),r.d(t,"g",(function(){return w})),r.d(t,"B",(function(){return k})),r.d(t,"f",(function(){return C})),r.d(t,"I",(function(){return S})),r.d(t,"l",(function(){return I})),r.d(t,"r",(function(){return L})),r.d(t,"c",(function(){return F})),r.d(t,"G",(function(){return O})),r.d(t,"h",(function(){return T})),r.d(t,"E",(function(){return x})),r.d(t,"q",(function(){return D})),r.d(t,"z",(function(){return j})),r.d(t,"s",(function(){return R})),r.d(t,"A",(function(){return P})),r.d(t,"v",(function(){return U})),r.d(t,"a",(function(){return N})),r.d(t,"D",(function(){return z})),r.d(t,"x",(function(){return A})),r.d(t,"k",(function(){return E})),r.d(t,"y",(function(){return $})),r.d(t,"w",(function(){return M})),r.d(t,"p",(function(){return B})),r.d(t,"e",(function(){return q})),r.d(t,"j",(function(){return G})),r.d(t,"m",(function(){return J}));var D=function(e){return c({url:"corp/user",method:"get",params:e})},j=function(e){return c({url:"corp/admin/crm_user/"+e,method:"get"})},R=function(e){return c({url:"corp/follow_up_log",method:"get",params:e})},P=function(e){return c({url:"corp/source_channel",method:"get",params:e})},U=function(e){return c({url:"corp/admin/order/"+e,method:"get"})},N=function(e){return c({url:"corp/admin/scene",method:"post",data:e})},z=function(e,t){return c({url:"corp/admin/scene/"+e,method:"put",data:t})},A=function(e){return c({url:"corp/admin/scene/detail/"+e,method:"get"})},E=function(e){return c({url:"corp/admin/scene/"+e,method:"delete"})},$=function(e){return c({url:"corp/admin/scene",method:"get",params:e})},M=function(e){return c({url:"corp/admin/scene/qrcode/"+e,method:"get"})},B=function(e){return c({url:"corp/admin/wx_qrcode",method:"get",params:e})},q=function(e){return c({url:"corp/admin/wx_qrcode",method:"post",data:e})},G=function(e){return c({url:"corp/admin/wx_qrcode/"+e,method:"delete"})},J=function(e){return c({url:"corp/admin/wx_qrcode/download",method:"get",params:e})}},d557:function(e,t,r){},d762:function(e,t,r){"use strict";var n=r("d557"),a=r.n(n);a.a}}]);
//# sourceMappingURL=chunk-2328e62c.b9a5c2e7.js.map