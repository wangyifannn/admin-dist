(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d07bdc30"],{"421f":function(e,r,t){},7043:function(e,r,t){"use strict";var a=t("421f"),n=t.n(a);n.a},"91b6":function(e,r,t){"use strict";t.d(r,"a",(function(){return o})),t.d(r,"b",(function(){return l})),t.d(r,"c",(function(){return c}));t("7f7f"),t("386d"),t("28a5");var a=t("db72"),n=(t("96cf"),t("3b8d")),s=t("b775"),o=function(){return Object(s["a"])({url:"/oss/auth",method:"get"})},u=function(e){return Object(s["a"])({url:e+"?x-oss-process=image/info",method:"get"})},l=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var t,n,o,l,i,c,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.oss,n=r.key,o=r.file,l=r.onProgress,i=new FormData,i.append("OSSAccessKeyId",t.OSSAccessKeyId),i.append("success_action_status",200),i.append("policy",t.policy),i.append("Signature",t.Signature),i.append("key",n),i.append("file",o),c="https://pic1.baobaohehu.com/",e.next=11,Object(s["a"])({url:c,method:"post",headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l||null,data:i});case 11:if(c+=n,!(o.type.indexOf("image")>-1)){e.next=18;break}return e.next=15,u(c);case 15:m=e.sent,e.next=27;break;case 18:if(!(o.type.indexOf("video")>-1)){e.next=22;break}m=Object(a["a"])({},o.videoMeta,{size:o.size}),e.next=27;break;case 22:if(!(o.type.indexOf("audio")>-1)){e.next=26;break}m={size:o.size,type:o.type},e.next=27;break;case 26:throw new Error("当前上传的类型不是image或者video；当前上传的类型是"+o.type);case 27:return e.abrupt("return",{url:c,meta:m});case 28:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),i=function(e){if(!e||"string"!==typeof e)return!1;var r=e.split("").reverse().join(""),t=r.substring(0,r.search(/\./)).split("").reverse().join("");return t},c=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r,t){var a,n,s,u,c,m,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:return a=e.sent,n=a.data,s=Math.floor(99*Math.random())+1,u=(new Date).getTime(),c=i(r.name),u=u+s+"."+c,m="".concat(n.path,"/").concat(n.prefix,"/").concat(u),e.next=11,l({oss:n,key:m,file:r,onProgress:t});case 11:return p=e.sent,e.abrupt("return",p);case 13:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()},bf54:function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"series-course"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"课程名称",prop:"name"}},[t("el-input",{attrs:{maxlength:"20","show-word-limit":"",placeholder:"请输入课程名称",disabled:e.disabled},model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"课程节数",prop:"num"}},[t("el-input",{attrs:{placeholder:"请输入阿拉伯数字，1，2.......",disabled:e.disabled},model:{value:e.ruleForm.num,callback:function(r){e.$set(e.ruleForm,"num",e._n(r))},expression:"ruleForm.num"}})],1),t("el-form-item",{attrs:{label:"章节导言",prop:"summary"}},[t("el-input",{attrs:{type:"textarea",resize:"none",maxlength:"300","show-word-limit":"",placeholder:"请输入章节导言内容",disabled:e.disabled},model:{value:e.ruleForm.summary,callback:function(r){e.$set(e.ruleForm,"summary",r)},expression:"ruleForm.summary"}})],1),t("el-form-item",{attrs:{label:"重点内容",prop:"content"}},[t("el-input",{attrs:{type:"textarea",resize:"none",maxlength:"2000","show-word-limit":"",placeholder:"请输入重点内容",disabled:e.disabled},model:{value:e.ruleForm.content,callback:function(r){e.$set(e.ruleForm,"content",r)},expression:"ruleForm.content"}})],1),"catalog"!==e.ruleForm.type?t("el-form-item",{attrs:{label:"课程栏目",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.type,callback:function(r){e.$set(e.ruleForm,"type",r)},expression:"ruleForm.type"}},[t("el-option",{attrs:{label:"企业文化",value:"corporate_culture"}}),t("el-option",{attrs:{label:"健康管理师职责",value:"service_responsibilities"}}),t("el-option",{attrs:{label:"工作流程",value:"workflow"}}),t("el-option",{attrs:{label:"专业能力知识",value:"professional_knowledge"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"课程封面",prop:"cover"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"http-request":e.uploadFunc,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.ruleForm.cover?t("img",{staticClass:"avatar",attrs:{src:e.ruleForm.cover,alt:"封面"}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n          建议尺寸600*280px，JPG、PNG格式，图片小于5M\n        ")])])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],1)],1)},n=[],s=(t("7f7f"),t("96cf"),t("3b8d")),o=t("f296"),u=t("91b6"),l={data:function(){return{ruleForm:{name:"",num:"",summary:"",content:"",type:"",cover:""},rules:{name:[{required:!0,message:"您输入的内容有误，请重新输入",trigger:"blur"}],num:[{required:!0,message:"您输入的内容有误，请重新输入",trigger:"blur"},{type:"number",message:"必须为数字值"}],summary:[{required:!0,message:"您输入的内容有误，请重新输入",trigger:"blur"}],content:[{required:!0,message:"您输入的内容有误，请重新输入",trigger:"blur"}],type:[{required:!0,message:"请进行选择后再操作",trigger:"change"}],cover:[{required:!0,message:"请上传封面文件",trigger:"change"}]},disabled:!1,uploading:!1}},created:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$route.params.id){e.next=6;break}return e.next=3,Object(o["t"])(this.$route.params.id);case 3:r=e.sent,t=r.data,t&&t.result&&(this.disabled="catalog"===t.mtsCatalog.lesson_column,this.ruleForm={name:t.mtsCatalog.title,num:t.mtsCatalog.total_chapter,summary:t.mtsCatalog.summary,content:t.mtsCatalog.content,type:t.mtsCatalog.lesson_column,cover:t.mtsCatalog.cover});case 6:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),methods:{uploadFunc:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["c"])(r.file,(function(e){}));case 2:t=e.sent,this.ruleForm.cover=t.url;case 4:case"end":return e.stop()}}),e,this)})));function r(r){return e.apply(this,arguments)}return r}(),submitForm:function(e){var r=this;if(this.uploading)return this.$message({message:"图片/封面正在上传中不能进行提交",type:"error"}),!1;this.$refs[e].validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,s,u,l,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=16;break}if(!r.$route.params.id){e.next=10;break}return e.next=4,Object(o["u"])(r.$route.params.id,{title:r.ruleForm.name,summary:r.ruleForm.summary,content:r.ruleForm.content,cover:r.ruleForm.cover,total_chapter:parseInt(r.ruleForm.num),lesson_column:r.ruleForm.type,category:"series_lesson"});case 4:a=e.sent,n=a.data,s=a.code,2e4===s&&n.result&&(r.$message({message:"修改成功",type:"success"}),r.$router.push("/learning-admin/course")),e.next=16;break;case 10:return e.next=12,Object(o["k"])({title:r.ruleForm.name,summary:r.ruleForm.summary,content:r.ruleForm.content,cover:r.ruleForm.cover,total_chapter:r.ruleForm.num,lesson_column:r.ruleForm.type,category:"series_lesson"});case 12:u=e.sent,l=u.data,i=u.code,2e4===i&&l.result&&(r.$message({message:"添加成功",type:"success"}),r.$router.push("/learning-admin/course"));case 16:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},handleAvatarSuccess:function(e,r){this.uploading=!1,this.$message({message:"上传成功",type:"success"})},beforeAvatarUpload:function(e){this.uploading=!0;var r=["image/jpeg","image/jpg","image/png"].indexOf(e.type)>=0,t=e.size/1024/1024<5;return r||this.$message.error("上传头像图片只能是 JPG或PNG 格式!"),t||this.$message.error("上传头像图片大小不能超过 5MB!"),r&&t}}},i=l,c=(t("7043"),t("2877")),m=Object(c["a"])(i,a,n,!1,null,"7d44d922",null);r["default"]=m.exports}}]);
//# sourceMappingURL=chunk-d07bdc30.b53ed4f5.js.map