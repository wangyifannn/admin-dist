(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-304cebf8"],{"0969":function(e,t,r){"use strict";function a(e){switch(e){case"PENDING":return"待付款";case"SUCCESS":return"交易成功";case"CLOSED":return"交易关闭";default:if(e)throw new Error("无法识别的订单状态: ".concat(e));return""}}function o(e){switch(e){case"FdServiceType":return"家庭医生";case"InquiryServiceType":return"问诊";default:throw new Error("无法识别的订单类型: ".concat(e))}}function n(e){switch(e){case"apply_pending":return"请处理退款申请";case"refund_refused":return"退款已被拒绝";case"refund_process":return"退款中";case"refund_success":return"退款成功";default:throw new Error("无法识别的售后状态: ".concat(e))}}r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return n}))},3828:function(e,t,r){"use strict";var a=r("e88d"),o=r.n(a);o.a},"50d1":function(e,t,r){"use strict";var a=r("f597"),o=r.n(a);o.a},6091:function(e,t,r){},"6e4a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"customer-info"},[r("customer-basic-info",{attrs:{"customer-id":e.$route.params.id}})],1),r("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"历史运营动作",name:"operationAction"}}),r("el-tab-pane",{attrs:{label:"客户信息",name:"userInfo"}}),r("el-tab-pane",{attrs:{label:"订单信息",name:"order"}})],1),r("div",["userInfo"===e.activeName?r("user-info"):"operationAction"===e.activeName?r("operation"):"order"===e.activeName?r("order"):e._e()],1)],1)},o=[],n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("CustomerForm",{attrs:{showStep:!1,pageType:"updateCustomer"}})],1)},i=[],s=r("38bd"),l={data:function(){return{}},components:{CustomerForm:s["default"]}},c=l,u=r("2877"),d=Object(u["a"])(c,n,i,!1,null,null,null),f=d.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",{staticClass:"margin-top-20"},[r("OrderTable")],1)},h=[],p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("MyTable",{attrs:{size:"mini",stripe:!1,border:!0,multiple:!1,outlineBorder:!1,operation:e.operation,column:e.column,data:e.data,currentPage:e.currentPage,pageSize:e.pageSize,total:e.total},on:{followCustomer:e.followCustomer,detail:e.detail,handleCurrentChange:e.handleCurrentChange,handleSizeChange:e.handleSizeChange},scopedSlots:e._u([{key:"afterMarket",fn:function(t){return["退款给客户"===t.row.afterSaleStatus?r("div",[r("div",[e._v("无")]),r("el-button",{staticClass:"cherry",attrs:{type:"text",size:"mini"},on:{click:function(r){return e.goToOrderPage(t.row.orderId)}}},[e._v("退款给用户")])],1):r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.goToRefundPage(t.row.orderRefund._id)}}},[e._v(e._s(t.row.afterSaleStatus)+"\n      ")])]}},{key:"tradeStatus",fn:function(t){return[r("div",[e._v(e._s(t.row.tradeStatus))]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.goToDetailPage(t.row)}}},[e._v("详情")])]}},{key:"user",fn:function(t){return[r("div",[e._v(e._s(t.row.user&&t.row.user.name))]),r("div",[e._v(e._s(t.row.user&&t.row.user.id))])]}}])})],1)},_=[],g=(r("ac6a"),r("116c")),v=r("b5b3"),b=r("3acd"),w=r("0969"),y=r("2ef0"),S=r.n(y),C=r("8975"),T={data:function(){var e={show:!1};return{column:[],data:[],loading:!1,pageSize:10,currentPage:1,total:0,operation:e}},components:{MyTable:v["a"]},created:function(){this.fieldInit(),this.getOrderList()},methods:{goToRefundPage:function(e){this.$router.push({name:"RefundDetail",params:{id:e}})},goToOrderPage:function(e){this.$router.push({name:"OrderList",params:{orderId:e}})},goToDetailPage:function(e){this.$router.push({path:"/trade/order/".concat(e.id)})},getOrderList:function(){var e=this;this.loading=!0;var t=this.$route.params.id,r={page_size:this.pageSize,current_page:this.currentPage};Object(b["k"])(t,r).then((function(t){e.loading=!1,2e4===t.code&&(e.setTableData(t.data),e.total=t.data.count)})).catch((function(t){e.loading=!1}))},fieldInit:function(){var e=Object(g["a"])("orderList");e.forEach((function(e){e.width&&"auto"!=e.width&&(e.width="300")})),this.column=e},detail:function(e){this.$router.push({path:"/crm/customer/detail/".concat(e.id)})},followCustomer:function(){},handleCurrentChange:function(e){this.currentPage=e,this.getOrderList()},handleSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.getOrderList()},setTableData:function(e){var t=this,r=e.list;this.tableDate=r.map((function(e,r){return{orderId:e.order_id,createAt:e.create_at?t.formatTime(e.create_at):"-",orderName:e.order_name,orderType:e.order_type,count:e.count,afterSaleStatus:S.a.get(e,"after_sale_status.key")?Object(w["a"])(S.a.get(e,"after_sale_status.key")):"退款给客户",unitPrice:Object(C["RMBSymbol"])(Object(C["fenToYuan"])(e.unit_price)),user:{name:e.nickname,id:e.user_id},tradeStatus:Object(w["c"])(e.trade_status),cost:Object(C["RMBSymbol"])(Object(C["fenToYuan"])(e.cost)),orderRefund:e.order_refund,id:e._id}})),this.data=this.tableDate}}},O=T,P=(r("50d1"),Object(u["a"])(O,p,_,!1,null,"1f918ccc",null)),F=P.exports,k={data:function(){return{searchFormShow:!0}},components:{OrderTable:F},methods:{}},D=k,z=Object(u["a"])(D,m,h,!1,null,null,null),$=z.exports,j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{staticClass:"margin-top-20"},[r("el-col",{attrs:{span:4,offset:1}},[r("div",{staticClass:"margin-left-20"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.followDialogVisible=!0}}},[e._v("跟进客户")])],1)]),r("el-col",{attrs:{span:19}},[r("el-form",{ref:"historySearchForm",attrs:{inline:!0,model:e.historySearchForm}},[r("el-form-item",{attrs:{label:"运营动作创建时间",prop:"createTimeRange"}},[r("el-date-picker",{attrs:{size:"mini",type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.historySearchForm.createTimeRange,callback:function(t){e.$set(e.historySearchForm,"createTimeRange",t)},expression:"historySearchForm.createTimeRange"}})],1),r("follower-select",{attrs:{prop:"follower","customer-id":e.$route.params.id},model:{value:e.historySearchForm.follower,callback:function(t){e.$set(e.historySearchForm,"follower",t)},expression:"historySearchForm.follower"}}),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.searchPath}},[e._v("查询")]),r("el-button",{attrs:{size:"mini"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1)],1)],1),r("div",{staticClass:"flex-col-center margin-top-20"},[r("follow-timeline",{ref:"followTimeline"})],1),r("follow-customer-dialog",{attrs:{followDialogVisible:e.followDialogVisible,"customer-id":e.$route.params.id},on:{closeDialog:function(t){e.followDialogVisible=!1},followSuccess:e.onFollowSuccess}})],1)},I=[],x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form-item",{attrs:{label:e.label,prop:e.prop,rules:e.rules}},[r("el-select",{attrs:{value:e.value,placeholder:e.placeholder,disabled:e.selectDisable,clearable:"",size:"mini"},on:{change:e.onValueChange}},e._l(e.options,(function(t){return r("el-option",{key:t.value,attrs:{value:t.value,label:t.label}},[e._v(e._s(t.label))])})),1)],1)},R=[],E={data:function(){return{options:[{value:"wanggang",label:"王刚"}]}},props:{selectDisable:{type:Boolean,default:!1},value:{type:String,default:""},moduleName:{type:String,default:"跟进人"},label:{type:String,default:"跟进人"},prop:{type:String,default:""},rules:{type:Array,default:function(){return[]}},customerId:{type:String,default:""},placeholder:{type:String,default:"请选择"}},created:function(){this.getFollowers(this.customerId)},methods:{onValueChange:function(e){this.$emit("input",e)},getFollowers:function(e){var t=this;Object(b["j"])(e).then((function(e){2e4===e.code&&(t.options=e.data)}))}}},N=E,L=Object(u["a"])(N,x,R,!1,null,null,null),V=L.exports,A=r("d95e"),B=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],staticClass:"time-line-wrap",attrs:{"infinite-scroll-immediate":!1}},e._l(e.timeLineInfo,(function(t,a){return r("div",{key:t.created_at+a,staticClass:"time-line"},[r("div",{style:{color:e.switchDotStyle(t).dotColor}},[r("i",{staticClass:"iconfont dot",class:e.switchDotStyle(t).iconType})]),r("div",{staticClass:"line"}),r("div",[r("div",{staticClass:"card-title"},[r("div",{staticClass:"card-title__name"},[e._v(e._s(t.creator))]),"follow"!==t.action_type?r("div",{staticClass:"card-title__content"},[e._v("\n          "+e._s(t.action_type_value)+"\n        ")]):r("div",{staticClass:"card-title__content"},[e._v("\n          "+e._s(t.opration_action)+"\n        ")]),r("div",{staticClass:"card-title__time"},[e._v("\n          "+e._s(e.formatTime(t.created_at))+"\n        ")])]),r("div",{staticClass:"card-body"},["follow"===t.action_type?r("div",[r("div",[e._v("\n            跟进日期："+e._s(e.formatTime(t.action_at,"{y}-{m}-{d}"))+"\n          ")]),r("div",[e._v("备注："+e._s(t.desc))])]):"relative"===t.action_type?r("div",[r("div",[e._v("用户ID： "+e._s(t.user.user_id))])]):"out_service"===t.action_type?r("div",[r("div",[e._v("用户ID： "+e._s(t.user.user_id))])]):"add_order"===t.action_type?r("div",{staticClass:"add_order"},[r("div",[e._v("\n            订单类型："+e._s(t.order&&t.order.order_type)+"\n                订单号：\n            "),r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.goToOrderPage(t.order.order_id)}}},[e._v(e._s(t.order&&t.order.order_id))])],1)]):e._e()])])])})),0)},M=[],J=r("db72"),U=r("9873"),Y=r("ed08"),q={name:"FollowTimeLine",components:{},data:function(){return{timeLineInfo:[],pageSize:10,currentPage:1,total:0,searchParams:{}}},methods:{switchDotStyle:U["b"],load:function(){this.pageSize<this.total&&(this.pageSize=this.pageSize+5,this.getCustomerPath(this.searchParams))},goToOrderPage:function(e){this.$router.push({name:"OrderList",params:{orderId:e}})},getPathFromRemote:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(b["h"])(this.$route.params.id,t).then((function(t){2e4===t.code&&(e.timeLineInfo=t.data.list,e.total=t.data.count)}))},getCustomerPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(Y["h"])(e)||(this.searchParams=e);var t=Object(J["a"])({page_size:this.pageSize,current_page:this.currentPage},this.searchParams);this.getPathFromRemote(t)}},created:function(){this.getCustomerPath()}},G=q,H=(r("3828"),Object(u["a"])(G,B,M,!1,null,"17f86d6a",null)),K=H.exports,Q={components:{FollowerSelect:V,FollowCustomerDialog:A["a"],FollowTimeline:K},data:function(){return{historySearchForm:{createTimeRange:[],follower:""},followDialogVisible:!1}},methods:{resetSearch:function(){this.$refs.historySearchForm.resetFields();var e={page_size:10,current_page:1};this.$refs.followTimeline.getPathFromRemote(e)},searchPath:function(){var e={creator:this.historySearchForm.follower,create_time_begin:S.a.nth(this.historySearchForm.createTimeRange,0),create_time_end:S.a.nth(this.historySearchForm.createTimeRange,1)};this.$refs.followTimeline.getCustomerPath(e)},onFollowSuccess:function(){this.followDialogVisible=!1,this.resetSearch()}}},W=Q,X=Object(u["a"])(W,j,I,!1,null,null,null),Z=X.exports,ee=r("7df0"),te={name:"index",components:{UserInfo:f,Order:$,Operation:Z,CustomerBasicInfo:ee["a"]},data:function(){return{activeName:"operationAction"}}},re=te,ae=(r("7d0f"),Object(u["a"])(re,a,o,!1,null,"7632e8a2",null));t["default"]=ae.exports},"7d0f":function(e,t,r){"use strict";var a=r("6091"),o=r.n(a);o.a},e88d:function(e,t,r){},f597:function(e,t,r){}}]);
//# sourceMappingURL=chunk-304cebf8.b71d6199.js.map