(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ce42c8d0"],{"23ba":function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return i})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return s}));var n=a("b775");function r(e){return Object(n["a"])({url:"/fd/corps",method:"get",params:e})}function o(e){return Object(n["a"])({url:"/fd/corps",method:"post",data:e})}function i(e,t){return Object(n["a"])({url:"/fd/corps/".concat(e,"/status"),method:"put",data:t})}function l(e,t){return Object(n["a"])({url:"/fd/corps/".concat(e),method:"put",data:t})}function s(e){return Object(n["a"])({url:"/fd/corps/".concat(e),method:"get"})}},"2c35":function(e,t,a){},4370:function(e,t,a){"use strict";var n=a("2c35"),r=a.n(n);r.a},"672e":function(e,t,a){},"98b3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fd-team-manage"},[a("el-tabs",{staticClass:"professional-role__header__tabs",model:{value:e.activeLabel,callback:function(t){e.activeLabel=t},expression:"activeLabel"}},e._l(e.$store.state.dictionary.fdTeamTypes,(function(t){var n=t.label,r=t.name;return a("el-tab-pane",{key:r,attrs:{name:r}},[a("span",{staticClass:"professional-role__header__tabs__slot-label",attrs:{slot:"label"},slot:"label"},[e._v(e._s(n))])])})),1),a("div",{staticClass:"fd-team-manage__header margin-top-20"},[a("search-form",{ref:"searchForm",attrs:{"team-type":e.activeLabel},on:{search:e.onSearchClick}})],1),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAddTeam}},[e._v("新增团队")]),a("div",{staticClass:"fd-team-manage__body"},[a("div",{staticClass:"el-card-warpper fd-team-manage__body__list"},[a("el-card",{staticClass:"el-card--no-shadow el-card--header-nbb el-card--flex"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"el-card__header__title"},[e._v("家庭医生"+e._s(e._f("fdTeamType")(e.activeLabel))+"列表")])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fd-team-manage__body__list__table sbl-table",attrs:{data:e.tableDate}},[a("el-table-column",{key:"1",attrs:{align:"center",label:"团队编号","min-width":"100",prop:"id",fixed:""}}),a("el-table-column",{key:"2",attrs:{align:"center",label:"团队名称","min-width":"100",prop:"name"}}),"BASIC_ERKE"===e.activeLabel||"BASIC_CHANKE"===e.activeLabel?a("el-table-column",{key:"3",attrs:{align:"center",label:"BASIC_ERKE"===e.activeLabel?"儿科医生":"产科医生",prop:"doctor","min-width":"100"}}):e._e(),"BASIC_ERKE"===e.activeLabel?a("el-table-column",{key:"4",attrs:{align:"center",label:"健康管理师",prop:"hms","min-width":"140"}}):e._e(),"COMMON"===e.activeLabel?a("el-table-column",{key:"5",attrs:{align:"center",label:"团队类型",prop:"category","min-width":"100"}}):e._e(),"COMMON"===e.activeLabel?a("el-table-column",{key:"6",attrs:{align:"center",label:"团队成员","min-width":"100",prop:"commonMembers"}}):e._e(),a("el-table-column",{key:"7",attrs:{align:"center",label:"创建时间","min-width":"140",prop:"createDate"}}),a("el-table-column",{key:"8",attrs:{align:"center",label:"服务状态","min-width":"100",prop:"isOnServer"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-switch",{class:!0===t.row.isOnServer?"online-style":"offline-style",attrs:{value:t.row.isOnServer,width:60,"active-text":(t.row.isOnServer,""),"inactive-text":!0===t.row.isOnServer?"上线":"下线","inactive-color":"#C0C4CC"},on:{change:function(a){return e.changeOnlineStatusFun(t.row,t.row.isOnServer)}}})],1)]}}])}),a("el-table-column",{key:"9",attrs:{align:"center","min-width":"130",prop:"contractCounts"}},[a("template",{slot:"header"},[a("span",[a("span",[e._v(" 当前服务中订单数")]),a("el-tooltip",{staticClass:"item color-576277",attrs:{effect:"dark",content:"非实时数据，每小时刷新一次",placement:"top"}},[a("i",{staticClass:"el-icon-info"})])],1)])],2),a("el-table-column",{key:"10",attrs:{align:"center",label:"签约饱和状态","min-width":"180",prop:"saturation"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",["BASIC_ERKE"===e.activeLabel?a("div",[a("p",[e._v("\n                    医生签约"+e._s(t.row.notOverflow.doctor?"正常":"饱和")+"\n                  ")]),a("p",[e._v("\n                    健康管理师签约"+e._s(t.row.notOverflow.hms?"正常":"饱和")+"\n                  ")])]):"COMMON"===e.activeLabel?a("div",[a("p",[e._v("\n                    签约"+e._s(t.row.notOverflow.common?"正常":"饱和")+"\n                  ")])]):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.seeResourceDetail(t.row._id)}}},[e._v("详情")])],1)]}}])}),a("el-table-column",{key:"11",attrs:{align:"center",label:"操作",fixed:"right",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(a){return e.handleEdit(t)}}},[e._v("编辑")])],1)]}}])})],1),a("div",{staticClass:"fd-team-manage__body__list__pagination"},[a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":e.pageSizes,"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)]),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.onlineDialogVisible,"before-close":e.cancelOnlineChangeFun,width:"30%",center:""},on:{"update:visible":function(t){e.onlineDialogVisible=t}}},[a("span",[e._v(e._s(e.dialogContent))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelOnlineChangeFun}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChangeOnlineStatus}},[e._v(e._s(e.dialogConfirmBtnTxt))])],1)]),a("el-dialog",{attrs:{title:"签约饱和状态详情",visible:e.dialogTableVisible,width:"500px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{attrs:{data:e.fdResourceDetail}},[a("el-table-column",{attrs:{prop:"name",label:"成员姓名"}}),a("el-table-column",{attrs:{prop:"busRole",label:"成员类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.systemRole(t.row.busRole,""))+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"fdResource",label:"服务资源占用情况"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("\n            "+e._s(t.row.fdResourceCurr)+" / "+e._s(t.row.fdResource)+"\n          ")])]}}])},[a("template",{slot:"header"},[a("span",[a("span",[e._v(" 服务资源占用情况")]),a("el-tooltip",{staticClass:"item color-576277",attrs:{effect:"dark",content:"已占用的服务资源/服务上限值",placement:"top"}},[a("i",{staticClass:"el-icon-info"})])],1)])],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},r=[],o=a("db72"),i=(a("96cf"),a("3b8d")),l=(a("7f7f"),a("23ba")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("el-form",{attrs:{"label-position":"left","label-width":"76px",model:e.formData}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"团队名称"}},[a("el-input",{staticClass:"fd-team-manage__header__item fd-team-manage__header__search",attrs:{size:"small",placeholder:"请输入团队名称",clearable:""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1)],1),"BASIC_ERKE"===e.teamType||"BASIC_CHANKE"===e.teamType?a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"医生姓名"}},[a("el-input",{attrs:{placeholder:"请输入医生姓名",size:"small",clearable:""},model:{value:e.formData.doctor,callback:function(t){e.$set(e.formData,"doctor",t)},expression:"formData.doctor"}})],1)],1):e._e(),"COMMON"===e.teamType?a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"团队成员"}},[a("el-input",{attrs:{placeholder:"请输入团队成员姓名",size:"small",clearable:""},model:{value:e.formData.commonMember,callback:function(t){e.$set(e.formData,"commonMember",t)},expression:"formData.commonMember"}})],1)],1):e._e(),"COMMON"===e.teamType?a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"团队类型"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择团队类型"},model:{value:e.formData.teamCategory,callback:function(t){e.$set(e.formData,"teamCategory",t)},expression:"formData.teamCategory"}},e._l(e.$store.state.dictionary.teamCategories,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1)},c=[],m={name:"",doctor:"",commonMember:"",teamCategory:""},u={props:{localFormData:{type:Object,default:function(){}},teamType:{type:String,default:"BASIC_ERKE"}},data:function(){return{formData:{}}},created:function(){this.formData=Object.assign({},m,this.localFormData)},methods:{handleSearch:function(){this.$emit("search",this.formData)},handleReset:function(){this.handleResetFormData(),this.handleSearch("reset")},handleResetFormData:function(){this.formData=Object.assign({},m)}}},d=u,f=a("2877"),p=Object(f["a"])(d,s,c,!1,null,null,null),h=p.exports,b=a("8975"),_=a("0680"),g={components:{SearchForm:h},data:function(){return{dialogTableVisible:!1,loading:!1,activeLabel:"BASIC_ERKE",activeName:"",dialogTitle:"上线提示",dialogConfirmBtnTxt:"确认上线",dialogContent:"",onlineDialogVisible:!1,tableDate:[],page:{total:0,pageSize:10,currentPage:1},is_on_server:!1,pageSizes:[10,50,100],fdResourceDetail:[]}},created:function(){this.$route.params.type?this.activeLabel=this.$route.params.type:this.handleSearch()},watch:{activeLabel:function(){this.handleSearch()}},methods:{seeResourceDetail:function(e){var t=this;Object(l["c"])(e).then((function(e){var a=e.data,n=a.doctor?[{name:a.doctor.name,busRole:a.doctor.bus_role,fdResourceCurr:a.doctor.fd_resource_curr,fdResource:a.doctor.fd_resource}]:[],r=a.hms&&a.hms.map((function(e){return{name:e.name,busRole:e.bus_role,fdResourceCurr:e.fd_resource_curr,fdResource:e.fd_resource}}))||[],o=a.common_members&&a.common_members.map((function(e){return{name:e.name,busRole:e.bus_role,fdResourceCurr:e.fd_resource_curr,fdResource:e.fd_resource}}))||[];t.fdResourceDetail=n.concat(r,o),t.dialogTableVisible=!0}))},handleAddTeam:function(){this.$router.push({name:"FDTeamAdd",params:{type:this.activeLabel}})},sectionOffice:_["d"],systemRole:_["h"],cancelOnlineChangeFun:function(){this.onlineDialogVisible=!1},changeOnlineStatusFun:function(e,t){this.onlineDialogVisible=!0,this.activeId=e._id,this.activeName=e.name,t&&"false"!==t?(this.is_on_server=!1,this.dialogTitle="下线提示",this.dialogContent="下线后，"+e.name+"将不可以签约用户，确认下线吗？",this.dialogConfirmBtnTxt="确认下线"):(this.is_on_server=!0,this.dialogTitle="上线提示",this.dialogContent="上线后，"+e.name+"将拥有签约用户的权限，确认上线吗？",this.dialogConfirmBtnTxt="确认上线")},confirmChangeOnlineStatus:function(){var e=this,t={status:this.is_on_server};this.activeId&&Object(l["b"])(this.activeId,t).then((function(t){e.activeId="",e.onlineDialogVisible=!1,e.$message.success("状态改变成功"),e.handleSearch()}))},setTableData:function(e){var t=this,a=e.list;this.tableDate=a.map((function(e,a){return{id:e.no,_id:e._id?e._id:a,name:e.name?e.name:"-",department:t.sectionOffice(e.section_office,"",!0),doctor:e.doctor?e.doctor.name:"无",hms:e.hms?e.hms.map((function(e){return e.name})).join(","):"无",createDate:e.created_at?t.formatTime(e.created_at):"-",isOnServer:e.status,notOverflow:{doctor:e.doctor&&!e.doctor.overflow,hms:e.hms&&e.hms.some((function(e){return!e.overflow})),common:e.common_members&&e.common_members.some((function(e){return!e.overflow}))},contractCounts:e.contract_counts,category:Object(b["teamCategory"])(e.category),commonMembers:e.common_members?e.common_members.map((function(e){return e.name})).join(","):"无"}}))},onSearchClick:function(e){this.resetPage(),this.handleSearch(e)},resetPage:function(){this.page.currentPage=1,this.page.pageSize=10},handleCurrentChange:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page.currentPage=t,e.next=3,this.handleSearch(this.$refs.searchForm.formData);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleSizeChange:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page.currentPage=1,this.page.pageSize=t,e.next=4,this.handleSearch(this.$refs.searchForm.formData);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleSearch:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},this.loading=!0,a={},a.type=this.activeLabel,a.currentPage=this.page.currentPage,a.pageSize=this.page.pageSize,t.name&&(a.name=t.name),t.doctor&&(a.doctor_name=t.doctor),t.commonMember&&(a.member_name=t.commonMember),t.teamCategory&&(a.category=t.teamCategory),e.next=12,Object(l["d"])(a);case 12:n=e.sent,r=n.data,this.loading=!1,this.setTableData(Object(o["a"])({},r)),this.page.total=r.page.total;case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleEdit:function(e){var t=e.row;this.$router.push({name:"FDTeamEdit",params:{id:t._id,type:this.activeLabel}})},handleHistory:function(e){var t=e.row;e.$index;this.$router.push({path:"/system-settings/fd-team/".concat(t._id,"/log?name=").concat(encodeURIComponent(t.team.doctor.name))})}}},v=g,C=(a("4370"),a("de1f"),Object(f["a"])(v,n,r,!1,null,"01b8a425",null));t["default"]=C.exports},de1f:function(e,t,a){"use strict";var n=a("672e"),r=a.n(n);r.a}}]);
//# sourceMappingURL=chunk-ce42c8d0.7f01d2e1.js.map